<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>L.E.S  - Warehouse Management</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        
        .loading-spinner {
            border: 2px solid #e5e7eb;
            border-top: 2px solid #2563eb;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .wms-header {
            background: linear-gradient(135deg, #050914 0%, #091323 50%, #03191d 100%);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
        }
        
        .nav-item {
            transition: all 0.3s ease;
            border-radius: 8px;
            padding: 12px 16px;
            margin: 0 4px;
            color: #64748b;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }
        
        .nav-item:hover {
            background: #f1f5f9;
            color: #334155;
            transform: translateY(-1px);
        }
        
        .nav-item.active {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }
        
        .wms-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .wms-card:hover {
            box-shadow: 0 8px 40px rgba(0, 0, 0, 0.12);
            transform: translateY(-2px);
        }
        
        .wms-button {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .wms-button:hover {
            background: linear-gradient(135deg, #1d4ed8 0%, #1e40af 100%);
            transform: translateY(-1px);
            box-shadow: 0 8px 25px rgba(37, 99, 235, 0.3);
        }
        
        .wms-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .wms-button.success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .wms-button.success:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
        }
        
        .wms-button.warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        
        .wms-button.warning:hover {
            background: linear-gradient(135deg, #d97706 0%, #b45309 100%);
            box-shadow: 0 8px 25px rgba(245, 158, 11, 0.3);
        }
        
        .wms-button.danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }
        
        .wms-button.danger:hover {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.3);
        }
        
        .wms-input {
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 12px 16px;
            background: white;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .wms-input:focus {
            border-color: #2563eb;
            box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1);
            outline: none;
        }
        
        .metric-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 2px solid #e2e8f0;
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .metric-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.1);
            border-color: #cbd5e1;
        }
        
        .metric-number {
            font-size: 2.5rem;
            font-weight: 800;
            color: #1f2937;
            margin-bottom: 8px;
        }
        
        .metric-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .status-in-stock {
            background: #dcfce7;
            color: #166534;
        }
        
        .status-low-stock {
            background: #fef3c7;
            color: #92400e;
        }
        
        .status-out-stock {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .status-reserved {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .velocity-fast {
            background: #dcfce7;
            color: #166534;
        }
        
        .velocity-medium {
            background: #fef3c7;
            color: #92400e;
        }
        
        .velocity-slow {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .abc-a {
            background: #dcfce7;
            color: #166534;
            font-weight: bold;
        }
        
        .abc-b {
            background: #fef3c7;
            color: #92400e;
            font-weight: bold;
        }
        
        .abc-c {
            background: #fee2e2;
            color: #991b1b;
            font-weight: bold;
        }
        
        .priority-high {
            border-left: 4px solid #ef4444;
        }
        
        .priority-medium {
            border-left: 4px solid #f59e0b;
        }
        
        .priority-low {
            border-left: 4px solid #10b981;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(8px);
        }
        
        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 32px;
            max-width: 800px;
            width: 90%;
            max-height: 90%;
            overflow-y: auto;
            box-shadow: 0 25px 100px rgba(0, 0, 0, 0.2);
        }
        
        .toast {
            position: fixed;
            top: 24px;
            right: 24px;
            padding: 16px 24px;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            z-index: 1001;
            animation: slideIn 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .toast.success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .toast.error {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }
        
        .toast.warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        
        .location-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 8px;
            margin: 16px 0;
        }
        
        .location-cell {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .location-cell:hover {
            background: #e2e8f0;
            transform: scale(1.02);
        }
        
        .location-cell.occupied {
            background: #dbeafe;
            border-color: #3b82f6;
        }
        
        .location-cell.full {
            background: #fee2e2;
            border-color: #ef4444;
        }
        
        .barcode-display {
            font-family: 'Courier New', monospace;
            background: white;
            padding: 20px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            text-align: center;
        }
        
        .barcode-bars {
            display: flex;
            justify-content: center;
            align-items: end;
            height: 60px;
            margin: 16px 0;
        }
        
        .barcode-bar {
            background: #000;
            margin: 0 1px;
        }
        
        .cycle-count-item {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 16px;
            margin: 8px 0;
        }
        
        .cycle-count-item.variance {
            border-color: #f59e0b;
            background: #fef3c7;
        }
        
        .movement-history {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .movement-item {
            display: flex;
            justify-content: between;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .movement-item:last-child {
            border-bottom: none;
        }
        
        .kpi-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .kpi-excellent {
            background: #10b981;
        }
        
        .kpi-good {
            background: #f59e0b;
        }
        
        .kpi-poor {
            background: #ef4444;
        }
        
        .section-content {
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .inventory-tab-btn {
            transition: all 0.3s ease;
        }
        
        .inventory-tab-btn.active {
            border-color: #2563eb;
            color: #2563eb;
        }
        
        .inventory-tab-content {
            animation: fadeIn 0.3s ease;
        }
        
        .workspace-tab-btn {
            transition: all 0.3s ease;
        }
        
        .workspace-tab-btn.active {
            border-color: #2563eb;
            color: #2563eb;
        }
        
        .workspace-tab-content {
            animation: fadeIn 0.3s ease;
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body class="min-h-full bg-gradient-to-br from-gray-50 to-blue-50 font-sans"><!-- Header -->
  <header class="wms-header">
   <div class="max-w-7xl mx-auto px-6 lg:px-8">
    <div class="flex justify-between items-center py-6">
     <div class="flex items-center space-x-4">
      <div class="w-20 h-20 bg-white rounded-xl flex items-center justify-center shadow-lg">
    <img src="https://img1.wsimg.com/isteam/ip/68a287ad-de0d-4f97-9a41-b8ad07961366/Subtitle%20(6).jpg/:/rs=h:175,m" alt="Company Logo" class="w-full h-full object-contain">
</div>

      <div>
       <h1 class="text-3xl font-bold text-white" id="company-name">L.E.S logistics</h1>
       <p class="text-blue-100 text-sm font-medium" id="warehouse-name">Warehouse Management</p>
      </div>
     </div>
     <div class="flex items-center space-x-6">
      <div class="text-sm text-blue-100">

       <div class="font-semibold" id="manager-name">
        Warehouse Manager
       </div>
       <div id="current-time"></div>
      </div>
      <div class="flex items-center space-x-2">
       <div class="w-3 h-3 bg-green-400 rounded-full animate-pulse"></div><span class="text-blue-100 text-sm font-medium">System Online</span>
      </div>
     </div>
    </div>
   </div>
  </header><!-- Navigation -->
  <nav class="bg-white border-b-2 border-gray-200">
   <div class="max-w-7xl mx-auto px-6 lg:px-8 py-4">
    <div class="flex flex-wrap gap-2"><button onclick="showSection('dashboard')" class="nav-item active" data-section="dashboard">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path>
      </svg> Dashboard </button> <button onclick="showSection('inventory')" class="nav-item" data-section="inventory">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
      </svg> Inventory </button> <button onclick="showSection('receiving')" class="nav-item" data-section="receiving">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"></path>
      </svg> Receiving </button> <button onclick="showSection('picking')" class="nav-item" data-section="picking">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg> Picking </button> <button onclick="showSection('shipping')" class="nav-item" data-section="shipping">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
      </svg> Shipping </button> <button onclick="showSection('locations')" class="nav-item" data-section="locations">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
      </svg> Locations </button> <button onclick="showSection('reports')" class="nav-item" data-section="reports">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
      </svg> Reports </button> <button onclick="showSection('cycle-count')" class="nav-item" data-section="cycle-count">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path>
      </svg> Cycle Count </button>
    </div>
   </div>
  </nav><!-- Booker Login Modal -->
  <div id="booker-login-modal" class="modal hidden">
   <div class="modal-content max-w-md">
    <div class="text-center mb-6">
     <div class="w-16 h-16 bg-blue-600 rounded-xl flex items-center justify-center mx-auto mb-4">
      <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
      </svg>
     </div>
     <h3 class="text-2xl font-bold text-gray-900">Booker Access</h3>
     <p class="text-gray-600 mt-2">Enter your initials to access your work area</p>
    </div>
    <form id="booker-login-form" onsubmit="loginBooker(event)">
     <div class="mb-4"><label class="block text-sm font-medium text-gray-700 mb-2">Your Initials</label> <input type="text" name="initials" required maxlength="3" class="wms-input w-full text-center text-2xl font-bold uppercase" placeholder="ABC" style="text-transform: uppercase;">
     </div>
     <div class="mb-4"><label class="block text-sm font-medium text-gray-700 mb-2">Password</label> <input type="password" name="password" required class="wms-input w-full text-center text-lg" placeholder="Enter your password">
     </div>
     <div class="flex justify-center space-x-4"><button type="button" onclick="switchToManager()" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"> Manager Access </button> <button type="submit" class="wms-button" id="booker-login-btn">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path>
       </svg> Access My Work </button>
     </div>
    </form>
   </div>
  </div><!-- Main Content -->
  <main class="max-w-7xl mx-auto px-6 lg:px-8 py-8"><!-- Dashboard Section -->
   <div id="dashboard-section" class="section-content"><!-- Key Metrics -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6 mb-8">
     <div class="metric-card">
      <div class="metric-number text-blue-600" id="total-items">
       0
      </div>
      <div class="metric-label">
       Total Items
      </div>
      <div class="text-xs text-gray-500 mt-2"><span class="kpi-indicator kpi-excellent"></span>Active SKUs
      </div>
     </div>
     <div class="metric-card">
      <div class="metric-number text-green-600" id="total-value">
       0 SKUs
      </div>
      <div class="metric-label">
       Total SKUs
      </div>
      <div class="text-xs text-gray-500 mt-2"><span class="kpi-indicator kpi-good"></span>Unique Items
      </div>
     </div>
     <div class="metric-card">
      <div class="metric-number text-amber-600" id="low-stock-count">
       0
      </div>
      <div class="metric-label">
       Low Stock
      </div>
      <div class="text-xs text-gray-500 mt-2"><span class="kpi-indicator kpi-good"></span>Need Reorder
      </div>
     </div>
     <div class="metric-card">
      <div class="metric-number text-red-600" id="out-stock-count">
       0
      </div>
      <div class="metric-label">
       Out of Stock
      </div>
      <div class="text-xs text-gray-500 mt-2"><span class="kpi-indicator kpi-poor"></span>Critical Items
      </div>
     </div>
     <div class="metric-card">
      <div class="metric-number text-purple-600" id="accuracy-rate">
       99.5%
      </div>
      <div class="metric-label">
       Accuracy Rate
      </div>
      <div class="text-xs text-gray-500 mt-2"><span class="kpi-indicator kpi-excellent"></span>Last 30 Days
      </div>
     </div>
    </div><!-- Dashboard Cards -->
    <div class="grid lg:grid-cols-3 gap-8"><!-- Recent Activity -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900 flex items-center">
        <div class="w-3 h-3 bg-green-400 rounded-full animate-pulse mr-3"></div> Recent Activity</h3>
      </div>
      <div class="p-6">
       <div id="recent-activity" class="space-y-4">
        <div class="text-gray-500 text-center py-8">
         No recent activity
        </div>
       </div>
      </div>
     </div><!-- Quick Actions -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">Quick Actions</h3>
      </div>
      <div class="p-6">
       <div class="grid grid-cols-2 gap-4"><button onclick="openAddItemModal()" class="wms-button">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
         </svg> Add Item </button> <button onclick="openReceiveModal()" class="wms-button success">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"></path>
         </svg> Receive </button> <button onclick="startCycleCount()" class="wms-button warning">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path>
         </svg> Count </button> <button onclick="generateReport()" class="wms-button">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
         </svg> Report </button>
       </div>
      </div>
     </div><!-- Alerts & Notifications -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">Alerts &amp; Notifications</h3>
      </div>
      <div class="p-6">
       <div id="alerts-container" class="space-y-4">
        <div class="text-gray-500 text-center py-8">
         No alerts
        </div>
       </div>
      </div>
     </div>
    </div>
   </div><!-- Inventory Section -->
   <div id="inventory-section" class="section-content hidden">
    <div class="flex justify-between items-center mb-6">
     <h2 class="text-3xl font-bold text-gray-900">Inventory Management</h2>
     <div class="flex space-x-3"><button onclick="exportInventory()" class="wms-button warning">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
       </svg> Export </button> <button onclick="openAddItemModal()" class="wms-button">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
       </svg> Add Item </button>
     </div>
    </div><!-- Inventory Tabs -->
    <div class="mb-6">
     <div class="border-b border-gray-200">
      <nav class="-mb-px flex space-x-8"><button onclick="showInventoryTab('items')" class="inventory-tab-btn active border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm" data-tab="items">
        <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
        </svg> Inventory Items </button> <button onclick="showInventoryTab('bookers')" class="inventory-tab-btn border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm" data-tab="bookers">
        <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
        </svg> Manage Bookers </button>
      </nav>
     </div>
    </div><!-- Inventory Items Tab -->
    <div id="inventory-items-tab" class="inventory-tab-content"><!-- Search and Filters -->
     <div class="wms-card mb-6">
      <div class="p-6">
       <div class="grid md:grid-cols-7 gap-4">
        <div class="md:col-span-2"><input type="text" placeholder="Search items, SKU, barcode..." class="wms-input w-full" id="search-inventory" onkeyup="filterInventory()">
        </div><input type="text" placeholder="Filter by description..." class="wms-input" id="filter-description" onkeyup="filterInventory()"> <input type="text" placeholder="Location (e.g. 001.001.001)" class="wms-input font-mono" id="filter-location" onkeyup="filterInventory()"> <select class="wms-input" id="filter-status" onchange="filterInventory()"> <option value="">All Status</option> <option value="in-stock">In Stock</option> <option value="low-stock">Low Stock</option> <option value="out-stock">Out of Stock</option> </select> <select class="wms-input" id="filter-velocity" onchange="filterInventory()"> <option value="">All Velocity</option> <option value="fast">Fast Moving</option> <option value="medium">Medium Moving</option> <option value="slow">Slow Moving</option> </select> <button onclick="clearFilters()" class="wms-button">Clear</button>
       </div>
      </div>
     </div>
    </div><!-- Bookers Management Tab -->
    <div id="inventory-bookers-tab" class="inventory-tab-content hidden">
     <div class="flex justify-between items-center mb-6">
      <div>
       <h3 class="text-xl font-bold text-gray-900">Professional Bookers Management</h3>
       <p class="text-gray-600">Manage warehouse booking staff and their assignments</p>
      </div><button onclick="openAddBookerModal()" class="wms-button">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
       </svg> Add Booker </button>
     </div><!-- Bookers Stats -->
     <div class="grid lg:grid-cols-4 gap-6 mb-8">
      <div class="wms-card">
       <div class="p-6 text-center">
        <div class="text-3xl font-bold text-blue-600" id="total-bookers">
         0
        </div>
        <div class="text-sm font-medium text-gray-600">
         Total Bookers
        </div>
        <div class="text-xs text-gray-500 mt-1">
         Registered staff
        </div>
       </div>
      </div>
      <div class="wms-card">
       <div class="p-6 text-center">
        <div class="text-3xl font-bold text-green-600" id="active-bookers">
         0
        </div>
        <div class="text-sm font-medium text-gray-600">
         Active Today
        </div>
        <div class="text-xs text-gray-500 mt-1">
         Currently working
        </div>
       </div>
      </div>
      <div class="wms-card">
       <div class="p-6 text-center">
        <div class="text-3xl font-bold text-purple-600" id="bookings-today">
         0
        </div>
        <div class="text-sm font-medium text-gray-600">
         Bookings Today
        </div>
        <div class="text-xs text-gray-500 mt-1">
         Items processed
        </div>
       </div>
      </div>
      <div class="wms-card">
       <div class="p-6 text-center">
        <div class="text-3xl font-bold text-amber-600" id="avg-booking-rate">
         0
        </div>
        <div class="text-sm font-medium text-gray-600">
         Avg Rate
        </div>
        <div class="text-xs text-gray-500 mt-1">
         Items per hour
        </div>
       </div>
      </div>
     </div><!-- Bookers Search and Filters -->
     <div class="wms-card mb-6">
      <div class="p-6">
       <div class="grid md:grid-cols-5 gap-4">
        <div class="md:col-span-2"><input type="text" placeholder="Search bookers by name, ID..." class="wms-input w-full" id="search-bookers" onkeyup="filterBookers()">
        </div><select class="wms-input" id="filter-booker-status" onchange="filterBookers()"> <option value="">All Status</option> <option value="active">Active</option> <option value="busy">Busy</option> <option value="break">On Break</option> <option value="offline">Offline</option> </select> <select class="wms-input" id="filter-booker-shift" onchange="filterBookers()"> <option value="">All Shifts</option> <option value="morning">Morning (6AM-2PM)</option> <option value="afternoon">Afternoon (2PM-10PM)</option> <option value="night">Night (10PM-6AM)</option> </select> <button onclick="clearBookerFilters()" class="wms-button">Clear</button>
       </div>
      </div>
     </div><!-- Bookers Table -->
     <div class="wms-card">
      <div class="overflow-x-auto">
       <table class="w-full">
        <thead class="bg-gray-50">
         <tr>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Booker</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contact</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Shift &amp; Zone</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Performance</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Today's Activity</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
          <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
         </tr>
        </thead>
        <tbody id="bookers-table-body" class="bg-white divide-y divide-gray-200">
         <tr>
          <td colspan="7" class="px-6 py-12 text-center text-gray-500">
           <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
           </svg><p class="text-lg font-medium">No bookers found</p><p class="text-sm">Add your first booker to get started</p></td>
         </tr>
        </tbody>
       </table>
      </div>
     </div>
    </div><!-- Inventory Table -->
    <div class="wms-card">
     <div class="overflow-x-auto">
      <table class="w-full">
       <thead class="bg-gray-50">
        <tr>
         <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Item</th>
         <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Location</th>
         <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Stock</th>
         <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Unit Type</th>
         <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Entry Date</th>
         <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Expiry Date</th>
         <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Velocity</th>
         <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
         <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
        </tr>
       </thead>
       <tbody id="inventory-table-body" class="bg-white divide-y divide-gray-200">
        <tr>
         <td colspan="9" class="px-6 py-12 text-center text-gray-500">
          <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
          </svg><p class="text-lg font-medium">No inventory items found</p><p class="text-sm">Add your first item to get started</p></td>
        </tr>
       </tbody>
      </table>
     </div>
    </div>
   </div><!-- Receiving Section -->
   <div id="receiving-section" class="section-content hidden">
    <div class="flex justify-between items-center mb-6">
     <h2 class="text-3xl font-bold text-gray-900">Professional Receiving Operations</h2>
     <div class="flex space-x-3"><button onclick="openCreateReceivingModal()" class="wms-button">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
       </svg> Create Receiving Record </button> <button onclick="openReceiveModal()" class="wms-button success">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"></path>
       </svg> Quick Receive </button>
     </div>
    </div>
    <div class="grid lg:grid-cols-2 gap-8"><!-- Pending Receipts -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">Pending Receipts</h3>
      </div>
      <div class="p-6">
       <div id="pending-receipts" class="space-y-4">
        <div class="text-gray-500 text-center py-8">
         No pending receipts
        </div>
       </div>
      </div>
     </div><!-- Recent Receipts -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">Recent Receipts</h3>
      </div>
      <div class="p-6">
       <div id="recent-receipts" class="space-y-4">
        <div class="text-gray-500 text-center py-8">
         No recent receipts
        </div>
       </div>
      </div>
     </div>
    </div>
   </div><!-- Picking Section -->
   <div id="picking-section" class="section-content hidden">
    <div class="flex justify-between items-center mb-6">
     <h2 class="text-3xl font-bold text-gray-900">Professional Picking Operations</h2>
     <div class="flex space-x-3"><button onclick="managePickers()" class="wms-button warning">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
       </svg> Manage Pickers </button> <button onclick="createPickList()" class="wms-button">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
       </svg> Create Pick Order </button>
     </div>
    </div><!-- Picker Status Overview -->
    <div class="grid lg:grid-cols-4 gap-6 mb-8">
     <div class="wms-card">
      <div class="p-6 text-center">
       <div class="text-3xl font-bold text-blue-600" id="active-pickers">
        0
       </div>
       <div class="text-sm font-medium text-gray-600">
        Active Pickers
       </div>
       <div class="text-xs text-gray-500 mt-1">
        Currently working
       </div>
      </div>
     </div>
     <div class="wms-card">
      <div class="p-6 text-center">
       <div class="text-3xl font-bold text-green-600" id="completed-orders">
        0
       </div>
       <div class="text-sm font-medium text-gray-600">
        Completed Today
       </div>
       <div class="text-xs text-gray-500 mt-1">
        Pick orders finished
       </div>
      </div>
     </div>
     <div class="wms-card">
      <div class="p-6 text-center">
       <div class="text-3xl font-bold text-amber-600" id="pending-orders">
        0
       </div>
       <div class="text-sm font-medium text-gray-600">
        Pending Orders
       </div>
       <div class="text-xs text-gray-500 mt-1">
        Awaiting assignment
       </div>
      </div>
     </div>
     <div class="wms-card">
      <div class="p-6 text-center">
       <div class="text-3xl font-bold text-purple-600" id="avg-pick-rate">
        0
       </div>
       <div class="text-sm font-medium text-gray-600">
        Avg Pick Rate
       </div>
       <div class="text-xs text-gray-500 mt-1">
        Items per hour
       </div>
      </div>
     </div>
    </div>
    <div class="grid lg:grid-cols-3 gap-8"><!-- Active Pick Orders -->
     <div class="lg:col-span-2 wms-card">
      <div class="p-6 border-b border-gray-200">
       <div class="flex justify-between items-center">
        <h3 class="text-xl font-bold text-gray-900">Active Pick Orders</h3>
        <div class="flex space-x-2"><select id="picker-filter" class="wms-input text-sm" onchange="filterPickOrders()"> <option value="">All Pickers</option> </select> <select id="priority-filter" class="wms-input text-sm" onchange="filterPickOrders()"> <option value="">All Priorities</option> <option value="urgent">Urgent</option> <option value="high">High</option> <option value="medium">Medium</option> <option value="low">Low</option> </select>
        </div>
       </div>
      </div>
      <div class="p-6">
       <div id="active-picks" class="space-y-4 max-h-96 overflow-y-auto">
        <div class="text-gray-500 text-center py-8">
         No active pick orders
        </div>
       </div>
      </div>
     </div><!-- Picker Performance & Status -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">Picker Status</h3>
      </div>
      <div class="p-6">
       <div id="picker-status" class="space-y-3 max-h-96 overflow-y-auto">
        <div class="text-gray-500 text-center py-8">
         No pickers registered
        </div>
       </div>
      </div>
     </div>
    </div><!-- Completed Orders Today -->
    <div class="wms-card mt-8">
     <div class="p-6 border-b border-gray-200">
      <h3 class="text-xl font-bold text-gray-900">Completed Orders Today</h3>
     </div>
     <div class="p-6">
      <div id="completed-picks" class="space-y-3 max-h-64 overflow-y-auto">
       <div class="text-gray-500 text-center py-8">
        No completed orders today
       </div>
      </div>
     </div>
    </div>
   </div><!-- Shipping Section -->
   <div id="shipping-section" class="section-content hidden">
    <div class="flex justify-between items-center mb-6">
     <h2 class="text-3xl font-bold text-gray-900">Shipping Operations</h2><button onclick="createShipment()" class="wms-button">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
      </svg> Create Shipment </button>
    </div>
    <div class="grid lg:grid-cols-3 gap-8"><!-- Ready to Ship -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">Ready to Ship</h3>
      </div>
      <div class="p-6">
       <div id="ready-to-ship" class="space-y-4">
        <div class="text-gray-500 text-center py-8">
         No items ready to ship
        </div>
       </div>
      </div>
     </div><!-- Shipping Performance -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">Shipping Performance</h3>
      </div>
      <div class="p-6">
       <div class="space-y-6">
        <div class="text-center">
         <div class="text-3xl font-bold text-blue-600" id="shipments-today">
          0
         </div>
         <div class="text-sm text-gray-600">
          Shipments Today
         </div>
        </div>
        <div class="text-center">
         <div class="text-3xl font-bold text-green-600" id="on-time-delivery">
          98.5%
         </div>
         <div class="text-sm text-gray-600">
          On-Time Delivery
         </div>
        </div>
       </div>
      </div>
     </div><!-- Recent Shipments -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">Recent Shipments</h3>
      </div>
      <div class="p-6">
       <div id="recent-shipments" class="space-y-4">
        <div class="text-gray-500 text-center py-8">
         No recent shipments
        </div>
       </div>
      </div>
     </div>
    </div>
   </div><!-- Locations Section -->
   <div id="locations-section" class="section-content hidden">
    <div class="flex justify-between items-center mb-6">
     <h2 class="text-3xl font-bold text-gray-900">Location Management</h2><button onclick="optimizeLocations()" class="wms-button warning">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
      </svg> Optimize Layout </button>
    </div><!-- Warehouse Map -->
    <div class="wms-card mb-8">
     <div class="p-6 border-b border-gray-200">
      <h3 class="text-xl font-bold text-gray-900">Warehouse Layout</h3>
     </div>
     <div class="p-6">
      <div id="warehouse-map" class="location-grid"><!-- Location grid will be populated here -->
      </div>
     </div>
    </div>
    <div class="grid lg:grid-cols-2 gap-8"><!-- Location Details -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">Location Details</h3>
      </div>
      <div class="p-6">
       <div id="location-details" class="text-gray-500 text-center py-8">
        Select a location to view details
       </div>
      </div>
     </div><!-- Location Utilization -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">Utilization Stats</h3>
      </div>
      <div class="p-6">
       <div class="space-y-6">
        <div class="flex justify-between items-center"><span class="text-gray-600 font-medium">Total Locations</span> <span class="font-bold text-2xl text-gray-900" id="total-locations">0</span>
        </div>
        <div class="flex justify-between items-center"><span class="text-gray-600 font-medium">Occupied</span> <span class="font-bold text-2xl text-blue-600" id="occupied-locations">0</span>
        </div>
        <div class="flex justify-between items-center"><span class="text-gray-600 font-medium">Utilization Rate</span> <span class="font-bold text-2xl text-green-600" id="utilization-rate">0%</span>
        </div>
       </div>
      </div>
     </div>
    </div>
   </div><!-- Reports Section -->
   <div id="reports-section" class="section-content hidden">
    <div class="flex justify-between items-center mb-6">
     <h2 class="text-3xl font-bold text-gray-900">Reports &amp; Analytics</h2><button onclick="scheduleReport()" class="wms-button warning">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg> Schedule Report </button>
    </div>
    <div class="grid lg:grid-cols-3 gap-8"><!-- Inventory Reports -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">Inventory Reports</h3>
      </div>
      <div class="p-6 space-y-4"><button onclick="generateInventoryReport()" class="wms-button w-full">Inventory Summary</button> <button onclick="generateABCReport()" class="wms-button w-full">ABC Analysis</button> <button onclick="generateVelocityReport()" class="wms-button w-full">Velocity Analysis</button> <button onclick="generateValuationReport()" class="wms-button w-full">Inventory Valuation</button>
      </div>
     </div><!-- Operational Reports -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">Operational Reports</h3>
      </div>
      <div class="p-6 space-y-4"><button onclick="generateReceivingReport()" class="wms-button w-full">Receiving Report</button> <button onclick="generatePickingReport()" class="wms-button w-full">Picking Report</button> <button onclick="generateShippingReport()" class="wms-button w-full">Shipping Report</button> <button onclick="generateCycleCountReport()" class="wms-button w-full">Cycle Count Report</button>
      </div>
     </div><!-- Performance Reports -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">Performance Reports</h3>
      </div>
      <div class="p-6 space-y-4"><button onclick="generateKPIReport()" class="wms-button w-full">KPI Dashboard</button> <button onclick="generateAccuracyReport()" class="wms-button w-full">Accuracy Report</button> <button onclick="generateProductivityReport()" class="wms-button w-full">Productivity Report</button> <button onclick="generateCostReport()" class="wms-button w-full">Cost Analysis</button>
      </div>
     </div>
    </div>
   </div><!-- Cycle Count Section -->
   <div id="cycle-count-section" class="section-content hidden">
    <div class="flex justify-between items-center mb-6">
     <h2 class="text-3xl font-bold text-gray-900">Cycle Count Management</h2><button onclick="startCycleCount()" class="wms-button">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path>
      </svg> Start Cycle Count </button>
    </div>
    <div class="grid lg:grid-cols-2 gap-8"><!-- Pending Counts -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">Pending Counts</h3>
      </div>
      <div class="p-6">
       <div id="pending-counts" class="space-y-4">
        <div class="text-gray-500 text-center py-8">
         No pending cycle counts
        </div>
       </div>
      </div>
     </div><!-- Count History -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">Count History</h3>
      </div>
      <div class="p-6">
       <div id="count-history" class="space-y-4">
        <div class="text-gray-500 text-center py-8">
         No count history
        </div>
       </div>
      </div>
     </div>
    </div>
   </div><!-- Picker Workspace Section -->
   <div id="picker-workspace-section" class="section-content hidden">
    <div class="flex justify-between items-center mb-6">
     <div>
      <h2 class="text-3xl font-bold text-gray-900">My Picking Workspace</h2>
      <p class="text-gray-600" id="picker-welcome">Welcome back, Picker!</p>
     </div>
     <div class="flex items-center space-x-4">
      <div class="text-right">
       <div class="text-sm text-gray-600">
        Current Status
       </div>
       <div class="font-bold text-lg" id="picker-current-status">
        Active
       </div>
      </div><button onclick="toggleMyPickerStatus()" class="wms-button" id="picker-status-toggle-btn"> Set Busy </button> <button onclick="logoutPicker()" class="wms-button danger">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path>
       </svg> Logout </button>
     </div>
    </div><!-- Picker Stats -->
    <div class="grid lg:grid-cols-4 gap-6 mb-8">
     <div class="wms-card">
      <div class="p-6 text-center">
       <div class="text-3xl font-bold text-blue-600" id="my-total-picks">
        0
       </div>
       <div class="text-sm font-medium text-gray-600">
        Total Picks
       </div>
       <div class="text-xs text-gray-500 mt-1">
        All time
       </div>
      </div>
     </div>
     <div class="wms-card">
      <div class="p-6 text-center">
       <div class="text-3xl font-bold text-green-600" id="my-today-picks">
        0
       </div>
       <div class="text-sm font-medium text-gray-600">
        Today's Picks
       </div>
       <div class="text-xs text-gray-500 mt-1">
        Orders completed
       </div>
      </div>
     </div>
     <div class="wms-card">
      <div class="p-6 text-center">
       <div class="text-3xl font-bold text-purple-600" id="my-pick-accuracy">
        100%
       </div>
       <div class="text-sm font-medium text-gray-600">
        Accuracy Rate
       </div>
       <div class="text-xs text-gray-500 mt-1">
        Performance
       </div>
      </div>
     </div>
     <div class="wms-card">
      <div class="p-6 text-center">
       <div class="text-3xl font-bold text-amber-600" id="my-picker-zone">
        ALL
       </div>
       <div class="text-sm font-medium text-gray-600">
        Assigned Zone
       </div>
       <div class="text-xs text-gray-500 mt-1">
        Work area
       </div>
      </div>
     </div>
    </div><!-- Picker Workspace Tabs -->
    <div class="mb-6">
     <div class="border-b border-gray-200">
      <nav class="-mb-px flex space-x-8"><button onclick="showPickerWorkspaceTab('orders')" class="picker-workspace-tab-btn active border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm" data-tab="orders">
        <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg> My Pick Orders </button> <button onclick="showPickerWorkspaceTab('password')" class="picker-workspace-tab-btn border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm" data-tab="password">
        <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m0 0a2 2 0 012 2v6a2 2 0 01-2 2H9a2 2 0 01-2-2V9a2 2 0 012-2m0 0V7a2 2 0 012-2m3 0a3 3 0 11-6 0m3 0a3 3 0 11-6 0"></path>
        </svg> Change Password </button>
      </nav>
     </div>
    </div>
    <div class="grid lg:grid-cols-2 gap-8"><!-- My Pick Orders Tab -->
     <div id="picker-workspace-orders-tab" class="picker-workspace-tab-content wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">My Assigned Pick Orders</h3>
       <p class="text-sm text-gray-600">Orders assigned to me for picking</p>
      </div>
      <div class="p-6">
       <div id="my-pick-orders" class="space-y-3 max-h-96 overflow-y-auto">
        <div class="text-gray-500 text-center py-8">
         No pick orders assigned
        </div>
       </div>
      </div>
     </div><!-- Change Password Tab -->
     <div id="picker-workspace-password-tab" class="picker-workspace-tab-content wms-card hidden">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">Change Password</h3>
       <p class="text-sm text-gray-600">Update your workspace login password</p>
      </div>
      <div class="p-6">
       <form id="picker-change-password-form" onsubmit="changeMyPickerPassword(event)">
        <div class="space-y-4">
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Current Password *</label> <input type="password" name="currentPassword" required class="wms-input w-full" placeholder="Enter your current password">
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">New Password *</label> <input type="password" name="newPassword" required minlength="4" class="wms-input w-full" placeholder="Enter new password (minimum 4 characters)">
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Confirm New Password *</label> <input type="password" name="confirmPassword" required minlength="4" class="wms-input w-full" placeholder="Confirm your new password">
         </div>
         <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
          <div class="flex items-start">
           <svg class="w-5 h-5 text-blue-600 mt-0.5 mr-3" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
           </svg>
           <div>
            <h4 class="text-sm font-medium text-blue-900">Password Requirements</h4>
            <ul class="text-sm text-blue-800 mt-1 list-disc list-inside">
             <li>Minimum 4 characters long</li>
             <li>Use a secure password you can remember</li>
             <li>Don't share your password with others</li>
            </ul>
           </div>
          </div>
         </div>
        </div>
        <div class="mt-6"><button type="submit" class="wms-button w-full" id="picker-change-password-btn">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m0 0a2 2 0 012 2v6a2 2 0 01-2 2H9a2 2 0 01-2-2V9a2 2 0 012-2m0 0V7a2 2 0 012-2m3 0a3 3 0 11-6 0m3 0a3 3 0 11-6 0"></path>
          </svg> Update Password </button>
        </div>
       </form>
      </div>
     </div><!-- My Zone Status -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">My Zone Status</h3>
       <p class="text-sm text-gray-600">Status of my assigned picking zone</p>
      </div>
      <div class="p-6">
       <div id="my-picker-zone-status" class="space-y-3 max-h-96 overflow-y-auto">
        <div class="text-gray-500 text-center py-8">
         Loading zone information...
        </div>
       </div>
      </div>
     </div><!-- My Performance -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">My Performance</h3>
       <p class="text-sm text-gray-600">Recent picking performance metrics</p>
      </div>
      <div class="p-6">
       <div id="my-picker-performance" class="space-y-3 max-h-96 overflow-y-auto">
        <div class="text-gray-500 text-center py-8">
         No performance data available
        </div>
       </div>
      </div>
     </div>
    </div><!-- My Recent Activity -->
    <div class="wms-card mt-8">
     <div class="p-6 border-b border-gray-200">
      <h3 class="text-xl font-bold text-gray-900">My Recent Pick Activity</h3>
     </div>
     <div class="p-6">
      <div id="my-picker-recent-activity" class="space-y-3 max-h-64 overflow-y-auto">
       <div class="text-gray-500 text-center py-8">
        No recent activity
       </div>
      </div>
     </div>
    </div>
   </div><!-- Booker Workspace Section -->
   <div id="booker-workspace-section" class="section-content hidden">
    <div class="flex justify-between items-center mb-6">
     <div>
      <h2 class="text-3xl font-bold text-gray-900">My Workspace</h2>
      <p class="text-gray-600" id="booker-welcome">Welcome back, Booker!</p>
     </div>
     <div class="flex items-center space-x-4">
      <div class="text-right">
       <div class="text-sm text-gray-600">
        Current Status
       </div>
       <div class="font-bold text-lg" id="booker-current-status">
        Active
       </div>
      </div><button onclick="toggleMyStatus()" class="wms-button" id="status-toggle-btn"> Set Busy </button> <button onclick="logoutBooker()" class="wms-button danger">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path>
       </svg> Logout </button>
     </div>
    </div><!-- Booker Stats -->
    <div class="grid lg:grid-cols-4 gap-6 mb-8">
     <div class="wms-card">
      <div class="p-6 text-center">
       <div class="text-3xl font-bold text-blue-600" id="my-total-bookings">
        0
       </div>
       <div class="text-sm font-medium text-gray-600">
        Total Bookings
       </div>
       <div class="text-xs text-gray-500 mt-1">
        All time
       </div>
      </div>
     </div>
     <div class="wms-card">
      <div class="p-6 text-center">
       <div class="text-3xl font-bold text-green-600" id="my-today-bookings">
        0
       </div>
       <div class="text-sm font-medium text-gray-600">
        Today's Work
       </div>
       <div class="text-xs text-gray-500 mt-1">
        Items processed
       </div>
      </div>
     </div>
     <div class="wms-card">
      <div class="p-6 text-center">
       <div class="text-3xl font-bold text-purple-600" id="my-accuracy">
        100%
       </div>
       <div class="text-sm font-medium text-gray-600">
        Accuracy Rate
       </div>
       <div class="text-xs text-gray-500 mt-1">
        Performance
       </div>
      </div>
     </div>
     <div class="wms-card">
      <div class="p-6 text-center">
       <div class="text-3xl font-bold text-amber-600" id="my-assigned-zone">
        ALL
       </div>
       <div class="text-sm font-medium text-gray-600">
        Assigned Zone
       </div>
       <div class="text-xs text-gray-500 mt-1">
        Work area
       </div>
      </div>
     </div>
    </div><!-- Workspace Tabs -->
    <div class="mb-6">
     <div class="border-b border-gray-200">
      <nav class="-mb-px flex space-x-8"><button onclick="showWorkspaceTab('inventory')" class="workspace-tab-btn active border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm" data-tab="inventory">
        <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
        </svg> Add Inventory </button> <button onclick="showWorkspaceTab('password')" class="workspace-tab-btn border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm" data-tab="password">
        <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m0 0a2 2 0 012 2v6a2 2 0 01-2 2H9a2 2 0 01-2-2V9a2 2 0 012-2m0 0V7a2 2 0 012-2m3 0a3 3 0 11-6 0m3 0a3 3 0 11-6 0"></path>
        </svg> Change Password </button>
      </nav>
     </div>
    </div>
    <div class="grid lg:grid-cols-2 gap-8"><!-- Add New Inventory Tab -->
     <div id="workspace-inventory-tab" class="workspace-tab-content wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">Add New Inventory</h3>
       <p class="text-sm text-gray-600">Add items to the warehouse system</p>
      </div>
      <div class="p-6">
       <form id="booker-add-item-form" onsubmit="bookerAddItem(event)">
        <div class="grid grid-cols-2 gap-4 mb-4">
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Item Name *</label> <input type="text" name="name" required class="wms-input w-full" placeholder="Enter item name">
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">SKU *</label> <input type="text" name="sku" required class="wms-input w-full" placeholder="Auto-generated" readonly>
         </div>
        </div>
        <div class="grid grid-cols-3 gap-4 mb-4">
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Description *</label> <textarea name="description" required class="wms-input w-full" rows="3" placeholder="Enter item description"></textarea>
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Location Assignment</label> <select name="locationMode" class="wms-input w-full" onchange="toggleBookerLocationMode()"> <option value="auto">Auto-assign optimal location</option> <option value="manual">Manual location entry</option> </select>
          <div class="text-xs text-gray-500 mt-1">
           Format: AAA.NNN.FFF.PPP (Aisle.Number.Floor.Position)
          </div>
          <div id="booker-manual-location-container" class="hidden mt-2"><input type="text" name="manualLocation" class="wms-input w-full font-mono" placeholder="001.001.001.001" pattern="[0-9]{3}\.[0-9]{3}\.[0-9]{3}\.[0-9]{3}" maxlength="15">
           <div class="text-xs text-red-500 mt-1" id="booker-location-validation-message"></div>
          </div>
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Priority</label> <select name="priority" class="wms-input w-full"> <option value="medium">Medium</option> <option value="high">High</option> <option value="low">Low</option> </select>
         </div>
        </div>
        <div class="grid grid-cols-4 gap-4 mb-4">
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Quantity *</label> <input type="number" name="quantity" required min="0" class="wms-input w-full" placeholder="0">
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Min Stock</label> <input type="number" name="minStock" min="0" class="wms-input w-full" placeholder="0">
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Max Stock</label> <input type="number" name="maxStock" min="0" class="wms-input w-full" placeholder="0">
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Unit Type *</label> <select name="unitType" required class="wms-input w-full"> <option value="">Select unit type</option> <option value="pieces">Pieces</option> <option value="boxes">Boxes</option> <option value="pallets">Pallets</option> <option value="rolls">Rolls</option> <option value="cases">Cases</option> <option value="cartons">Cartons</option> <option value="bags">Bags</option> <option value="bottles">Bottles</option> <option value="units">Units</option> <option value="sets">Sets</option> </select>
         </div>
        </div>
        <div class="grid grid-cols-2 gap-4 mb-4">
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Supplier</label> <input type="text" name="supplier" class="wms-input w-full" placeholder="Supplier name">
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Barcode</label> <input type="text" name="barcode" class="wms-input w-full" placeholder="Barcode">
         </div>
        </div>
        <div class="grid grid-cols-4 gap-4 mb-4">
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Weight (kg)</label> <input type="number" name="weight" min="0" step="0.01" class="wms-input w-full" placeholder="0.00">
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Dimensions</label> <input type="text" name="dimensions" class="wms-input w-full" placeholder="L x W x H">
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Temperature Control</label> <select name="temperatureControl" class="wms-input w-full"> <option value="ambient">Ambient</option> <option value="refrigerated">Refrigerated</option> <option value="frozen">Frozen</option> </select>
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Expiry Date</label> <input type="date" name="expiryDate" class="wms-input w-full" placeholder="Select expiry date">
          <div class="text-xs text-gray-500 mt-1">
           Leave blank for non-perishable items
          </div>
         </div>
        </div><button type="submit" class="wms-button w-full" id="booker-add-item-btn">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
         </svg> Add to Inventory </button>
       </form>
      </div>
     </div><!-- Change Password Tab -->
     <div id="workspace-password-tab" class="workspace-tab-content wms-card hidden">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">Change Password</h3>
       <p class="text-sm text-gray-600">Update your workspace login password</p>
      </div>
      <div class="p-6">
       <form id="change-password-form" onsubmit="changeMyPassword(event)">
        <div class="space-y-4">
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Current Password *</label> <input type="password" name="currentPassword" required class="wms-input w-full" placeholder="Enter your current password">
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">New Password *</label> <input type="password" name="newPassword" required minlength="4" class="wms-input w-full" placeholder="Enter new password (minimum 4 characters)">
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Confirm New Password *</label> <input type="password" name="confirmPassword" required minlength="4" class="wms-input w-full" placeholder="Confirm your new password">
         </div>
         <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
          <div class="flex items-start">
           <svg class="w-5 h-5 text-blue-600 mt-0.5 mr-3" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
           </svg>
           <div>
            <h4 class="text-sm font-medium text-blue-900">Password Requirements</h4>
            <ul class="text-sm text-blue-800 mt-1 list-disc list-inside">
             <li>Minimum 4 characters long</li>
             <li>Use a secure password you can remember</li>
             <li>Don't share your password with others</li>
            </ul>
           </div>
          </div>
         </div>
        </div>
        <div class="mt-6"><button type="submit" class="wms-button w-full" id="change-password-btn">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m0 0a2 2 0 012 2v6a2 2 0 01-2 2H9a2 2 0 01-2-2V9a2 2 0 012-2m0 0V7a2 2 0 012-2m3 0a3 3 0 11-6 0m3 0a3 3 0 11-6 0"></path>
          </svg> Update Password </button>
        </div>
       </form>
      </div>
     </div><!-- My Assigned Items -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">My Assigned Items</h3>
       <p class="text-sm text-gray-600">Items in your assigned zone(s)</p>
      </div>
      <div class="p-6">
       <div id="my-assigned-items" class="space-y-3 max-h-96 overflow-y-auto">
        <div class="text-gray-500 text-center py-8">
         No items assigned to your zone
        </div>
       </div>
      </div>
     </div><!-- Aisle Status Overview -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h3 class="text-xl font-bold text-gray-900">My Aisle Status</h3>
       <p class="text-sm text-gray-600">Status of aisles in your zone</p>
      </div>
      <div class="p-6">
       <div id="my-aisle-status" class="space-y-3 max-h-96 overflow-y-auto">
        <div class="text-gray-500 text-center py-8">
         Loading aisle information...
        </div>
       </div>
      </div>
     </div>
    </div><!-- My Recent Activity -->
    <div class="wms-card mt-8">
     <div class="p-6 border-b border-gray-200">
      <h3 class="text-xl font-bold text-gray-900">My Recent Activity</h3>
     </div>
     <div class="p-6">
      <div id="my-recent-activity" class="space-y-3 max-h-64 overflow-y-auto">
       <div class="text-gray-500 text-center py-8">
        No recent activity
       </div>
      </div>
     </div>
    </div>
   </div>
   
  </main><!-- Add Item Modal -->
  <div id="add-item-modal" class="modal hidden">
   <div class="modal-content">
    <div class="flex justify-between items-center mb-6">
     <h3 class="text-2xl font-bold text-gray-900">Add New Item</h3><button onclick="closeModal('add-item-modal')" class="text-gray-400 hover:text-gray-600">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg></button>
    </div>
    <form id="add-item-form" onsubmit="addItem(event)">
     <div class="grid grid-cols-2 gap-4 mb-4">
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Item Name *</label> <input type="text" name="name" required class="wms-input w-full" placeholder="Enter item name">
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">SKU *</label> <input type="text" name="sku" required class="wms-input w-full" placeholder="Enter SKU">
      </div>
     </div>
     <div class="grid grid-cols-3 gap-4 mb-4">
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Description *</label> <textarea name="description" required class="wms-input w-full" rows="3" placeholder="Enter item description"></textarea>
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Location Assignment</label> <select name="locationMode" class="wms-input w-full" onchange="toggleLocationMode()"> <option value="auto">Auto-assign optimal location</option> <option value="manual">Manual location entry</option> </select>
       <div class="text-xs text-gray-500 mt-1">
        Format: AAA.NNN.FFF.PPP (Aisle.Number.Floor.Position)
       </div>
       <div id="manual-location-container" class="hidden mt-2"><input type="text" name="manualLocation" class="wms-input w-full font-mono" placeholder="001.001.001.001" pattern="[0-9]{3}\.[0-9]{3}\.[0-9]{3}\.[0-9]{3}" maxlength="15">
        <div class="text-xs text-red-500 mt-1" id="location-validation-message"></div>
       </div>
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Priority</label> <select name="priority" class="wms-input w-full"> <option value="medium">Medium</option> <option value="high">High</option> <option value="low">Low</option> </select>
      </div>
     </div>
     <div class="grid grid-cols-4 gap-4 mb-4">
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Quantity *</label> <input type="number" name="quantity" required min="0" class="wms-input w-full" placeholder="0">
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Min Stock</label> <input type="number" name="minStock" min="0" class="wms-input w-full" placeholder="0">
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Max Stock</label> <input type="number" name="maxStock" min="0" class="wms-input w-full" placeholder="0">
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Unit Type *</label> <select name="unitType" required class="wms-input w-full"> <option value="">Select unit type</option> <option value="pieces">Pieces</option> <option value="boxes">Boxes</option> <option value="pallets">Pallets</option> <option value="rolls">Rolls</option> <option value="cases">Cases</option> <option value="cartons">Cartons</option> <option value="bags">Bags</option> <option value="bottles">Bottles</option> <option value="units">Units</option> <option value="sets">Sets</option> </select>
      </div>
     </div>
     <div class="grid grid-cols-2 gap-4 mb-4">
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Supplier</label> <input type="text" name="supplier" class="wms-input w-full" placeholder="Supplier name">
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Barcode</label> <input type="text" name="barcode" class="wms-input w-full" placeholder="Barcode">
      </div>
     </div>
     <div class="grid grid-cols-4 gap-4 mb-4">
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Weight (kg)</label> <input type="number" name="weight" min="0" step="0.01" class="wms-input w-full" placeholder="0.00">
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Dimensions</label> <input type="text" name="dimensions" class="wms-input w-full" placeholder="L x W x H">
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Temperature Control</label> <select name="temperatureControl" class="wms-input w-full"> <option value="ambient">Ambient</option> <option value="refrigerated">Refrigerated</option> <option value="frozen">Frozen</option> </select>
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Expiry Date</label> <input type="date" name="expiryDate" class="wms-input w-full" placeholder="Select expiry date">
       <div class="text-xs text-gray-500 mt-1">
        Leave blank for non-perishable items
       </div>
      </div>
     </div>
     <div class="flex justify-end space-x-4"><button type="button" onclick="closeModal('add-item-modal')" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"> Cancel </button> <button type="submit" class="wms-button" id="add-item-btn">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
       </svg> Add Item </button>
     </div>
    </form>
   </div>
  </div><!-- Receive Modal -->
  <div id="receive-modal" class="modal hidden">
   <div class="modal-content">
    <div class="flex justify-between items-center mb-6">
     <h3 class="text-2xl font-bold text-gray-900">Receive Items</h3><button onclick="closeModal('receive-modal')" class="text-gray-400 hover:text-gray-600">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg></button>
    </div>
    <form id="receive-form" onsubmit="receiveItems(event)">
     <div class="mb-4"><label class="block text-sm font-medium text-gray-700 mb-2">Select Item</label> <select name="itemId" required class="wms-input w-full" id="receive-item-select"> <option value="">Select an item to receive</option> </select>
     </div>
     <div class="grid grid-cols-2 gap-4 mb-4">
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Quantity Received *</label> <input type="number" name="quantity" required min="1" class="wms-input w-full" placeholder="0">
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Received Date</label> <input type="date" name="receivedDate" required class="wms-input w-full">
      </div>
     </div>
     <div class="mb-4"><label class="block text-sm font-medium text-gray-700 mb-2">Notes</label> <textarea name="notes" rows="3" class="wms-input w-full" placeholder="Any notes about this receipt"></textarea>
     </div>
     <div class="flex justify-end space-x-4"><button type="button" onclick="closeModal('receive-modal')" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"> Cancel </button> <button type="submit" class="wms-button success" id="receive-btn">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
       </svg> Receive Items </button>
     </div>
    </form>
   </div>
  </div><!-- Add Booker Modal -->
  <div id="add-booker-modal" class="modal hidden">
   <div class="modal-content">
    <div class="flex justify-between items-center mb-6">
     <h3 class="text-2xl font-bold text-gray-900">Add Professional Booker</h3><button onclick="closeModal('add-booker-modal')" class="text-gray-400 hover:text-gray-600">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg></button>
    </div>
    <form id="add-booker-form" onsubmit="addBooker(event)">
     <div class="grid grid-cols-2 gap-4 mb-4">
      <div><label class="block text-sm font-medium text-gray-700 mb-2">First Name *</label> <input type="text" name="firstName" required class="wms-input w-full" placeholder="John">
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Last Name *</label> <input type="text" name="lastName" required class="wms-input w-full" placeholder="Doe">
      </div>
     </div>
     <div class="grid grid-cols-4 gap-4 mb-4">
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Employee ID *</label> <input type="text" name="employeeId" required class="wms-input w-full" placeholder="BKR001">
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Initials *</label> <input type="text" name="initials" required maxlength="3" class="wms-input w-full" placeholder="JD" style="text-transform: uppercase;">
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Password *</label> <input type="password" name="password" required minlength="4" class="wms-input w-full" placeholder="Enter secure password">
       <div class="text-xs text-gray-500 mt-1">
        Minimum 4 characters for workspace access
       </div>
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Badge Number</label> <input type="text" name="badgeNumber" class="wms-input w-full" placeholder="B001">
      </div>
     </div>
     <div class="grid grid-cols-2 gap-4 mb-4">
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label> <input type="tel" name="phoneNumber" class="wms-input w-full" placeholder="+1 (555) 123-4567">
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Email Address</label> <input type="email" name="email" class="wms-input w-full" placeholder="john.doe@company.com">
      </div>
     </div>
     <div class="grid grid-cols-3 gap-4 mb-4">
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Shift *</label> <select name="shift" required class="wms-input w-full"> <option value="">Select shift</option> <option value="morning">Morning (6AM-2PM)</option> <option value="afternoon">Afternoon (2PM-10PM)</option> <option value="night">Night (10PM-6AM)</option> <option value="flexible">Flexible Hours</option> </select>
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Zone Assignment</label> <select name="zone" class="wms-input w-full"> <option value="A">Zone A (Aisles 001-010)</option> <option value="B">Zone B (Aisles 011-020)</option> <option value="C">Zone C (Aisles 021-030)</option> <option value="D">Zone D (Aisles 031-040)</option> <option value="E">Zone E (Aisles 041-050)</option> <option value="ALL">All Zones</option> </select>
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Experience Level</label> <select name="experience" class="wms-input w-full"> <option value="trainee">Trainee (0-6 months)</option> <option value="junior">Junior (6-18 months)</option> <option value="senior">Senior (1.5-4 years)</option> <option value="expert">Expert (4+ years)</option> <option value="supervisor">Supervisor</option> </select>
      </div>
     </div>
     <div class="grid grid-cols-2 gap-4 mb-4">
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Specializations</label>
       <div class="space-y-2"><label class="flex items-center"> <input type="checkbox" name="specializations" value="receiving" class="mr-2"> <span class="text-sm">Receiving &amp; Inbound</span> </label> <label class="flex items-center"> <input type="checkbox" name="specializations" value="putaway" class="mr-2"> <span class="text-sm">Put-away Operations</span> </label> <label class="flex items-center"> <input type="checkbox" name="specializations" value="inventory" class="mr-2"> <span class="text-sm">Inventory Management</span> </label> <label class="flex items-center"> <input type="checkbox" name="specializations" value="hazmat" class="mr-2"> <span class="text-sm">Hazmat Certified</span> </label>
       </div>
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Equipment Certifications</label>
       <div class="space-y-2"><label class="flex items-center"> <input type="checkbox" name="certifications" value="forklift" class="mr-2"> <span class="text-sm">Forklift Operator</span> </label> <label class="flex items-center"> <input type="checkbox" name="certifications" value="reach_truck" class="mr-2"> <span class="text-sm">Reach Truck</span> </label> <label class="flex items-center"> <input type="checkbox" name="certifications" value="pallet_jack" class="mr-2"> <span class="text-sm">Pallet Jack</span> </label> <label class="flex items-center"> <input type="checkbox" name="certifications" value="crane" class="mr-2"> <span class="text-sm">Overhead Crane</span> </label>
       </div>
      </div>
     </div>
     <div class="mb-4"><label class="block text-sm font-medium text-gray-700 mb-2">Notes</label> <textarea name="notes" rows="3" class="wms-input w-full" placeholder="Additional notes about the booker (optional)"></textarea>
     </div>
     <div class="flex justify-end space-x-4"><button type="button" onclick="closeModal('add-booker-modal')" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"> Cancel </button> <button type="submit" class="wms-button" id="add-booker-btn">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
       </svg> Add Booker </button>
     </div>
    </form>
   </div>
  </div><!-- Edit Booker Modal -->
  <div id="edit-booker-modal" class="modal hidden">
   <div class="modal-content">
    <div class="flex justify-between items-center mb-6">
     <h3 class="text-2xl font-bold text-gray-900">Edit Professional Booker</h3><button onclick="closeModal('edit-booker-modal')" class="text-gray-400 hover:text-gray-600">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg></button>
    </div>
    <form id="edit-booker-form" onsubmit="updateBooker(event)"><input type="hidden" name="bookerId" id="edit-booker-id">
     <div class="grid grid-cols-2 gap-4 mb-4">
      <div><label class="block text-sm font-medium text-gray-700 mb-2">First Name *</label> <input type="text" name="firstName" required class="wms-input w-full" placeholder="John" id="edit-firstName">
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Last Name *</label> <input type="text" name="lastName" required class="wms-input w-full" placeholder="Doe" id="edit-lastName">
      </div>
     </div>
     <div class="grid grid-cols-4 gap-4 mb-4">
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Employee ID *</label> <input type="text" name="employeeId" required class="wms-input w-full" placeholder="BKR001" id="edit-employeeId">
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Initials *</label> <input type="text" name="initials" required maxlength="3" class="wms-input w-full" placeholder="JD" style="text-transform: uppercase;" id="edit-initials">
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">New Password</label> <input type="password" name="password" minlength="4" class="wms-input w-full" placeholder="Leave blank to keep current" id="edit-password">
       <div class="text-xs text-gray-500 mt-1">
        Leave blank to keep current password
       </div>
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Badge Number</label> <input type="text" name="badgeNumber" class="wms-input w-full" placeholder="B001" id="edit-badgeNumber">
      </div>
     </div>
     <div class="grid grid-cols-2 gap-4 mb-4">
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label> <input type="tel" name="phoneNumber" class="wms-input w-full" placeholder="+1 (555) 123-4567" id="edit-phoneNumber">
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Email Address</label> <input type="email" name="email" class="wms-input w-full" placeholder="john.doe@company.com" id="edit-email">
      </div>
     </div>
     <div class="grid grid-cols-4 gap-4 mb-4">
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Shift *</label> <select name="shift" required class="wms-input w-full" id="edit-shift"> <option value="">Select shift</option> <option value="morning">Morning (6AM-2PM)</option> <option value="afternoon">Afternoon (2PM-10PM)</option> <option value="night">Night (10PM-6AM)</option> <option value="flexible">Flexible Hours</option> </select>
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Zone Assignment</label> <select name="zone" class="wms-input w-full" id="edit-zone"> <option value="A">Zone A (Aisles 001-010)</option> <option value="B">Zone B (Aisles 011-020)</option> <option value="C">Zone C (Aisles 021-030)</option> <option value="D">Zone D (Aisles 031-040)</option> <option value="E">Zone E (Aisles 041-050)</option> <option value="ALL">All Zones</option> </select>
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Experience Level</label> <select name="experience" class="wms-input w-full" id="edit-experience"> <option value="trainee">Trainee (0-6 months)</option> <option value="junior">Junior (6-18 months)</option> <option value="senior">Senior (1.5-4 years)</option> <option value="expert">Expert (4+ years)</option> <option value="supervisor">Supervisor</option> </select>
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Status</label> <select name="status" class="wms-input w-full" id="edit-status"> <option value="active">Active</option> <option value="busy">Busy</option> <option value="break">On Break</option> <option value="offline">Offline</option> </select>
      </div>
     </div>
     <div class="grid grid-cols-2 gap-4 mb-4">
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Specializations</label>
       <div class="space-y-2" id="edit-specializations"><label class="flex items-center"> <input type="checkbox" name="specializations" value="receiving" class="mr-2"> <span class="text-sm">Receiving &amp; Inbound</span> </label> <label class="flex items-center"> <input type="checkbox" name="specializations" value="putaway" class="mr-2"> <span class="text-sm">Put-away Operations</span> </label> <label class="flex items-center"> <input type="checkbox" name="specializations" value="inventory" class="mr-2"> <span class="text-sm">Inventory Management</span> </label> <label class="flex items-center"> <input type="checkbox" name="specializations" value="hazmat" class="mr-2"> <span class="text-sm">Hazmat Certified</span> </label>
       </div>
      </div>
      <div><label class="block text-sm font-medium text-gray-700 mb-2">Equipment Certifications</label>
       <div class="space-y-2" id="edit-certifications"><label class="flex items-center"> <input type="checkbox" name="certifications" value="forklift" class="mr-2"> <span class="text-sm">Forklift Operator</span> </label> <label class="flex items-center"> <input type="checkbox" name="certifications" value="reach_truck" class="mr-2"> <span class="text-sm">Reach Truck</span> </label> <label class="flex items-center"> <input type="checkbox" name="certifications" value="pallet_jack" class="mr-2"> <span class="text-sm">Pallet Jack</span> </label> <label class="flex items-center"> <input type="checkbox" name="certifications" value="crane" class="mr-2"> <span class="text-sm">Overhead Crane</span> </label>
       </div>
      </div>
     </div>
     <div class="mb-4"><label class="block text-sm font-medium text-gray-700 mb-2">Notes</label> <textarea name="notes" rows="3" class="wms-input w-full" placeholder="Additional notes about the booker (optional)" id="edit-notes"></textarea>
     </div>
     <div class="flex justify-end space-x-4"><button type="button" onclick="closeModal('edit-booker-modal')" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"> Cancel </button> <button type="submit" class="wms-button" id="edit-booker-btn">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
       </svg> Update Booker </button>
     </div>
    </form>
   </div>
  </div><!-- Manage Pickers Modal -->
  <div id="manage-pickers-modal" class="modal hidden">
   <div class="modal-content max-w-6xl">
    <div class="flex justify-between items-center mb-6">
     <h3 class="text-2xl font-bold text-gray-900">Manage Professional Pickers</h3><button onclick="closeModal('manage-pickers-modal')" class="text-gray-400 hover:text-gray-600">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg></button>
    </div>
    <div class="grid lg:grid-cols-2 gap-8"><!-- Add New Picker -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h4 class="text-lg font-bold text-gray-900">Add New Professional Picker</h4>
       <p class="text-sm text-gray-600">Add warehouse picking staff with workspace access</p>
      </div>
      <div class="p-6">
       <form id="add-picker-form" onsubmit="addPicker(event)">
        <div class="grid grid-cols-2 gap-4 mb-4">
         <div><label class="block text-sm font-medium text-gray-700 mb-2">First Name *</label> <input type="text" name="firstName" required class="wms-input w-full" placeholder="John">
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Last Name *</label> <input type="text" name="lastName" required class="wms-input w-full" placeholder="Doe">
         </div>
        </div>
        <div class="grid grid-cols-4 gap-4 mb-4">
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Employee ID *</label> <input type="text" name="employeeId" required class="wms-input w-full" placeholder="PKR001">
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Initials *</label> <input type="text" name="initials" required maxlength="3" class="wms-input w-full" placeholder="JD" style="text-transform: uppercase;">
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Password *</label> <input type="password" name="password" required minlength="4" class="wms-input w-full" placeholder="Enter secure password">
          <div class="text-xs text-gray-500 mt-1">
           Minimum 4 characters for workspace access
          </div>
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Badge Number</label> <input type="text" name="badgeNumber" class="wms-input w-full" placeholder="P001">
         </div>
        </div>
        <div class="grid grid-cols-2 gap-4 mb-4">
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label> <input type="tel" name="phoneNumber" class="wms-input w-full" placeholder="+1 (555) 123-4567">
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Email Address</label> <input type="email" name="email" class="wms-input w-full" placeholder="john.doe@company.com">
         </div>
        </div>
        <div class="grid grid-cols-3 gap-4 mb-4">
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Shift *</label> <select name="shift" required class="wms-input w-full"> <option value="">Select shift</option> <option value="morning">Morning (6AM-2PM)</option> <option value="afternoon">Afternoon (2PM-10PM)</option> <option value="night">Night (10PM-6AM)</option> <option value="flexible">Flexible Hours</option> </select>
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Zone Assignment</label> <select name="zone" class="wms-input w-full"> <option value="A">Zone A (Aisles 001-010)</option> <option value="B">Zone B (Aisles 011-020)</option> <option value="C">Zone C (Aisles 021-030)</option> <option value="D">Zone D (Aisles 031-040)</option> <option value="E">Zone E (Aisles 041-050)</option> <option value="ALL">All Zones</option> </select>
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Experience Level</label> <select name="experience" class="wms-input w-full"> <option value="trainee">Trainee (0-6 months)</option> <option value="junior">Junior (6-18 months)</option> <option value="senior">Senior (1.5-4 years)</option> <option value="expert">Expert (4+ years)</option> <option value="supervisor">Supervisor</option> </select>
         </div>
        </div>
        <div class="grid grid-cols-2 gap-4 mb-4">
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Specializations</label>
          <div class="space-y-2"><label class="flex items-center"> <input type="checkbox" name="specializations" value="picking" class="mr-2"> <span class="text-sm">Order Picking</span> </label> <label class="flex items-center"> <input type="checkbox" name="specializations" value="batch_picking" class="mr-2"> <span class="text-sm">Batch Picking</span> </label> <label class="flex items-center"> <input type="checkbox" name="specializations" value="zone_picking" class="mr-2"> <span class="text-sm">Zone Picking</span> </label> <label class="flex items-center"> <input type="checkbox" name="specializations" value="hazmat" class="mr-2"> <span class="text-sm">Hazmat Certified</span> </label>
          </div>
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Equipment Certifications</label>
          <div class="space-y-2"><label class="flex items-center"> <input type="checkbox" name="certifications" value="forklift" class="mr-2"> <span class="text-sm">Forklift Operator</span> </label> <label class="flex items-center"> <input type="checkbox" name="certifications" value="reach_truck" class="mr-2"> <span class="text-sm">Reach Truck</span> </label> <label class="flex items-center"> <input type="checkbox" name="certifications" value="pallet_jack" class="mr-2"> <span class="text-sm">Pallet Jack</span> </label> <label class="flex items-center"> <input type="checkbox" name="certifications" value="scanner" class="mr-2"> <span class="text-sm">RF Scanner</span> </label>
          </div>
         </div>
        </div>
        <div class="mb-4"><label class="block text-sm font-medium text-gray-700 mb-2">Notes</label> <textarea name="notes" rows="3" class="wms-input w-full" placeholder="Additional notes about the picker (optional)"></textarea>
        </div><button type="submit" class="wms-button w-full" id="add-picker-btn">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
         </svg> Add Picker </button>
       </form>
      </div>
     </div><!-- Current Pickers List -->
     <div class="wms-card">
      <div class="p-6 border-b border-gray-200">
       <h4 class="text-lg font-bold text-gray-900">Current Pickers</h4>
      </div>
      <div class="p-6">
       <div id="pickers-list" class="space-y-3 max-h-96 overflow-y-auto">
        <div class="text-gray-500 text-center py-8">
         No pickers registered
        </div>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
  <script>
        // Global variables
        let currentSection = 'dashboard';
        let allItems = [];
        let isLoading = false;
        let recordCount = 0;
        let currentUser = null;
        let userRole = 'manager'; // 'manager' or 'booker'

        // Default configuration
        const defaultConfig = {
            company_name: "L.E.S. Logistics Solutions",
            warehouse_name: "Enterprise Warehouse Management",
            manager_name: "Warehouse Manager",
            reorder_threshold: "20",
            cycle_count_frequency: "90"
        };

        // Data handler for SDK
        const dataHandler = {
            onDataChanged(data) {
                allItems = data;
                recordCount = data.length;
                updateDashboardMetrics();
                updateInventoryDisplay();
                updateReceiveItemSelect();
                updateRecentActivity();
                updateLocationMap();
                checkAlerts();
            }
        };

        // Element SDK configuration
        const elementConfig = {
            defaultConfig: defaultConfig,
            onConfigChange: async (config) => {
                document.getElementById('company-name').textContent = config.company_name || defaultConfig.company_name;
                document.getElementById('warehouse-name').textContent = config.warehouse_name || defaultConfig.warehouse_name;
                document.getElementById('manager-name').textContent = config.manager_name || defaultConfig.manager_name;
            },
            mapToCapabilities: (config) => ({
                recolorables: [],
                borderables: [],
                fontEditable: undefined,
                fontSizeable: undefined
            }),
            mapToEditPanelValues: (config) => new Map([
                ["company_name", config.company_name || defaultConfig.company_name],
                ["warehouse_name", config.warehouse_name || defaultConfig.warehouse_name],
                ["manager_name", config.manager_name || defaultConfig.manager_name],
                ["reorder_threshold", config.reorder_threshold || defaultConfig.reorder_threshold],
                ["cycle_count_frequency", config.cycle_count_frequency || defaultConfig.cycle_count_frequency]
            ])
        };

        // Initialize system
        async function initializeSystem() {
            try {
                // Initialize Element SDK
                if (window.elementSdk) {
                    await window.elementSdk.init(elementConfig);
                }

                // Initialize Data SDK
                if (window.dataSdk) {
                    const result = await window.dataSdk.init(dataHandler);
                    if (!result.isOk) {
                        console.error('Failed to initialize data SDK:', result.error);
                        showToast('Failed to initialize data storage', 'error');
                    }
                }

                // Start time updates
                updateCurrentTime();
                setInterval(updateCurrentTime, 1000);

                // Initialize warehouse map
                initializeWarehouseMap();

                // Show login modal on startup
                showLoginModal();

                showToast('L.E.S wms initialized successfully', 'success');
            } catch (error) {
                console.error('Initialization error:', error);
                showToast('System initialization failed', 'error');
            }
        }

        // Permission and Login System
        function showLoginModal() {
            document.getElementById('booker-login-modal').classList.remove('hidden');
        }

        function switchToManager() {
            userRole = 'manager';
            currentUser = null;
            document.getElementById('booker-login-modal').classList.add('hidden');
            updateUIForRole();
            showSection('dashboard');
            showToast('Manager access enabled', 'success');
        }

        async function loginBooker(event) {
            event.preventDefault();
            
            const button = document.getElementById('booker-login-btn');
            const originalText = button.innerHTML;
            button.innerHTML = '<div class="loading-spinner"></div><span class="ml-2">Logging in...</span>';
            button.disabled = true;

            try {
                const formData = new FormData(event.target);
                const initials = formData.get('initials').toUpperCase();
                const password = formData.get('password');
                
                // Find user by initials (booker or picker)
                const user = allItems.find(item => 
                    (item.type === 'booker' || item.type === 'picker') && item.initials === initials
                );
                
                if (!user) {
                    showToast(`No user found with initials "${initials}". Please check your initials or contact your manager.`, 'error');
                    return;
                }
                
                // Validate password
                if (user.password !== password) {
                    showToast(`Incorrect password for ${initials}. Please try again.`, 'error');
                    return;
                }
                
                if (user.status === 'offline') {
                    showToast(`Your account is currently offline. Please contact your manager.`, 'warning');
                    return;
                }
                
                // Login successful - set role based on user type
                userRole = user.type;
                currentUser = user;
                
                // Update user's last active time
                const updatedUser = {
                    ...user,
                    lastActive: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };
                
                if (window.dataSdk) {
                    await window.dataSdk.update(updatedUser);
                }
                
                document.getElementById('booker-login-modal').classList.add('hidden');
                updateUIForRole();
                
                // Navigate to appropriate workspace
                if (user.type === 'booker') {
                    showSection('booker-workspace');
                    updateBookerWorkspace();
                } else if (user.type === 'picker') {
                    showSection('picker-workspace');
                    updatePickerWorkspace();
                }
                
                showToast(`Welcome back, ${user.firstName}!`, 'success');
            } catch (error) {
                console.error('Login error:', error);
                showToast('Login failed', 'error');
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }

        function logoutBooker() {
            userRole = 'manager';
            currentUser = null;
            updateUIForRole();
            showLoginModal();
            showToast('Logged out successfully', 'success');
        }

        function logoutPicker() {
            userRole = 'manager';
            currentUser = null;
            updateUIForRole();
            showLoginModal();
            showToast('Logged out successfully', 'success');
        }

        function updateUIForRole() {
            const navigation = document.querySelector('nav');
            const header = document.querySelector('header');
            
            if (userRole === 'booker') {
                // Hide manager navigation and show limited booker nav
                navigation.innerHTML = `
                    <div class="max-w-7xl mx-auto px-6 lg:px-8 py-4">
                        <div class="flex justify-between items-center">
                            <div class="flex items-center space-x-4">
                                <div class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold">
                                    ${currentUser.initials}
                                </div>
                                <div>
                                    <div class="font-bold text-gray-900">${currentUser.firstName} ${currentUser.lastName}</div>
                                    <div class="text-sm text-gray-600">Zone ${currentUser.zone}  ${currentUser.shift} Shift  Booker</div>
                                </div>
                            </div>
                            <div class="flex items-center space-x-4">
                                <div class="text-sm text-gray-600">
                                    <div class="font-semibold">Status: <span class="text-${getBookerStatusColor(currentUser.status).replace('text-', '')}">${currentUser.status.toUpperCase()}</span></div>
                                </div>
                                <button onclick="logoutBooker()" class="wms-button danger text-sm px-3 py-1">
                                    Logout
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            } else if (userRole === 'picker') {
                // Hide manager navigation and show limited picker nav
                navigation.innerHTML = `
                    <div class="max-w-7xl mx-auto px-6 lg:px-8 py-4">
                        <div class="flex justify-between items-center">
                            <div class="flex items-center space-x-4">
                                <div class="w-10 h-10 bg-green-600 rounded-full flex items-center justify-center text-white font-bold">
                                    ${currentUser.initials}
                                </div>
                                <div>
                                    <div class="font-bold text-gray-900">${currentUser.firstName} ${currentUser.lastName}</div>
                                    <div class="text-sm text-gray-600">Zone ${currentUser.zone}  ${currentUser.shift} Shift  Picker</div>
                                </div>
                            </div>
                            <div class="flex items-center space-x-4">
                                <div class="text-sm text-gray-600">
                                    <div class="font-semibold">Status: <span class="text-${getBookerStatusColor(currentUser.status).replace('text-', '')}">${currentUser.status.toUpperCase()}</span></div>
                                </div>
                                <button onclick="logoutPicker()" class="wms-button danger text-sm px-3 py-1">
                                    Logout
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                // Show full manager navigation
                navigation.innerHTML = `
                    <div class="max-w-7xl mx-auto px-6 lg:px-8 py-4">
                        <div class="flex flex-wrap gap-2">
                            <button onclick="showSection('dashboard')" class="nav-item active" data-section="dashboard">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path>
                                </svg>
                                Dashboard
                            </button>
                            <button onclick="showSection('inventory')" class="nav-item" data-section="inventory">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                                </svg>
                                Inventory
                            </button>
                            <button onclick="showSection('receiving')" class="nav-item" data-section="receiving">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"></path>
                                </svg>
                                Receiving
                            </button>
                            <button onclick="showSection('picking')" class="nav-item" data-section="picking">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                Picking
                            </button>
                            <button onclick="showSection('shipping')" class="nav-item" data-section="shipping">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
                                </svg>
                                Shipping
                            </button>
                            <button onclick="showSection('locations')" class="nav-item" data-section="locations">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                </svg>
                                Locations
                            </button>
                            <button onclick="showSection('reports')" class="nav-item" data-section="reports">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                                </svg>
                                Reports
                            </button>
                            <button onclick="showSection('cycle-count')" class="nav-item" data-section="cycle-count">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path>
                                </svg>
                                Cycle Count
                            </button>
                        </div>
                    </div>
                `;
            }
        }

        async function toggleMyStatus() {
            if (!currentUser) return;
            
            const newStatus = currentUser.status === 'active' ? 'busy' : 'active';
            
            const updatedBooker = {
                ...currentUser,
                status: newStatus,
                lastActive: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };

            try {
                if (window.dataSdk) {
                    const result = await window.dataSdk.update(updatedBooker);
                    if (result.isOk) {
                        currentUser = updatedBooker;
                        updateBookerWorkspace();
                        updateUIForRole();
                        showToast(`Status updated to ${newStatus}`, 'success');
                    } else {
                        showToast('Failed to update status: ' + result.error.message, 'error');
                    }
                }
            } catch (error) {
                console.error('Error updating status:', error);
                showToast('Error updating status', 'error');
            }
        }

        function updateBookerWorkspace() {
            if (!currentUser) return;
            
            // Update welcome message and stats
            document.getElementById('booker-welcome').textContent = `Welcome back, ${currentUser.firstName} ${currentUser.lastName}!`;
            document.getElementById('booker-current-status').textContent = currentUser.status.charAt(0).toUpperCase() + currentUser.status.slice(1);
            document.getElementById('booker-current-status').className = `font-bold text-lg ${getBookerStatusColor(currentUser.status)}`;
            
            const statusBtn = document.getElementById('status-toggle-btn');
            statusBtn.textContent = currentUser.status === 'active' ? 'Set Busy' : 'Set Active';
            
            // Update stats
            document.getElementById('my-total-bookings').textContent = (currentUser.totalBookings || 0).toString();
            document.getElementById('my-today-bookings').textContent = (currentUser.todayBookings || 0).toString();
            document.getElementById('my-accuracy').textContent = `${currentUser.accuracy || 100}%`;
            document.getElementById('my-assigned-zone').textContent = currentUser.zone || 'ALL';
            
            // Generate auto SKU for new items
            generateBookerAutoSKU();
            
            // Update assigned items (items in booker's zone)
            updateMyAssignedItems();
            updateMyAisleStatus();
            updateMyRecentActivity();
        }

        // Generate auto SKU for booker workspace
        function generateBookerAutoSKU() {
            const skuInput = document.querySelector('#booker-add-item-form input[name="sku"]');
            if (skuInput && !skuInput.value && currentUser) {
                const timestamp = Date.now().toString().slice(-6);
                const randomStr = Math.random().toString(36).substring(2, 5).toUpperCase();
                skuInput.value = `${currentUser.initials}-${timestamp}-${randomStr}`;
            }
        }

        // Booker add item function
        async function bookerAddItem(event) {
            event.preventDefault();
            
            if (!currentUser) {
                showToast('User session expired. Please log in again.', 'error');
                return;
            }
            
            if (recordCount >= 999) {
                showToast('Maximum limit of 999 items reached. Please contact your manager.', 'error');
                return;
            }

            const button = document.getElementById('booker-add-item-btn');
            const originalText = button.innerHTML;
            button.innerHTML = '<div class="loading-spinner"></div><span class="ml-2">Adding...</span>';
            button.disabled = true;

            try {
                const formData = new FormData(event.target);
                
                const quantity = parseInt(formData.get('quantity')) || 0;
                const minStock = parseInt(formData.get('minStock')) || Math.max(5, Math.floor(quantity * 0.2));
                const maxStock = parseInt(formData.get('maxStock')) || Math.floor(quantity * 2);
                
                // Determine location based on mode
                const locationMode = formData.get('locationMode');
                let assignedLocation;
                
                if (locationMode === 'manual') {
                    const manualLocation = formData.get('manualLocation');
                    if (!manualLocation || !validateLocationFormat(manualLocation)) {
                        showToast('Please enter a valid location in format AAA.NNN.FFF.PPP', 'error');
                        return;
                    }
                    
                    // Check if location is already occupied
                    const isOccupied = allItems.some(item => item.location === manualLocation);
                    if (isOccupied) {
                        const confirmed = await showConfirmation(`Location ${manualLocation} is already occupied. Do you want to place the item there anyway?`);
                        if (!confirmed) return;
                    }
                    
                    assignedLocation = manualLocation;
                } else {
                    // Auto-assign location based on booker's zone
                    assignedLocation = assignBookerOptimalLocation(currentUser.zone);
                }
                
                const expiryDate = formData.get('expiryDate');
                
                const itemData = {
                    type: 'inventory',
                    id: generateId(),
                    name: formData.get('name'),
                    sku: formData.get('sku'),
                    description: formData.get('description'),
                    location: assignedLocation,
                    quantity: quantity,
                    available: quantity,
                    reserved: 0,
                    minStock: minStock,
                    maxStock: maxStock,
                    reorderPoint: minStock,
                    unitType: formData.get('unitType') || 'pieces',
                    supplier: formData.get('supplier') || '',
                    barcode: formData.get('barcode') || '',
                    weight: parseFloat(formData.get('weight')) || 0,
                    dimensions: formData.get('dimensions') || '',
                    temperatureControl: formData.get('temperatureControl') || 'ambient',
                    expiryDate: expiryDate || '',
                    priority: formData.get('priority') || 'medium',
                    velocity: 'medium',
                    abcClass: 'C',
                    status: 'active',
                    addedBy: currentUser.initials, // Track who added the item
                    addedByName: `${currentUser.firstName} ${currentUser.lastName}`,
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };

                if (window.dataSdk) {
                    const result = await window.dataSdk.create(itemData);
                    if (result.isOk) {
                        // Update booker's today bookings count
                        const updatedBooker = {
                            ...currentUser,
                            todayBookings: (currentUser.todayBookings || 0) + 1,
                            totalBookings: (currentUser.totalBookings || 0) + 1,
                            lastActive: new Date().toISOString(),
                            updatedAt: new Date().toISOString()
                        };
                        
                        await window.dataSdk.update(updatedBooker);
                        currentUser = updatedBooker;
                        
                        showToast(`Item "${itemData.name}" added successfully by ${currentUser.initials}`, 'success');
                        document.getElementById('booker-add-item-form').reset();
                        generateBookerAutoSKU(); // Generate new SKU for next item
                        updateBookerWorkspace();
                    } else {
                        showToast('Failed to add item: ' + result.error.message, 'error');
                    }
                } else {
                    showToast('Data storage not available', 'error');
                }
            } catch (error) {
                console.error('Error adding item:', error);
                showToast('Error adding item', 'error');
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }

        // Assign optimal location within booker's zone
        function assignBookerOptimalLocation(zone) {
            // Get zone ranges
            const zoneRanges = {
                'A': [1, 10],
                'B': [11, 20],
                'C': [21, 30],
                'D': [31, 40],
                'E': [41, 50],
                'ALL': [1, 50]
            };
            
            const range = zoneRanges[zone] || [1, 50];
            const occupiedLocations = new Set(allItems.map(item => item.location).filter(Boolean));
            
            // Find the first available location in the booker's zone
            for (let aisle = range[0]; aisle <= range[1]; aisle++) {
                const aisleStr = aisle.toString().padStart(3, '0');
                
                for (let number = 1; number <= 100; number++) {
                    const numberStr = number.toString().padStart(3, '0');
                    
                    for (let floor = 1; floor <= 5; floor++) {
                        const floorStr = floor.toString().padStart(3, '0');
                        
                        for (let position = 1; position <= 3; position++) {
                            const posStr = position.toString().padStart(3, '0');
                            const location = `${aisleStr}.${numberStr}.${floorStr}.${posStr}`;
                            
                            if (!occupiedLocations.has(location)) {
                                return location;
                            }
                        }
                    }
                }
            }
            
            // If no location available in zone, assign to first available in zone
            const randomAisle = Math.floor(Math.random() * (range[1] - range[0] + 1)) + range[0];
            const randomNumber = Math.floor(Math.random() * 100) + 1;
            const randomFloor = Math.floor(Math.random() * 5) + 1;
            const randomPosition = Math.floor(Math.random() * 3) + 1;
            
            return `${randomAisle.toString().padStart(3, '0')}.${randomNumber.toString().padStart(3, '0')}.${randomFloor.toString().padStart(3, '0')}.${randomPosition.toString().padStart(3, '0')}`;
        }

        function updateMyAssignedItems() {
            const container = document.getElementById('my-assigned-items');
            if (!container || !currentUser) return;
            
            // Filter items by booker's zone
            const myItems = allItems.filter(item => {
                if (item.type !== 'inventory' || !item.location) return false;
                
                if (currentUser.zone === 'ALL') return true;
                
                // Check if item is in booker's zone
                const location = item.location;
                const aisle = parseInt(location.split('.')[0]);
                
                const zoneRanges = {
                    'A': [1, 10],
                    'B': [11, 20], 
                    'C': [21, 30],
                    'D': [31, 40],
                    'E': [41, 50]
                };
                
                const range = zoneRanges[currentUser.zone];
                return range && aisle >= range[0] && aisle <= range[1];
            });
            
            if (myItems.length === 0) {
                container.innerHTML = '<div class="text-gray-500 text-center py-8">No items assigned to your zone</div>';
                return;
            }
            
            container.innerHTML = '';
            myItems.slice(0, 10).forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'p-3 bg-gray-50 border border-gray-200 rounded-lg';
                itemElement.innerHTML = `
                    <div class="flex justify-between items-center">
                        <div>
                            <div class="font-medium text-sm">${item.name}</div>
                            <div class="text-xs text-gray-500">SKU: ${item.sku}</div>
                            <div class="text-xs font-mono text-blue-600"> ${item.location}</div>
                        </div>
                        <div class="text-right">
                            <div class="font-bold text-lg">${item.quantity || 0}</div>
                            <div class="text-xs text-gray-500">${item.unitType || 'units'}</div>
                        </div>
                    </div>
                `;
                container.appendChild(itemElement);
            });
            
            if (myItems.length > 10) {
                const moreElement = document.createElement('div');
                moreElement.className = 'text-center text-sm text-gray-500 py-2';
                moreElement.textContent = `... and ${myItems.length - 10} more items`;
                container.appendChild(moreElement);
            }
        }

        function updateMyAisleStatus() {
            const container = document.getElementById('my-aisle-status');
            if (!container || !currentUser) return;
            
            // Get aisles in booker's zone
            const zoneRanges = {
                'A': [1, 10],
                'B': [11, 20],
                'C': [21, 30], 
                'D': [31, 40],
                'E': [41, 50],
                'ALL': [1, 50]
            };
            
            const range = zoneRanges[currentUser.zone] || [1, 50];
            const aisles = [];
            
            for (let aisle = range[0]; aisle <= range[1]; aisle++) {
                const aisleNum = aisle.toString().padStart(3, '0');
                const itemsInAisle = allItems.filter(item => 
                    item.type === 'inventory' && item.location && item.location.startsWith(aisleNum)
                ).length;
                
                aisles.push({
                    number: aisleNum,
                    itemCount: itemsInAisle,
                    utilization: Math.min(100, Math.round((itemsInAisle / 1500) * 100))
                });
            }
            
            container.innerHTML = '';
            aisles.slice(0, 8).forEach(aisle => {
                const statusColor = aisle.utilization > 80 ? 'text-red-600' : 
                                  aisle.utilization > 50 ? 'text-amber-600' : 'text-green-600';
                const statusBg = aisle.utilization > 80 ? 'bg-red-50' : 
                               aisle.utilization > 50 ? 'bg-amber-50' : 'bg-green-50';
                
                const aisleElement = document.createElement('div');
                aisleElement.className = `p-3 ${statusBg} border border-gray-200 rounded-lg`;
                aisleElement.innerHTML = `
                    <div class="flex justify-between items-center">
                        <div>
                            <div class="font-bold text-gray-900">Aisle ${aisle.number}</div>
                            <div class="text-sm text-gray-600">${aisle.itemCount} items</div>
                        </div>
                        <div class="text-right">
                            <div class="font-bold ${statusColor}">${aisle.utilization}%</div>
                            <div class="text-xs text-gray-500">Utilized</div>
                        </div>
                    </div>
                `;
                container.appendChild(aisleElement);
            });
        }

        function updateMyRecentActivity() {
            const container = document.getElementById('my-recent-activity');
            if (!container || !currentUser) return;
            
            // Get recent items that were updated in booker's zone
            const myRecentItems = allItems.filter(item => {
                if (item.type !== 'inventory' || !item.location || !item.updatedAt) return false;
                
                if (currentUser.zone === 'ALL') return true;
                
                const aisle = parseInt(item.location.split('.')[0]);
                const zoneRanges = {
                    'A': [1, 10],
                    'B': [11, 20],
                    'C': [21, 30],
                    'D': [31, 40], 
                    'E': [41, 50]
                };
                
                const range = zoneRanges[currentUser.zone];
                return range && aisle >= range[0] && aisle <= range[1];
            }).sort((a, b) => new Date(b.updatedAt) - new Date(a.updatedAt)).slice(0, 5);
            
            if (myRecentItems.length === 0) {
                container.innerHTML = '<div class="text-gray-500 text-center py-8">No recent activity in your zone</div>';
                return;
            }
            
            container.innerHTML = '';
            myRecentItems.forEach(item => {
                const activityElement = document.createElement('div');
                activityElement.className = 'flex justify-between items-center p-3 bg-gray-50 rounded-lg';
                activityElement.innerHTML = `
                    <div>
                        <div class="font-medium text-sm">${item.name}</div>
                        <div class="text-xs text-gray-500"> ${item.location}  ${formatDate(item.updatedAt)}</div>
                    </div>
                    <div class="text-right">
                        <div class="font-bold text-sm">${item.quantity || 0}</div>
                        <div class="text-xs text-gray-500">${item.unitType || 'units'}</div>
                    </div>
                `;
                container.appendChild(activityElement);
            });
        }

        // Update current time
        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('en-US', { 
                hour12: false, 
                hour: '2-digit', 
                minute: '2-digit'
            });
            const dateString = now.toLocaleDateString('en-US', { 
                weekday: 'short', 
                month: 'short', 
                day: 'numeric' 
            });
            const timeElement = document.getElementById('current-time');
            if (timeElement) {
                timeElement.textContent = `${dateString} ${timeString}`;
            }
        }

        // Section navigation
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.section-content').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show selected section
            const targetSection = document.getElementById(`${sectionName}-section`);
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }
            
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            const activeNav = document.querySelector(`[data-section="${sectionName}"]`);
            if (activeNav) {
                activeNav.classList.add('active');
            }
            
            currentSection = sectionName;
            
            // Trigger section-specific updates
            if (sectionName === 'locations') {
                updateLocationMap();
            } else if (sectionName === 'inventory') {
                updateInventoryDisplay();
            } else if (sectionName === 'dashboard') {
                updateDashboardMetrics();
                updateRecentActivity();
                checkAlerts();
            }
        }

        // Update dashboard metrics
        function updateDashboardMetrics() {
            const totalItems = allItems.reduce((sum, item) => sum + (item.quantity || 0), 0);
            const totalSKUs = allItems.length;
            const lowStockItems = allItems.filter(item => (item.quantity || 0) <= (item.minStock || 0)).length;
            const outOfStockItems = allItems.filter(item => (item.quantity || 0) === 0).length;

            document.getElementById('total-items').textContent = totalItems.toLocaleString();
            document.getElementById('total-value').textContent = `${totalSKUs} SKUs`;
            document.getElementById('low-stock-count').textContent = lowStockItems;
            document.getElementById('out-stock-count').textContent = outOfStockItems;
        }

        // Update inventory display
        function updateInventoryDisplay() {
            const tableBody = document.getElementById('inventory-table-body');
            if (!tableBody) return;

            if (allItems.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="9" class="px-6 py-12 text-center text-gray-500">
                            <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                            </svg>
                            <p class="text-lg font-medium">No inventory items found</p>
                            <p class="text-sm">Add your first item to get started</p>
                        </td>
                    </tr>
                `;
                return;
            }

            tableBody.innerHTML = '';
            
            allItems.forEach(item => {
                const quantity = item.quantity || 0;
                const available = item.available || quantity;
                const reserved = item.reserved || 0;
                const minStock = item.minStock || 0;
                
                let status = 'in-stock';
                let statusClass = 'status-in-stock';
                
                if (quantity === 0) {
                    status = 'out-stock';
                    statusClass = 'status-out-stock';
                } else if (quantity <= minStock) {
                    status = 'low-stock';
                    statusClass = 'status-low-stock';
                }
                
                const totalValue = quantity * (item.unitCost || 0);
                const velocity = item.velocity || 'medium';
                const priorityClass = getPriorityClass(item.priority);
                
                const row = document.createElement('tr');
                row.className = `hover:bg-gray-50 ${priorityClass}`;
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div>
                            <div class="flex items-center space-x-2">
                                <div class="text-sm font-medium text-gray-900">${item.name || 'Unnamed Item'}</div>
                                ${item.addedBy ? `
                                    <div class="w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center text-white text-xs font-bold" title="Added by ${item.addedByName || item.addedBy}">
                                        ${item.addedBy}
                                    </div>
                                ` : ''}
                            </div>
                            <div class="text-sm text-gray-500">SKU: ${item.sku || 'N/A'}</div>
                            <div class="text-xs text-gray-400">${item.description ? item.description.substring(0, 50) + (item.description.length > 50 ? '...' : '') : 'No description'}</div>
                            ${item.addedBy ? `<div class="text-xs text-blue-600">Added by: ${item.addedBy}</div>` : ''}
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-mono text-gray-900">${item.location || 'Unassigned'}</div>
                        <div class="text-xs text-gray-500">
                            ${item.location ? (() => {
                                const loc = parseLocation(item.location);
                                return `A:${loc.aisle} N:${loc.number} F:${loc.floor} P:${loc.position}`;
                            })() : 'No location assigned'}
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900">${quantity.toLocaleString()} ${item.unitType || 'units'}</div>
                        <div class="text-sm text-gray-500">Available: ${available} | Reserved: ${reserved}</div>
                        <div class="text-xs text-gray-400">Min: ${minStock} | Max: ${item.maxStock || 'N/A'}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900 capitalize">${item.unitType || 'units'}</div>
                        <div class="text-sm text-gray-500">Packaging Type</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900">${formatEntryDate(item.createdAt)}</div>
                        <div class="text-xs text-gray-500">${formatEntryTime(item.createdAt)}</div>
                        <div class="text-xs text-gray-400">Entry Date & Time</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        ${item.expiryDate ? (() => {
                            const expiryDate = new Date(item.expiryDate);
                            const today = new Date();
                            const daysUntilExpiry = Math.ceil((expiryDate - today) / (1000 * 60 * 60 * 24));
                            const isExpired = daysUntilExpiry < 0;
                            const isExpiringSoon = daysUntilExpiry <= 7 && daysUntilExpiry >= 0;
                            
                            return `
                                <div class="text-sm font-medium ${isExpired ? 'text-red-600' : isExpiringSoon ? 'text-amber-600' : 'text-gray-900'}">
                                    ${formatEntryDate(item.expiryDate)}
                                </div>
                                <div class="text-xs ${isExpired ? 'text-red-500 font-bold' : isExpiringSoon ? 'text-amber-500 font-medium' : 'text-gray-500'}">
                                    ${isExpired ? 'EXPIRED' : isExpiringSoon ? `${daysUntilExpiry} days left` : `${daysUntilExpiry} days`}
                                </div>
                                <div class="text-xs text-gray-400">Expiry Date</div>
                            `;
                        })() : `
                            <div class="text-sm text-gray-500">N/A</div>
                            <div class="text-xs text-gray-400">Non-perishable</div>
                        `}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="status-badge velocity-${velocity}">${velocity.toUpperCase()}</span>
                        <div class="text-xs text-gray-500 mt-1">ABC: ${item.abcClass || 'C'}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="status-badge ${statusClass}">${status.replace('-', ' ').toUpperCase()}</span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="editItem('${item.__backendId}')" class="text-indigo-600 hover:text-indigo-900 mr-3">Edit</button>
                        ${userRole === 'manager' ? `<button onclick="deleteItem('${item.__backendId}')" class="text-red-600 hover:text-red-900">Delete</button>` : ''}
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        // Get default icon
        function getCategoryIcon(category) {
            return '';
        }

        // Get priority class
        function getPriorityClass(priority) {
            const classes = {
                high: 'priority-high',
                medium: 'priority-medium',
                low: 'priority-low'
            };
            return classes[priority] || 'priority-medium';
        }

        // Update receive item select
        function updateReceiveItemSelect() {
            const select = document.getElementById('receive-item-select');
            if (!select) return;

            select.innerHTML = '<option value="">Select an item to receive</option>';
            
            allItems.forEach(item => {
                const option = document.createElement('option');
                option.value = item.__backendId;
                option.textContent = `${item.name} (${item.sku}) - Current: ${item.quantity || 0}`;
                select.appendChild(option);
            });
        }

        // Update recent activity
        function updateRecentActivity() {
            const activityContainer = document.getElementById('recent-activity');
            if (!activityContainer) return;

            // Sort items by updatedAt (most recent first)
            const recentItems = [...allItems]
                .filter(item => item.updatedAt)
                .sort((a, b) => new Date(b.updatedAt) - new Date(a.updatedAt))
                .slice(0, 5);

            if (recentItems.length === 0) {
                activityContainer.innerHTML = '<div class="text-gray-500 text-center py-8">No recent activity</div>';
                return;
            }

            activityContainer.innerHTML = '';
            recentItems.forEach(item => {
                const activityItem = document.createElement('div');
                activityItem.className = 'flex items-center justify-between p-3 bg-gray-50 rounded-lg';
                activityItem.innerHTML = `
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
                            ${getCategoryIcon(item.category)}
                        </div>
                        <div>
                            <div class="font-medium text-sm">${item.name}</div>
                            <div class="text-xs text-gray-500">Updated ${formatDate(item.updatedAt)}</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="font-bold text-sm">${item.quantity || 0}</div>
                        <div class="text-xs text-gray-500">${item.location || 'Unassigned'}</div>
                    </div>
                `;
                activityContainer.appendChild(activityItem);
            });
        }

        // Initialize warehouse map with updated system
        function initializeWarehouseMap() {
            const warehouseMap = document.getElementById('warehouse-map');
            if (!warehouseMap) return;

            warehouseMap.innerHTML = '';
            
            // Create header for the warehouse map
            const header = document.createElement('div');
            header.className = 'col-span-full mb-4 p-4 bg-blue-50 rounded-lg border border-blue-200';
            header.innerHTML = `
                <h4 class="text-lg font-bold text-blue-900 mb-2">Warehouse Layout - Enhanced Location System</h4>
                <p class="text-sm text-blue-700">Format: AAA.NNN.FFF.PPP (Aisle.Number.Floor.Position)</p>
                <div class="grid grid-cols-4 gap-4 mt-3 text-xs">
                    <div><span class="font-semibold">Aisles:</span> 001-050 (50 aisles)</div>
                    <div><span class="font-semibold">Numbers:</span> 001-100 (100 numbers each)</div>
                    <div><span class="font-semibold">Floors:</span> 001-005 (5 floors each)</div>
                    <div><span class="font-semibold">Positions:</span> 001-003 (3 positions per floor)</div>
                </div>
            `;
            warehouseMap.appendChild(header);

            // Generate first 20 aisles for display (showing pattern)
            for (let aisle = 1; aisle <= 20; aisle++) {
                const aisleNum = aisle.toString().padStart(3, '0');
                
                // Count items in this aisle
                const itemsInAisle = allItems.filter(item => 
                    item.location && item.location.startsWith(aisleNum)
                ).length;
                
                // Calculate total capacity for this aisle (100 numbers  5 floors  3 positions = 1500 locations)
                const totalCapacity = 1500;
                const utilizationPercent = totalCapacity > 0 ? Math.round((itemsInAisle / totalCapacity) * 100) : 0;
                
                const aisleElement = document.createElement('div');
                aisleElement.className = `location-cell ${itemsInAisle > 0 ? 'occupied' : ''} ${utilizationPercent > 80 ? 'full' : ''}`;
                aisleElement.onclick = () => showAisleDetails(aisleNum);
                
                aisleElement.innerHTML = `
                    <div class="font-bold">Aisle ${aisleNum}</div>
                    <div class="text-xs">${itemsInAisle} items</div>
                    <div class="text-xs text-gray-500">${utilizationPercent}% full</div>
                `;
                warehouseMap.appendChild(aisleElement);
            }
            
            // Add "show more" indicator
            if (allItems.length > 0) {
                const moreElement = document.createElement('div');
                moreElement.className = 'location-cell border-dashed border-2 border-gray-300';
                moreElement.innerHTML = `
                    <div class="text-gray-500 text-xs">
                        <div>+30 more</div>
                        <div>aisles</div>
                        <div>(021-050)</div>
                    </div>
                `;
                warehouseMap.appendChild(moreElement);
            }
        }

        // Update location map
        function updateLocationMap() {
            initializeWarehouseMap();
            updateLocationStats();
        }

        // Update location stats for enhanced system
        function updateLocationStats() {
            const totalLocations = 75000; // 50 aisles  100 numbers  5 floors  3 positions
            const occupiedLocations = new Set(allItems.map(item => 
                item.location
            ).filter(Boolean)).size;
            const utilizationRate = totalLocations > 0 ? ((occupiedLocations / totalLocations) * 100).toFixed(1) : 0;

            document.getElementById('total-locations').textContent = totalLocations.toLocaleString();
            document.getElementById('occupied-locations').textContent = occupiedLocations;
            document.getElementById('utilization-rate').textContent = `${utilizationRate}%`;
        }

        // Show aisle details with floor and position breakdown
        function showAisleDetails(aisleNum) {
            const locationDetails = document.getElementById('location-details');
            if (!locationDetails) return;

            const itemsInAisle = allItems.filter(item => 
                item.location && item.location.startsWith(aisleNum)
            );

            const totalQuantity = itemsInAisle.reduce((sum, item) => 
                sum + (item.quantity || 0), 0
            );

            // Group items by number, floor and position
            const locationBreakdown = {};
            for (let number = 1; number <= 100; number++) {
                const numberStr = number.toString().padStart(3, '0');
                
                for (let floor = 1; floor <= 5; floor++) {
                    for (let position = 1; position <= 3; position++) {
                        const floorStr = floor.toString().padStart(3, '0');
                        const posStr = position.toString().padStart(3, '0');
                        const fullLocation = `${aisleNum}.${numberStr}.${floorStr}.${posStr}`;
                        
                        const itemsAtLocation = itemsInAisle.filter(item => 
                            item.location === fullLocation
                        );
                        
                        if (itemsAtLocation.length > 0) {
                            locationBreakdown[fullLocation] = itemsAtLocation;
                        }
                    }
                }
            }

            locationDetails.innerHTML = `
                <div class="mb-4">
                    <h4 class="text-lg font-bold text-gray-900">Aisle ${aisleNum}</h4>
                    <div class="text-sm text-gray-600 mb-4">
                        Total Capacity: 1,500 locations (100 numbers  5 floors  3 positions)
                    </div>
                    <div class="grid grid-cols-3 gap-4 mb-4">
                        <div class="text-center">
                            <div class="text-2xl font-bold text-blue-600">${itemsInAisle.length}</div>
                            <div class="text-xs text-gray-600">Items</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-green-600">${totalQuantity.toLocaleString()}</div>
                            <div class="text-xs text-gray-600">Total Qty</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-purple-600">${Object.keys(locationBreakdown).length}</div>
                            <div class="text-xs text-gray-600">Occupied</div>
                        </div>
                    </div>
                </div>
                
                ${Object.keys(locationBreakdown).length === 0 ? 
                    '<div class="text-center py-8 text-gray-500">No items in this aisle</div>' :
                    `<div class="space-y-3 max-h-64 overflow-y-auto">
                        ${Object.entries(locationBreakdown).map(([location, items]) => `
                            <div class="border border-gray-200 rounded-lg p-3">
                                <div class="font-bold text-sm text-blue-700 mb-2"> ${location}</div>
                                ${items.map(item => `
                                    <div class="flex justify-between items-center py-1 border-b border-gray-100 last:border-b-0">
                                        <div>
                                            <div class="font-medium text-sm">${item.name}</div>
                                            <div class="text-xs text-gray-500">${item.sku}</div>
                                        </div>
                                        <div class="text-right">
                                            <div class="font-bold text-sm">${item.quantity || 0}</div>
                                            <div class="text-xs text-gray-500">${item.unitType || 'units'}</div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        `).join('')}
                    </div>`
                }
            `;
        }

        // Show location details (legacy function for compatibility)
        function showLocationDetails(locationId) {
            showAisleDetails(locationId);
        }

        // Check alerts
        function checkAlerts() {
            const alertsContainer = document.getElementById('alerts-container');
            if (!alertsContainer) return;

            const criticalItems = allItems.filter(item => (item.quantity || 0) === 0);
            const lowStockItems = allItems.filter(item => {
                const qty = item.quantity || 0;
                const min = item.minStock || 0;
                return qty > 0 && qty <= min;
            });
            
            // Check for expired and expiring items
            const today = new Date();
            const expiredItems = allItems.filter(item => {
                if (!item.expiryDate) return false;
                const expiryDate = new Date(item.expiryDate);
                return expiryDate < today;
            });
            
            const expiringItems = allItems.filter(item => {
                if (!item.expiryDate) return false;
                const expiryDate = new Date(item.expiryDate);
                const daysUntilExpiry = Math.ceil((expiryDate - today) / (1000 * 60 * 60 * 24));
                return daysUntilExpiry <= 7 && daysUntilExpiry >= 0;
            });

            alertsContainer.innerHTML = '';

            if (expiredItems.length > 0) {
                const alert = document.createElement('div');
                alert.className = 'p-4 bg-red-50 border border-red-200 rounded-lg';
                alert.innerHTML = `
                    <div class="flex items-center">
                        <svg class="w-5 h-5 text-red-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <div>
                            <div class="font-bold text-red-800">Expired Items Alert</div>
                            <div class="text-red-700">${expiredItems.length} item(s) have expired and need immediate attention</div>
                        </div>
                    </div>
                `;
                alertsContainer.appendChild(alert);
            }

            if (expiringItems.length > 0) {
                const alert = document.createElement('div');
                alert.className = 'p-4 bg-orange-50 border border-orange-200 rounded-lg';
                alert.innerHTML = `
                    <div class="flex items-center">
                        <svg class="w-5 h-5 text-orange-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <div>
                            <div class="font-bold text-orange-800">Expiring Soon</div>
                            <div class="text-orange-700">${expiringItems.length} item(s) expire within 7 days</div>
                        </div>
                    </div>
                `;
                alertsContainer.appendChild(alert);
            }

            if (criticalItems.length > 0) {
                const alert = document.createElement('div');
                alert.className = 'p-4 bg-red-50 border border-red-200 rounded-lg';
                alert.innerHTML = `
                    <div class="flex items-center">
                        <svg class="w-5 h-5 text-red-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                        </svg>
                        <div>
                            <div class="font-bold text-red-800">Critical Stock Alert</div>
                            <div class="text-red-700">${criticalItems.length} item(s) are out of stock</div>
                        </div>
                    </div>
                `;
                alertsContainer.appendChild(alert);
            }

            if (lowStockItems.length > 0) {
                const alert = document.createElement('div');
                alert.className = 'p-4 bg-amber-50 border border-amber-200 rounded-lg';
                alert.innerHTML = `
                    <div class="flex items-center">
                        <svg class="w-5 h-5 text-amber-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <div>
                            <div class="font-bold text-amber-800">Low Stock Warning</div>
                            <div class="text-amber-700">${lowStockItems.length} item(s) are running low</div>
                        </div>
                    </div>
                `;
                alertsContainer.appendChild(alert);
            }

            if (criticalItems.length === 0 && lowStockItems.length === 0 && expiredItems.length === 0 && expiringItems.length === 0) {
                alertsContainer.innerHTML = '<div class="text-gray-500 text-center py-8">No alerts</div>';
            }
        }

        // Modal functions
        function openAddItemModal() {
            document.getElementById('add-item-modal').classList.remove('hidden');
            generateAutoSKU();
        }

        function openReceiveModal() {
            updateReceiveItemSelect();
            document.getElementById('receive-modal').classList.remove('hidden');
            // Set today's date as default
            const today = new Date().toISOString().split('T')[0];
            document.querySelector('#receive-form input[name="receivedDate"]').value = today;
        }

        function openCreateReceivingModal() {
            createReceivingRecord();
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
            // Reset forms
            const form = document.querySelector(`#${modalId} form`);
            if (form) {
                form.reset();
            }
        }

        // Generate auto SKU
        function generateAutoSKU() {
            const skuInput = document.querySelector('input[name="sku"]');
            if (skuInput && !skuInput.value) {
                const timestamp = Date.now().toString().slice(-6);
                const randomStr = Math.random().toString(36).substring(2, 5).toUpperCase();
                skuInput.value = `WMS-${timestamp}-${randomStr}`;
            }
        }

        // Toggle location mode
        function toggleLocationMode() {
            const locationMode = document.querySelector('select[name="locationMode"]').value;
            const manualContainer = document.getElementById('manual-location-container');
            const manualInput = document.querySelector('input[name="manualLocation"]');
            
            if (locationMode === 'manual') {
                manualContainer.classList.remove('hidden');
                manualInput.addEventListener('input', validateManualLocation);
            } else {
                manualContainer.classList.add('hidden');
                manualInput.removeEventListener('input', validateManualLocation);
                clearLocationValidation();
            }
        }

        // Toggle booker location mode
        function toggleBookerLocationMode() {
            const locationMode = document.querySelector('#booker-add-item-form select[name="locationMode"]').value;
            const manualContainer = document.getElementById('booker-manual-location-container');
            const manualInput = document.querySelector('#booker-add-item-form input[name="manualLocation"]');
            
            if (locationMode === 'manual') {
                manualContainer.classList.remove('hidden');
                manualInput.addEventListener('input', validateBookerManualLocation);
            } else {
                manualContainer.classList.add('hidden');
                manualInput.removeEventListener('input', validateBookerManualLocation);
                clearBookerLocationValidation();
            }
        }

        // Validate manual location input
        function validateManualLocation() {
            const input = document.querySelector('input[name="manualLocation"]');
            const message = document.getElementById('location-validation-message');
            const location = input.value.trim();
            
            if (!location) {
                clearLocationValidation();
                return;
            }
            
            // Check format: AAA.NNN.FFF.PPP
            const locationPattern = /^(\d{3})\.(\d{3})\.(\d{3})\.(\d{3})$/;
            const match = location.match(locationPattern);
            
            if (!match) {
                showLocationError('Invalid format. Use AAA.NNN.FFF.PPP (e.g., 001.001.001.001)');
                return;
            }
            
            const [, aisle, number, floor, position] = match;
            const aisleNum = parseInt(aisle);
            const numberNum = parseInt(number);
            const floorNum = parseInt(floor);
            const positionNum = parseInt(position);
            
            // Validate ranges
            if (aisleNum < 1 || aisleNum > 50) {
                showLocationError('Aisle must be between 001-050');
                return;
            }
            
            if (numberNum < 1 || numberNum > 100) {
                showLocationError('Number must be between 001-100');
                return;
            }
            
            if (floorNum < 1 || floorNum > 5) {
                showLocationError('Floor must be between 001-005');
                return;
            }
            
            if (positionNum < 1 || positionNum > 3) {
                showLocationError('Position must be between 001-003');
                return;
            }
            
            // Check if location is already occupied
            const isOccupied = allItems.some(item => item.location === location);
            if (isOccupied) {
                showLocationWarning(' Location already occupied');
                return;
            }
            
            // Valid location
            showLocationSuccess(' Valid location');
        }

        // Show location validation messages
        function showLocationError(message) {
            const messageEl = document.getElementById('location-validation-message');
            messageEl.textContent = message;
            messageEl.className = 'text-xs text-red-500 mt-1';
        }

        function showLocationWarning(message) {
            const messageEl = document.getElementById('location-validation-message');
            messageEl.textContent = message;
            messageEl.className = 'text-xs text-amber-500 mt-1';
        }

        function showLocationSuccess(message) {
            const messageEl = document.getElementById('location-validation-message');
            messageEl.textContent = message;
            messageEl.className = 'text-xs text-green-500 mt-1';
        }

        function clearLocationValidation() {
            const messageEl = document.getElementById('location-validation-message');
            messageEl.textContent = '';
        }

        // Validate booker manual location input
        function validateBookerManualLocation() {
            const input = document.querySelector('#booker-add-item-form input[name="manualLocation"]');
            const message = document.getElementById('booker-location-validation-message');
            const location = input.value.trim();
            
            if (!location) {
                clearBookerLocationValidation();
                return;
            }
            
            // Check format: AAA.NNN.FFF.PPP
            const locationPattern = /^(\d{3})\.(\d{3})\.(\d{3})\.(\d{3})$/;
            const match = location.match(locationPattern);
            
            if (!match) {
                showBookerLocationError('Invalid format. Use AAA.NNN.FFF.PPP (e.g., 001.001.001.001)');
                return;
            }
            
            const [, aisle, number, floor, position] = match;
            const aisleNum = parseInt(aisle);
            const numberNum = parseInt(number);
            const floorNum = parseInt(floor);
            const positionNum = parseInt(position);
            
            // Validate ranges
            if (aisleNum < 1 || aisleNum > 50) {
                showBookerLocationError('Aisle must be between 001-050');
                return;
            }
            
            if (numberNum < 1 || numberNum > 100) {
                showBookerLocationError('Number must be between 001-100');
                return;
            }
            
            if (floorNum < 1 || floorNum > 5) {
                showBookerLocationError('Floor must be between 001-005');
                return;
            }
            
            if (positionNum < 1 || positionNum > 3) {
                showBookerLocationError('Position must be between 001-003');
                return;
            }
            
            // Check if location is already occupied
            const isOccupied = allItems.some(item => item.location === location);
            if (isOccupied) {
                showBookerLocationWarning(' Location already occupied');
                return;
            }
            
            // Valid location
            showBookerLocationSuccess(' Valid location');
        }

        // Show booker location validation messages
        function showBookerLocationError(message) {
            const messageEl = document.getElementById('booker-location-validation-message');
            messageEl.textContent = message;
            messageEl.className = 'text-xs text-red-500 mt-1';
        }

        function showBookerLocationWarning(message) {
            const messageEl = document.getElementById('booker-location-validation-message');
            messageEl.textContent = message;
            messageEl.className = 'text-xs text-amber-500 mt-1';
        }

        function showBookerLocationSuccess(message) {
            const messageEl = document.getElementById('booker-location-validation-message');
            messageEl.textContent = message;
            messageEl.className = 'text-xs text-green-500 mt-1';
        }

        function clearBookerLocationValidation() {
            const messageEl = document.getElementById('booker-location-validation-message');
            if (messageEl) {
                messageEl.textContent = '';
            }
        }

        // Validate location format (helper function)
        function validateLocationFormat(location) {
            if (!location) return false;
            
            const locationPattern = /^(\d{3})\.(\d{3})\.(\d{3})\.(\d{3})$/;
            const match = location.match(locationPattern);
            
            if (!match) return false;
            
            const [, aisle, number, floor, position] = match;
            const aisleNum = parseInt(aisle);
            const numberNum = parseInt(number);
            const floorNum = parseInt(floor);
            const positionNum = parseInt(position);
            
            // Validate ranges
            return (aisleNum >= 1 && aisleNum <= 50) &&
                   (numberNum >= 1 && numberNum <= 100) &&
                   (floorNum >= 1 && floorNum <= 5) &&
                   (positionNum >= 1 && positionNum <= 3);
        }

        // Add item function
        async function addItem(event) {
            event.preventDefault();
            
            if (recordCount >= 999) {
                showToast('Maximum limit of 999 items reached. Please delete some items first.', 'error');
                return;
            }

            const button = document.getElementById('add-item-btn');
            const originalText = button.innerHTML;
            button.innerHTML = '<div class="loading-spinner"></div><span class="ml-2">Adding...</span>';
            button.disabled = true;

            try {
                const formData = new FormData(event.target);
                
                const quantity = parseInt(formData.get('quantity')) || 0;
                const minStock = parseInt(formData.get('minStock')) || Math.max(5, Math.floor(quantity * 0.2));
                const maxStock = parseInt(formData.get('maxStock')) || Math.floor(quantity * 2);
                
                // Determine location based on mode
                const locationMode = formData.get('locationMode');
                let assignedLocation;
                
                if (locationMode === 'manual') {
                    const manualLocation = formData.get('manualLocation');
                    if (!manualLocation || !validateLocationFormat(manualLocation)) {
                        showToast('Please enter a valid location in format AAA.NNN.FFF.PPP', 'error');
                        return;
                    }
                    
                    // Check if location is already occupied
                    const isOccupied = allItems.some(item => item.location === manualLocation);
                    if (isOccupied) {
                        const confirmed = await showConfirmation(`Location ${manualLocation} is already occupied. Do you want to place the item there anyway?`);
                        if (!confirmed) return;
                    }
                    
                    assignedLocation = manualLocation;
                } else {
                    assignedLocation = assignOptimalLocation();
                }
                
                const expiryDate = formData.get('expiryDate');
                
                const itemData = {
                    type: 'inventory',
                    id: generateId(),
                    name: formData.get('name'),
                    sku: formData.get('sku'),
                    description: formData.get('description'),
                    location: assignedLocation,
                    quantity: quantity,
                    available: quantity,
                    reserved: 0,
                    minStock: minStock,
                    maxStock: maxStock,
                    reorderPoint: minStock,
                    unitType: formData.get('unitType') || 'pieces',
                    supplier: formData.get('supplier') || '',
                    barcode: formData.get('barcode') || '',
                    weight: parseFloat(formData.get('weight')) || 0,
                    dimensions: formData.get('dimensions') || '',
                    temperatureControl: formData.get('temperatureControl') || 'ambient',
                    expiryDate: expiryDate || '',
                    priority: formData.get('priority') || 'medium',
                    velocity: 'medium',
                    abcClass: 'C',
                    status: 'active',
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };

                if (window.dataSdk) {
                    const result = await window.dataSdk.create(itemData);
                    if (result.isOk) {
                        showToast(`Item "${itemData.name}" added successfully`, 'success');
                        closeModal('add-item-modal');
                    } else {
                        showToast('Failed to add item: ' + result.error.message, 'error');
                    }
                } else {
                    showToast('Data storage not available', 'error');
                }
            } catch (error) {
                console.error('Error adding item:', error);
                showToast('Error adding item', 'error');
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }

        // Assign optimal location using enhanced system
        function assignOptimalLocation() {
            // Get all occupied locations
            const occupiedLocations = new Set(allItems.map(item => item.location).filter(Boolean));
            
            // Find the first available location
            for (let aisle = 1; aisle <= 50; aisle++) {
                const aisleStr = aisle.toString().padStart(3, '0');
                
                for (let number = 1; number <= 100; number++) {
                    const numberStr = number.toString().padStart(3, '0');
                    
                    for (let floor = 1; floor <= 5; floor++) {
                        const floorStr = floor.toString().padStart(3, '0');
                        
                        for (let position = 1; position <= 3; position++) {
                            const posStr = position.toString().padStart(3, '0');
                            const location = `${aisleStr}.${numberStr}.${floorStr}.${posStr}`;
                            
                            if (!occupiedLocations.has(location)) {
                                return location;
                            }
                        }
                    }
                }
            }
            
            // If all locations are occupied, assign to a random location (overstock scenario)
            const randomAisle = Math.floor(Math.random() * 50) + 1;
            const randomNumber = Math.floor(Math.random() * 100) + 1;
            const randomFloor = Math.floor(Math.random() * 5) + 1;
            const randomPosition = Math.floor(Math.random() * 3) + 1;
            
            return `${randomAisle.toString().padStart(3, '0')}.${randomNumber.toString().padStart(3, '0')}.${randomFloor.toString().padStart(3, '0')}.${randomPosition.toString().padStart(3, '0')}`;
        }

        // Get location components for display
        function parseLocation(location) {
            if (!location || !location.includes('.')) {
                return { aisle: 'N/A', number: 'N/A', floor: 'N/A', position: 'N/A' };
            }
            
            const parts = location.split('.');
            return {
                aisle: parts[0] || 'N/A',
                number: parts[1] || 'N/A',
                floor: parts[2] || 'N/A', 
                position: parts[3] || 'N/A'
            };
        }

        // Receive items function
        async function receiveItems(event) {
            event.preventDefault();

            const button = document.getElementById('receive-btn');
            const originalText = button.innerHTML;
            button.innerHTML = '<div class="loading-spinner"></div><span class="ml-2">Receiving...</span>';
            button.disabled = true;

            try {
                const formData = new FormData(event.target);
                const itemId = formData.get('itemId');
                const quantityReceived = parseInt(formData.get('quantity')) || 0;

                const item = allItems.find(item => item.__backendId === itemId);
                if (!item) {
                    showToast('Item not found', 'error');
                    return;
                }

                const updatedItem = {
                    ...item,
                    quantity: (item.quantity || 0) + quantityReceived,
                    available: (item.available || item.quantity || 0) + quantityReceived,
                    lastMovement: formData.get('receivedDate'),
                    updatedAt: new Date().toISOString()
                };

                if (window.dataSdk) {
                    const result = await window.dataSdk.update(updatedItem);
                    if (result.isOk) {
                        showToast(`Successfully received ${quantityReceived} units of ${item.name}`, 'success');
                        closeModal('receive-modal');
                    } else {
                        showToast('Failed to receive items: ' + result.error.message, 'error');
                    }
                } else {
                    showToast('Data storage not available', 'error');
                }
            } catch (error) {
                console.error('Error receiving items:', error);
                showToast('Error receiving items', 'error');
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }

        // Filter inventory
        function filterInventory() {
            const searchTerm = document.getElementById('search-inventory').value.toLowerCase();
            const descriptionFilter = document.getElementById('filter-description').value.toLowerCase();
            const locationFilter = document.getElementById('filter-location').value.toLowerCase();
            const statusFilter = document.getElementById('filter-status').value;
            const velocityFilter = document.getElementById('filter-velocity').value;

            const filteredItems = allItems.filter(item => {
                const matchesSearch = !searchTerm || 
                    (item.name && item.name.toLowerCase().includes(searchTerm)) ||
                    (item.sku && item.sku.toLowerCase().includes(searchTerm)) ||
                    (item.barcode && item.barcode.toLowerCase().includes(searchTerm));
                
                const matchesDescription = !descriptionFilter || (item.description && item.description.toLowerCase().includes(descriptionFilter));
                
                const matchesLocation = !locationFilter || (item.location && item.location.toLowerCase().includes(locationFilter));
                
                let matchesStatus = true;
                if (statusFilter) {
                    const quantity = item.quantity || 0;
                    const minStock = item.minStock || 0;
                    
                    if (statusFilter === 'out-stock') {
                        matchesStatus = quantity === 0;
                    } else if (statusFilter === 'low-stock') {
                        matchesStatus = quantity > 0 && quantity <= minStock;
                    } else if (statusFilter === 'in-stock') {
                        matchesStatus = quantity > minStock;
                    }
                }
                
                const matchesVelocity = !velocityFilter || item.velocity === velocityFilter;

                return matchesSearch && matchesDescription && matchesLocation && matchesStatus && matchesVelocity;
            });

            // Update display with filtered items
            const originalItems = allItems;
            allItems = filteredItems;
            updateInventoryDisplay();
            allItems = originalItems;
        }

        // Clear filters
        function clearFilters() {
            document.getElementById('search-inventory').value = '';
            document.getElementById('filter-description').value = '';
            document.getElementById('filter-location').value = '';
            document.getElementById('filter-status').value = '';
            document.getElementById('filter-velocity').value = '';
            updateInventoryDisplay();
        }

        // Edit item
        function editItem(itemId) {
            const item = allItems.find(item => item.__backendId === itemId);
            if (!item) return;
            
            // For now, just show an alert. In a full implementation, this would open an edit modal
            showToast(`Edit functionality for ${item.name} would be implemented here`, 'warning');
        }

        // Delete item
        async function deleteItem(itemId) {
            const item = allItems.find(item => item.__backendId === itemId);
            if (!item) return;

            // Simple confirmation using a custom inline confirmation
            const confirmed = await showConfirmation(`Are you sure you want to delete ${item.name}?`);
            if (!confirmed) return;

            try {
                if (window.dataSdk) {
                    const result = await window.dataSdk.delete(item);
                    if (result.isOk) {
                        showToast(`Item "${item.name}" deleted successfully`, 'success');
                    } else {
                        showToast('Failed to delete item: ' + result.error.message, 'error');
                    }
                } else {
                    showToast('Data storage not available', 'error');
                }
            } catch (error) {
                console.error('Error deleting item:', error);
                showToast('Error deleting item', 'error');
            }
        }

        // Show confirmation dialog (inline implementation)
        function showConfirmation(message) {
            return new Promise((resolve) => {
                const modal = document.createElement('div');
                modal.className = 'modal';
                modal.innerHTML = `
                    <div class="modal-content max-w-md">
                        <h3 class="text-lg font-bold text-gray-900 mb-4">Confirm Action</h3>
                        <p class="text-gray-600 mb-6">${message}</p>
                        <div class="flex justify-end space-x-4">
                            <button onclick="resolveConfirmation(false)" class="px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                                Cancel
                            </button>
                            <button onclick="resolveConfirmation(true)" class="wms-button danger">
                                Delete
                            </button>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
                
                window.resolveConfirmation = (result) => {
                    document.body.removeChild(modal);
                    delete window.resolveConfirmation;
                    resolve(result);
                };
            });
        }

        // Utility functions
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        function formatDate(dateString) {
            if (!dateString) return 'N/A';
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { 
                month: 'short', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function formatEntryDate(dateString) {
            if (!dateString) return 'N/A';
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { 
                year: 'numeric',
                month: 'short', 
                day: 'numeric'
            });
        }

        function formatEntryTime(dateString) {
            if (!dateString) return 'N/A';
            const date = new Date(dateString);
            return date.toLocaleTimeString('en-US', { 
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: true
            });
        }

        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                if (document.body.contains(toast)) {
                    document.body.removeChild(toast);
                }
            }, 3000);
        }

        // Create Pick List Modal
        function createPickList() {
            if (allItems.length === 0) {
                showToast('No inventory items available for picking', 'warning');
                return;
            }
            
            const availableItems = allItems.filter(item => (item.quantity || 0) > 0);
            if (availableItems.length === 0) {
                showToast('No items with available stock for picking', 'warning');
                return;
            }
            
            openCreatePickListModal();
        }

        function openCreatePickListModal() {
            const pickers = allItems.filter(item => item.type === 'picker' && item.status === 'active');
            
            if (pickers.length === 0) {
                showToast('No active pickers available. Please add pickers first.', 'warning');
                return;
            }
            
            const modal = document.createElement('div');
            modal.id = 'create-pick-modal';
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content max-w-5xl">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-bold text-gray-900">Create Professional Pick Order</h3>
                        <button onclick="closeModal('create-pick-modal')" class="text-gray-400 hover:text-gray-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    <form id="create-pick-form" onsubmit="submitPickList(event)">
                        <div class="grid lg:grid-cols-2 gap-6 mb-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Order Number *</label>
                                <input type="text" name="orderNumber" required class="wms-input w-full" placeholder="ORD-${Date.now().toString().slice(-6)}" value="ORD-${Date.now().toString().slice(-6)}">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Customer/Reference</label>
                                <input type="text" name="customer" class="wms-input w-full" placeholder="Customer name or reference">
                            </div>
                        </div>
                        
                        <div class="grid lg:grid-cols-3 gap-4 mb-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Assign to Picker *</label>
                                <select name="assignedPicker" required class="wms-input w-full">
                                    <option value="">Select a picker</option>
                                    ${pickers.map(picker => `
                                        <option value="${picker.__backendId}" data-initials="${picker.initials}">
                                            ${picker.initials} - ${picker.firstName} ${picker.lastName} (${picker.zone})
                                        </option>
                                    `).join('')}
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Priority Level *</label>
                                <select name="priority" required class="wms-input w-full">
                                    <option value="medium">Medium - Standard</option>
                                    <option value="high">High - Rush Order</option>
                                    <option value="urgent">Urgent - Same Day</option>
                                    <option value="low">Low - Bulk/Non-Critical</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Due Date</label>
                                <input type="datetime-local" name="dueDate" class="wms-input w-full">
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Pick Route Optimization</label>
                            <select name="routeOptimization" class="wms-input w-full">
                                <option value="zone">Zone-based (by aisle sequence)</option>
                                <option value="shortest">Shortest path (minimize travel)</option>
                                <option value="priority">Priority items first</option>
                                <option value="manual">Manual order (as selected)</option>
                            </select>
                        </div>
                        
                        <div class="mb-6">
                            <div class="flex justify-between items-center mb-3">
                                <label class="block text-sm font-medium text-gray-700">Select Items to Pick</label>
                                <div class="flex space-x-2">
                                    <button type="button" onclick="selectAllItems()" class="text-sm text-blue-600 hover:text-blue-800">Select All</button>
                                    <button type="button" onclick="clearAllItems()" class="text-sm text-gray-600 hover:text-gray-800">Clear All</button>
                                </div>
                            </div>
                            <div class="max-h-80 overflow-y-auto border border-gray-200 rounded-lg">
                                <div id="pick-items-list" class="p-4 space-y-3">
                                    ${generatePickItemsList()}
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Special Instructions</label>
                            <textarea name="instructions" rows="3" class="wms-input w-full" placeholder="Any special handling instructions, fragile items, temperature requirements, etc."></textarea>
                        </div>
                        
                        <div class="flex justify-end space-x-4">
                            <button type="button" onclick="closeModal('create-pick-modal')" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                                Cancel
                            </button>
                            <button type="submit" class="wms-button" id="create-pick-btn">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                Create Pick Order
                            </button>
                        </div>
                    </form>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Set default due date to 4 hours from now
            const dueDateInput = document.querySelector('input[name="dueDate"]');
            const defaultDue = new Date();
            defaultDue.setHours(defaultDue.getHours() + 4);
            dueDateInput.value = defaultDue.toISOString().slice(0, 16);
        }

        function generatePickItemsList() {
            const availableItems = allItems.filter(item => (item.quantity || 0) > 0);
            
            if (availableItems.length === 0) {
                return '<div class="text-gray-500 text-center py-4">No items available for picking</div>';
            }
            
            return availableItems.map(item => `
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                    <div class="flex items-center space-x-3">
                        <input type="checkbox" name="pickItems" value="${item.__backendId}" class="w-4 h-4 text-blue-600 rounded">
                        <div>
                            <div class="font-medium text-sm">${item.name}</div>
                            <div class="text-xs text-gray-500">SKU: ${item.sku} | Location: ${item.location || 'Unassigned'}</div>
                            <div class="text-xs text-gray-600">Available: ${item.quantity || 0} ${item.unitType || 'units'}</div>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <label class="text-xs text-gray-600">Qty:</label>
                        <input type="number" name="pickQty_${item.__backendId}" min="1" max="${item.quantity || 0}" 
                               class="w-16 px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                    </div>
                </div>
            `).join('');
        }

        async function submitPickList(event) {
            event.preventDefault();
            
            if (recordCount >= 999) {
                showToast('Maximum limit of 999 records reached. Please delete some items first.', 'error');
                return;
            }

            const button = document.getElementById('create-pick-btn');
            const originalText = button.innerHTML;
            button.innerHTML = '<div class="loading-spinner"></div><span class="ml-2">Creating...</span>';
            button.disabled = true;

            try {
                const formData = new FormData(event.target);
                const orderNumber = formData.get('orderNumber');
                const customer = formData.get('customer') || '';
                const assignedPickerId = formData.get('assignedPicker');
                const priority = formData.get('priority');
                const dueDate = formData.get('dueDate');
                const routeOptimization = formData.get('routeOptimization');
                const instructions = formData.get('instructions') || '';
                const selectedItems = formData.getAll('pickItems');
                
                if (!assignedPickerId) {
                    showToast('Please select a picker for this order', 'warning');
                    return;
                }
                
                if (selectedItems.length === 0) {
                    showToast('Please select at least one item to pick', 'warning');
                    return;
                }
                
                // Get picker details
                const assignedPicker = allItems.find(item => item.__backendId === assignedPickerId && item.type === 'picker');
                if (!assignedPicker) {
                    showToast('Selected picker not found', 'error');
                    return;
                }
                
                const pickItems = [];
                let totalItems = 0;
                
                for (const itemId of selectedItems) {
                    const quantity = parseInt(formData.get(`pickQty_${itemId}`)) || 0;
                    if (quantity > 0) {
                        const item = allItems.find(i => i.__backendId === itemId && i.type === 'inventory');
                        if (item && quantity <= (item.quantity || 0)) {
                            pickItems.push({
                                itemId: itemId,
                                itemName: item.name,
                                sku: item.sku,
                                location: item.location,
                                quantityToPick: quantity,
                                quantityPicked: 0,
                                status: 'pending'
                            });
                            totalItems += quantity;
                        }
                    }
                }
                
                if (pickItems.length === 0) {
                    showToast('Please enter valid quantities for selected items', 'warning');
                    return;
                }
                
                // Apply route optimization
                const optimizedItems = optimizePickRoute(pickItems, routeOptimization);
                
                const pickOrderData = {
                    type: 'pick_order',
                    id: generateId(),
                    orderNumber: orderNumber,
                    customer: customer,
                    priority: priority,
                    status: 'assigned',
                    totalItems: totalItems,
                    itemsPicked: 0,
                    items: JSON.stringify(optimizedItems),
                    assignedPickerId: assignedPickerId,
                    pickerInitials: assignedPicker.initials,
                    pickerName: `${assignedPicker.firstName} ${assignedPicker.lastName}`,
                    dueDate: dueDate,
                    routeOptimization: routeOptimization,
                    instructions: instructions,
                    estimatedTime: calculateEstimatedTime(optimizedItems, assignedPicker.experience),
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };

                if (window.dataSdk) {
                    const result = await window.dataSdk.create(pickOrderData);
                    if (result.isOk) {
                        // Update picker status to busy
                        const updatedPicker = {
                            ...assignedPicker,
                            status: 'busy',
                            lastActive: new Date().toISOString(),
                            updatedAt: new Date().toISOString()
                        };
                        await window.dataSdk.update(updatedPicker);
                        
                        showToast(`Pick order "${orderNumber}" assigned to ${assignedPicker.initials} successfully`, 'success');
                        closeModal('create-pick-modal');
                        if (currentSection === 'picking') {
                            updatePickingSection();
                        }
                    } else {
                        showToast('Failed to create pick order: ' + result.error.message, 'error');
                    }
                } else {
                    showToast('Data storage not available', 'error');
                }
            } catch (error) {
                console.error('Error creating pick order:', error);
                showToast('Error creating pick order', 'error');
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }

        function optimizePickRoute(items, optimization) {
            switch (optimization) {
                case 'zone':
                    return items.sort((a, b) => {
                        const locA = a.location || 'ZZZ.999.999.999';
                        const locB = b.location || 'ZZZ.999.999.999';
                        return locA.localeCompare(locB);
                    });
                case 'shortest':
                    // Simple optimization: sort by aisle then by position
                    return items.sort((a, b) => {
                        const locA = a.location || 'ZZZ.999.999.999';
                        const locB = b.location || 'ZZZ.999.999.999';
                        const [aisleA, numA, floorA, posA] = locA.split('.');
                        const [aisleB, numB, floorB, posB] = locB.split('.');
                        
                        if (aisleA !== aisleB) return aisleA.localeCompare(aisleB);
                        if (numA !== numB) return numA.localeCompare(numB);
                        if (floorA !== floorB) return floorA.localeCompare(floorB);
                        return posA.localeCompare(posB);
                    });
                case 'priority':
                    // Sort by quantity (larger quantities first for efficiency)
                    return items.sort((a, b) => b.quantityToPick - a.quantityToPick);
                case 'manual':
                default:
                    return items; // Keep original order
            }
        }

        function calculateEstimatedTime(items, experience) {
            const baseTimePerItem = {
                'trainee': 2.5,
                'junior': 2.0,
                'senior': 1.5,
                'expert': 1.2
            };
            
            const timePerItem = baseTimePerItem[experience] || 2.0;
            const totalItems = items.reduce((sum, item) => sum + item.quantityToPick, 0);
            const travelTime = items.length * 0.5; // 30 seconds travel between locations
            
            return Math.round(totalItems * timePerItem + travelTime);
        }

        async function completePickList(pickListId) {
            const pickList = allItems.find(item => item.__backendId === pickListId && item.type === 'pick_list');
            if (!pickList) {
                showToast('Pick list not found', 'error');
                return;
            }

            const confirmed = await showConfirmation(`Complete pick list "${pickList.name}"? This will update inventory levels.`);
            if (!confirmed) return;

            try {
                const pickItems = JSON.parse(pickList.items || '[]');
                
                // Update inventory for each picked item
                for (const pickItem of pickItems) {
                    const inventoryItem = allItems.find(item => 
                        item.__backendId === pickItem.itemId && item.type === 'inventory'
                    );
                    
                    if (inventoryItem) {
                        const newQuantity = Math.max(0, (inventoryItem.quantity || 0) - pickItem.quantityToPick);
                        const newAvailable = Math.max(0, (inventoryItem.available || inventoryItem.quantity || 0) - pickItem.quantityToPick);
                        
                        const updatedItem = {
                            ...inventoryItem,
                            quantity: newQuantity,
                            available: newAvailable,
                            lastMovement: new Date().toISOString(),
                            updatedAt: new Date().toISOString()
                        };

                        if (window.dataSdk) {
                            await window.dataSdk.update(updatedItem);
                        }
                    }
                }
                
                // Update pick list status
                const updatedPickList = {
                    ...pickList,
                    status: 'completed',
                    itemsPicked: pickList.totalItems,
                    completedAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };

                if (window.dataSdk) {
                    const result = await window.dataSdk.update(updatedPickList);
                    if (result.isOk) {
                        showToast(`Pick list "${pickList.name}" completed successfully`, 'success');
                        updatePickingSection();
                    } else {
                        showToast('Failed to complete pick list: ' + result.error.message, 'error');
                    }
                }
            } catch (error) {
                console.error('Error completing pick list:', error);
                showToast('Error completing pick list', 'error');
            }
        }

        // Update section-specific content
        function updateReceivingSection() {
            const pendingReceipts = document.getElementById('pending-receipts');
            const recentReceipts = document.getElementById('recent-receipts');
            
            // Get all receiving records from data
            const receivingRecords = allItems.filter(item => item.type === 'receiving_record');
            const pendingReceiving = receivingRecords.filter(record => record.status === 'pending' || record.status === 'scheduled');
            const recentReceiving = receivingRecords.filter(record => record.status === 'completed')
                .sort((a, b) => new Date(b.completedAt || b.updatedAt) - new Date(a.completedAt || a.updatedAt))
                .slice(0, 10);
            
            // Update pending receipts
            if (pendingReceipts) {
                if (pendingReceiving.length === 0) {
                    pendingReceipts.innerHTML = `
                        <div class="text-center py-8">
                            <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"></path>
                            </svg>
                            <p class="text-gray-500 font-medium">No pending receipts</p>
                            <p class="text-gray-400 text-sm">All shipments are up to date</p>
                        </div>
                    `;
                } else {
                    pendingReceipts.innerHTML = `
                        <div class="space-y-3">
                            ${pendingReceiving.map(record => {
                                const isOverdue = record.expectedDate && new Date(record.expectedDate) < new Date();
                                const statusColor = record.status === 'pending' ? (isOverdue ? 'red' : 'amber') : 'blue';
                                
                                return `
                                    <div class="p-4 bg-${statusColor}-50 border border-${statusColor}-200 rounded-lg">
                                        <div class="flex justify-between items-start mb-2">
                                            <div class="flex-1">
                                                <div class="font-bold text-${statusColor}-800">${record.poNumber || record.referenceNumber}</div>
                                                <div class="text-sm text-${statusColor}-700">${record.supplier || 'Unknown Supplier'}</div>
                                                <div class="text-xs text-${statusColor}-600">
                                                    Expected: ${record.expectedDate ? formatDate(record.expectedDate) : 'TBD'}
                                                    ${isOverdue ? ' (OVERDUE)' : ''}
                                                </div>
                                                <div class="text-xs text-${statusColor}-600">
                                                    ${record.itemCount || 0} items  ${record.totalQuantity || 0} units
                                                </div>
                                            </div>
                                            <div class="flex flex-col space-y-1">
                                                <button onclick="processReceiving('${record.__backendId}')" class="wms-button success text-xs px-3 py-1">
                                                    ${record.status === 'pending' ? 'Process' : 'Review'}
                                                </button>
                                                <button onclick="viewReceivingDetails('${record.__backendId}')" class="wms-button text-xs px-3 py-1">Details</button>
                                            </div>
                                        </div>
                                        ${record.notes ? `
                                            <div class="text-xs text-${statusColor}-700 bg-${statusColor}-100 p-2 rounded mt-2">
                                                <strong>Notes:</strong> ${record.notes}
                                            </div>
                                        ` : ''}
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    `;
                }
            }
            
            // Update recent receipts
            if (recentReceipts) {
                if (recentReceiving.length === 0) {
                    recentReceipts.innerHTML = `
                        <div class="text-center py-8">
                            <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <p class="text-gray-500 font-medium">No recent receipts</p>
                            <p class="text-gray-400 text-sm">Completed receipts will appear here</p>
                        </div>
                    `;
                } else {
                    recentReceipts.innerHTML = `
                        <div class="space-y-3">
                            ${recentReceiving.map(record => `
                                <div class="p-3 bg-green-50 border border-green-200 rounded-lg">
                                    <div class="flex justify-between items-start">
                                        <div class="flex-1">
                                            <div class="font-medium text-green-800">${record.poNumber || record.referenceNumber}</div>
                                            <div class="text-sm text-green-700">${record.supplier || 'Unknown Supplier'}</div>
                                            <div class="text-xs text-green-600">
                                                Received: ${formatDate(record.completedAt || record.updatedAt)}
                                            </div>
                                            <div class="text-xs text-green-600">
                                                ${record.itemCount || 0} items  ${record.totalQuantity || 0} units
                                            </div>
                                        </div>
                                        <div class="text-right">
                                            <div class="text-sm font-bold text-green-800">${record.receivedBy || 'System'}</div>
                                            <div class="text-xs text-green-600">Received by</div>
                                            <button onclick="viewReceivingDetails('${record.__backendId}')" class="text-xs text-green-700 hover:text-green-900 underline mt-1">
                                                View Details
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                }
            }
        }

        function updatePickingSection(pickerFilter = '', priorityFilter = '') {
            const activePicks = document.getElementById('active-picks');
            const pickerStatus = document.getElementById('picker-status');
            const completedPicks = document.getElementById('completed-picks');
            
            // Get all pick orders and pickers
            const pickOrders = allItems.filter(item => item.type === 'pick_order');
            const pickers = allItems.filter(item => item.type === 'picker');
            
            // Filter pick orders
            let filteredOrders = pickOrders.filter(order => order.status === 'assigned' || order.status === 'in_progress');
            
            if (pickerFilter) {
                filteredOrders = filteredOrders.filter(order => order.assignedPickerId === pickerFilter);
            }
            
            if (priorityFilter) {
                filteredOrders = filteredOrders.filter(order => order.priority === priorityFilter);
            }
            
            // Update active pick orders
            if (activePicks) {
                if (filteredOrders.length === 0) {
                    activePicks.innerHTML = `
                        <div class="text-gray-500 text-center py-8">
                            <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <p class="text-lg font-medium">No active pick orders</p>
                            <p class="text-sm">Create a pick order to get started</p>
                        </div>
                    `;
                } else {
                    activePicks.innerHTML = `
                        <div class="space-y-4">
                            ${filteredOrders.map(order => {
                                const items = JSON.parse(order.items || '[]');
                                const priorityClass = getPriorityClass(order.priority);
                                const priorityColor = getPriorityColor(order.priority);
                                const dueDate = order.dueDate ? new Date(order.dueDate) : null;
                                const isOverdue = dueDate && dueDate < new Date();
                                
                                return `
                                    <div class="p-4 bg-white border-l-4 ${priorityClass} rounded-lg shadow-sm">
                                        <div class="flex justify-between items-start mb-3">
                                            <div class="flex-1">
                                                <div class="flex items-center space-x-3 mb-2">
                                                    <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold text-sm">
                                                        ${order.pickerInitials}
                                                    </div>
                                                    <div>
                                                        <div class="font-bold text-gray-900">${order.orderNumber}</div>
                                                        <div class="text-sm text-gray-600">${order.customer || 'No customer specified'}</div>
                                                    </div>
                                                </div>
                                                <div class="grid grid-cols-2 gap-4 text-sm mb-2">
                                                    <div>
                                                        <span class="text-gray-600">Picker:</span> 
                                                        <span class="font-medium">${order.pickerName}</span>
                                                    </div>
                                                    <div>
                                                        <span class="text-gray-600">Priority:</span> 
                                                        <span class="font-bold ${priorityColor} uppercase">${order.priority}</span>
                                                    </div>
                                                    <div>
                                                        <span class="text-gray-600">Items:</span> 
                                                        <span class="font-medium">${items.length} types, ${order.totalItems} units</span>
                                                    </div>
                                                    <div>
                                                        <span class="text-gray-600">Est. Time:</span> 
                                                        <span class="font-medium">${order.estimatedTime || 0} min</span>
                                                    </div>
                                                </div>
                                                ${dueDate ? `
                                                    <div class="text-xs ${isOverdue ? 'text-red-600 font-bold' : 'text-gray-600'}">
                                                        Due: ${dueDate.toLocaleString()} ${isOverdue ? '(OVERDUE)' : ''}
                                                    </div>
                                                ` : ''}
                                                ${order.instructions ? `
                                                    <div class="text-xs text-blue-700 bg-blue-50 p-2 rounded mt-2">
                                                        <strong>Instructions:</strong> ${order.instructions}
                                                    </div>
                                                ` : ''}
                                            </div>
                                            <div class="flex flex-col space-y-2">
                                                <button onclick="viewPickOrderDetails('${order.__backendId}')" class="wms-button text-xs px-3 py-1">View Details</button>
                                                <button onclick="startPickOrder('${order.__backendId}')" class="wms-button success text-xs px-3 py-1">Start Picking</button>
                                                <button onclick="completePickOrder('${order.__backendId}')" class="wms-button warning text-xs px-3 py-1">Complete</button>
                                            </div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    `;
                }
            }
            
            // Update picker status
            if (pickerStatus) {
                if (pickers.length === 0) {
                    pickerStatus.innerHTML = '<div class="text-gray-500 text-center py-8">No pickers registered</div>';
                } else {
                    pickerStatus.innerHTML = `
                        <div class="space-y-3">
                            ${pickers.map(picker => {
                                const assignedOrders = pickOrders.filter(order => 
                                    order.assignedPickerId === picker.__backendId && 
                                    (order.status === 'assigned' || order.status === 'in_progress')
                                ).length;
                                
                                const statusColor = picker.status === 'active' ? 'text-green-600' : 
                                                  picker.status === 'busy' ? 'text-blue-600' : 'text-gray-600';
                                const statusBg = picker.status === 'active' ? 'bg-green-50' : 
                                               picker.status === 'busy' ? 'bg-blue-50' : 'bg-gray-50';
                                
                                return `
                                    <div class="p-3 ${statusBg} border border-gray-200 rounded-lg">
                                        <div class="flex items-center justify-between">
                                            <div class="flex items-center space-x-2">
                                                <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold text-xs">
                                                    ${picker.initials}
                                                </div>
                                                <div>
                                                    <div class="font-medium text-sm">${picker.firstName} ${picker.lastName}</div>
                                                    <div class="text-xs text-gray-600">Zone ${picker.zone}  ${picker.experience}</div>
                                                </div>
                                            </div>
                                            <div class="text-right">
                                                <div class="text-xs ${statusColor} font-bold uppercase">${picker.status}</div>
                                                <div class="text-xs text-gray-600">${assignedOrders} orders</div>
                                            </div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    `;
                }
            }
            
            // Update completed orders
            const completedOrders = pickOrders.filter(order => order.status === 'completed');
            const todayCompleted = completedOrders.filter(order => {
                const today = new Date().toDateString();
                const orderDate = new Date(order.updatedAt).toDateString();
                return orderDate === today;
            });
            
            if (completedPicks) {
                if (todayCompleted.length === 0) {
                    completedPicks.innerHTML = '<div class="text-gray-500 text-center py-8">No completed orders today</div>';
                } else {
                    completedPicks.innerHTML = `
                        <div class="space-y-3">
                            ${todayCompleted.slice(0, 10).map(order => `
                                <div class="flex justify-between items-center p-3 bg-green-50 border border-green-200 rounded-lg">
                                    <div>
                                        <div class="font-medium text-green-800">${order.orderNumber}</div>
                                        <div class="text-sm text-green-700">Picked by ${order.pickerInitials}  ${order.totalItems} items</div>
                                    </div>
                                    <div class="text-right">
                                        <div class="text-sm font-bold text-green-800">${formatDate(order.updatedAt)}</div>
                                        <div class="text-xs text-green-600">${order.customer || 'No customer'}</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                }
            }
            
            // Update metrics
            const activePickers = pickers.filter(p => p.status === 'busy').length;
            const pendingOrders = pickOrders.filter(order => order.status === 'assigned').length;
            const totalItemsToday = todayCompleted.reduce((sum, order) => sum + (order.totalItems || 0), 0);
            const avgPickRate = pickers.length > 0 ? Math.round(totalItemsToday / Math.max(pickers.length, 1)) : 0;
            
            document.getElementById('active-pickers').textContent = activePickers.toString();
            document.getElementById('completed-orders').textContent = todayCompleted.length.toString();
            document.getElementById('pending-orders').textContent = pendingOrders.toString();
            document.getElementById('avg-pick-rate').textContent = avgPickRate.toString();
            
            // Update picker filters
            updatePickerFilters();
        }

        function getPriorityClass(priority) {
            const classes = {
                urgent: 'border-red-500',
                high: 'border-orange-500',
                medium: 'border-blue-500',
                low: 'border-gray-500'
            };
            return classes[priority] || 'border-blue-500';
        }

        function getPriorityColor(priority) {
            const colors = {
                urgent: 'text-red-600',
                high: 'text-orange-600',
                medium: 'text-blue-600',
                low: 'text-gray-600'
            };
            return colors[priority] || 'text-blue-600';
        }

        function updateShippingSection() {
            const readyToShip = document.getElementById('ready-to-ship');
            const recentShipments = document.getElementById('recent-shipments');
            
            if (readyToShip) {
                readyToShip.innerHTML = `
                    <div class="space-y-3">
                        <div class="p-4 bg-green-50 border border-green-200 rounded-lg">
                            <div class="font-bold text-green-800">Order #ORD-001</div>
                            <div class="text-sm text-green-700">Priority: High  5 items</div>
                            <button class="wms-button success text-xs px-3 py-1 mt-2">Ship Now</button>
                        </div>
                        <div class="p-4 bg-blue-50 border border-blue-200 rounded-lg">
                            <div class="font-bold text-blue-800">Order #ORD-002</div>
                            <div class="text-sm text-blue-700">Priority: Medium  3 items</div>
                            <button class="wms-button text-xs px-3 py-1 mt-2">Prepare</button>
                        </div>
                    </div>
                `;
            }
            
            if (recentShipments) {
                recentShipments.innerHTML = `
                    <div class="space-y-3">
                        <div class="p-3 bg-gray-50 border border-gray-200 rounded-lg">
                            <div class="font-medium text-gray-800">Shipped: ORD-098</div>
                            <div class="text-sm text-gray-600">Tracking: TRK123456  1 hour ago</div>
                        </div>
                        <div class="p-3 bg-gray-50 border border-gray-200 rounded-lg">
                            <div class="font-medium text-gray-800">Shipped: ORD-097</div>
                            <div class="text-sm text-gray-600">Tracking: TRK123455  3 hours ago</div>
                        </div>
                    </div>
                `;
            }
            
            document.getElementById('shipments-today').textContent = '18';
        }

        function updateCycleCountSection() {
            const pendingCounts = document.getElementById('pending-counts');
            const countHistory = document.getElementById('count-history');
            
            if (pendingCounts) {
                pendingCounts.innerHTML = `
                    <div class="space-y-3">
                        <div class="p-4 bg-amber-50 border border-amber-200 rounded-lg">
                            <div class="font-bold text-amber-800">Zone A - Aisle 001-005</div>
                            <div class="text-sm text-amber-700">Due: Today  45 locations</div>
                            <button class="wms-button warning text-xs px-3 py-1 mt-2">Start Count</button>
                        </div>
                        <div class="p-4 bg-blue-50 border border-blue-200 rounded-lg">
                            <div class="font-bold text-blue-800">Zone B - Aisle 006-010</div>
                            <div class="text-sm text-blue-700">Due: Tomorrow  38 locations</div>
                            <button class="wms-button text-xs px-3 py-1 mt-2">Schedule</button>
                        </div>
                    </div>
                `;
            }
            
            if (countHistory) {
                countHistory.innerHTML = `
                    <div class="space-y-3">
                        <div class="p-3 bg-green-50 border border-green-200 rounded-lg">
                            <div class="font-medium text-green-800">Zone C Completed</div>
                            <div class="text-sm text-green-700">99.2% accuracy  2 days ago</div>
                        </div>
                        <div class="p-3 bg-green-50 border border-green-200 rounded-lg">
                            <div class="font-medium text-green-800">Zone D Completed</div>
                            <div class="text-sm text-green-700">98.8% accuracy  5 days ago</div>
                        </div>
                    </div>
                `;
            }
        }

        // Enhanced section navigation with content updates and permission control
        function showSection(sectionName) {
            // Check permissions for bookers and pickers
            if (userRole === 'booker') {
                if (sectionName !== 'booker-workspace') {
                    showToast('Access denied. Bookers can only access their workspace.', 'warning');
                    return;
                }
            } else if (userRole === 'picker') {
                if (sectionName !== 'picker-workspace') {
                    showToast('Access denied. Pickers can only access their workspace.', 'warning');
                    return;
                }
            }
            
            // Hide all sections
            document.querySelectorAll('.section-content').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show selected section
            const targetSection = document.getElementById(`${sectionName}-section`);
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }
            
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            const activeNav = document.querySelector(`[data-section="${sectionName}"]`);
            if (activeNav) {
                activeNav.classList.add('active');
            }
            
            currentSection = sectionName;
            
            // Trigger section-specific updates
            switch(sectionName) {
                case 'locations':
                    if (userRole === 'manager') {
                        updateLocationMap();
                    }
                    break;
                case 'inventory':
                    if (userRole === 'manager') {
                        updateInventoryDisplay();
                    }
                    break;
                case 'dashboard':
                    if (userRole === 'manager') {
                        updateDashboardMetrics();
                        updateRecentActivity();
                        checkAlerts();
                    }
                    break;
                case 'receiving':
                    if (userRole === 'manager') {
                        updateReceivingSection();
                    }
                    break;
                case 'picking':
                    if (userRole === 'manager') {
                        updatePickingSection();
                    }
                    break;
                case 'shipping':
                    if (userRole === 'manager') {
                        updateShippingSection();
                    }
                    break;
                case 'cycle-count':
                    if (userRole === 'manager') {
                        updateCycleCountSection();
                    }
                    break;
                case 'booker-workspace':
                    if (userRole === 'booker') {
                        updateBookerWorkspace();
                    }
                    break;
                case 'picker-workspace':
                    if (userRole === 'picker') {
                        updatePickerWorkspace();
                    }
                    break;
                case 'reports':
                    // Reports section is already functional with buttons
                    break;
            }
        }

        function viewPickOrderDetails(orderId) {
            const order = allItems.find(item => item.__backendId === orderId && item.type === 'pick_order');
            if (!order) {
                showToast('Pick order not found', 'error');
                return;
            }

            const items = JSON.parse(order.items || '[]');
            const dueDate = order.dueDate ? new Date(order.dueDate) : null;
            
            const modal = document.createElement('div');
            modal.id = 'pick-details-modal';
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content max-w-4xl">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-bold text-gray-900">Pick Order Details</h3>
                        <button onclick="closeModal('pick-details-modal')" class="text-gray-400 hover:text-gray-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <div class="grid lg:grid-cols-2 gap-6 mb-6">
                        <div class="space-y-4">
                            <div>
                                <label class="text-sm font-medium text-gray-600">Order Number</label>
                                <div class="text-xl font-bold text-gray-900">${order.orderNumber}</div>
                            </div>
                            <div>
                                <label class="text-sm font-medium text-gray-600">Customer</label>
                                <div class="text-lg font-medium text-gray-900">${order.customer || 'No customer specified'}</div>
                            </div>
                            <div>
                                <label class="text-sm font-medium text-gray-600">Assigned Picker</label>
                                <div class="flex items-center space-x-2">
                                    <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold text-sm">
                                        ${order.pickerInitials}
                                    </div>
                                    <div class="text-lg font-medium text-gray-900">${order.pickerName}</div>
                                </div>
                            </div>
                        </div>
                        <div class="space-y-4">
                            <div>
                                <label class="text-sm font-medium text-gray-600">Priority</label>
                                <div class="text-lg font-bold ${getPriorityColor(order.priority)} uppercase">${order.priority}</div>
                            </div>
                            <div>
                                <label class="text-sm font-medium text-gray-600">Status</label>
                                <div class="text-lg font-bold ${order.status === 'assigned' ? 'text-blue-600' : order.status === 'in_progress' ? 'text-orange-600' : 'text-green-600'} capitalize">${order.status.replace('_', ' ')}</div>
                            </div>
                            <div>
                                <label class="text-sm font-medium text-gray-600">Due Date</label>
                                <div class="text-lg font-medium text-gray-900">${dueDate ? dueDate.toLocaleString() : 'No due date set'}</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid lg:grid-cols-3 gap-4 mb-6">
                        <div class="text-center p-4 bg-blue-50 rounded-lg">
                            <div class="text-2xl font-bold text-blue-600">${items.length}</div>
                            <div class="text-sm text-blue-700">Item Types</div>
                        </div>
                        <div class="text-center p-4 bg-green-50 rounded-lg">
                            <div class="text-2xl font-bold text-green-600">${order.totalItems}</div>
                            <div class="text-sm text-green-700">Total Units</div>
                        </div>
                        <div class="text-center p-4 bg-purple-50 rounded-lg">
                            <div class="text-2xl font-bold text-purple-600">${order.estimatedTime || 0}</div>
                            <div class="text-sm text-purple-700">Est. Minutes</div>
                        </div>
                    </div>
                    
                    ${order.instructions ? `
                        <div class="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                            <h4 class="font-bold text-blue-900 mb-2">Special Instructions</h4>
                            <p class="text-blue-800">${order.instructions}</p>
                        </div>
                    ` : ''}
                    
                    <div class="mb-6">
                        <h4 class="text-lg font-bold text-gray-900 mb-3">Pick Route (${order.routeOptimization || 'manual'} optimization)</h4>
                        <div class="space-y-3 max-h-80 overflow-y-auto">
                            ${items.map((item, index) => `
                                <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg border-l-4 border-blue-500">
                                    <div class="flex items-center space-x-4">
                                        <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold text-sm">
                                            ${index + 1}
                                        </div>
                                        <div>
                                            <div class="font-medium text-gray-900">${item.itemName}</div>
                                            <div class="text-sm text-gray-600">SKU: ${item.sku}</div>
                                            <div class="text-sm font-mono text-blue-600"> ${item.location || 'Unassigned'}</div>
                                        </div>
                                    </div>
                                    <div class="text-right">
                                        <div class="font-bold text-xl text-gray-900">${item.quantityToPick}</div>
                                        <div class="text-sm text-gray-600">to pick</div>
                                        <div class="text-xs ${item.status === 'completed' ? 'text-green-600' : 'text-gray-500'} font-medium uppercase">
                                            ${item.status || 'pending'}
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="flex justify-end space-x-4">
                        <button onclick="closeModal('pick-details-modal')" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                            Close
                        </button>
                        ${order.status === 'assigned' ? `
                            <button onclick="startPickOrder('${order.__backendId}'); closeModal('pick-details-modal')" class="wms-button success">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                Start Picking
                            </button>
                        ` : ''}
                        ${(order.status === 'assigned' || order.status === 'in_progress') ? `
                            <button onclick="completePickOrder('${order.__backendId}'); closeModal('pick-details-modal')" class="wms-button warning">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                Complete Order
                            </button>
                        ` : ''}
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        async function startPickOrder(orderId) {
            const order = allItems.find(item => item.__backendId === orderId && item.type === 'pick_order');
            if (!order) {
                showToast('Pick order not found', 'error');
                return;
            }

            const updatedOrder = {
                ...order,
                status: 'in_progress',
                startedAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };

            try {
                if (window.dataSdk) {
                    const result = await window.dataSdk.update(updatedOrder);
                    if (result.isOk) {
                        showToast(`Pick order ${order.orderNumber} started by ${order.pickerInitials}`, 'success');
                        updatePickingSection();
                    } else {
                        showToast('Failed to start pick order: ' + result.error.message, 'error');
                    }
                }
            } catch (error) {
                console.error('Error starting pick order:', error);
                showToast('Error starting pick order', 'error');
            }
        }

        async function completePickOrder(orderId) {
            const order = allItems.find(item => item.__backendId === orderId && item.type === 'pick_order');
            if (!order) {
                showToast('Pick order not found', 'error');
                return;
            }

            const confirmed = await showConfirmation(`Complete pick order "${order.orderNumber}"? This will update inventory levels and picker statistics.`);
            if (!confirmed) return;

            try {
                const pickItems = JSON.parse(order.items || '[]');
                
                // Update inventory for each picked item
                for (const pickItem of pickItems) {
                    const inventoryItem = allItems.find(item => 
                        item.__backendId === pickItem.itemId && item.type === 'inventory'
                    );
                    
                    if (inventoryItem) {
                        const newQuantity = Math.max(0, (inventoryItem.quantity || 0) - pickItem.quantityToPick);
                        const newAvailable = Math.max(0, (inventoryItem.available || inventoryItem.quantity || 0) - pickItem.quantityToPick);
                        
                        const updatedItem = {
                            ...inventoryItem,
                            quantity: newQuantity,
                            available: newAvailable,
                            lastMovement: new Date().toISOString(),
                            updatedAt: new Date().toISOString()
                        };

                        if (window.dataSdk) {
                            await window.dataSdk.update(updatedItem);
                        }
                    }
                }
                
                // Update picker statistics
                const picker = allItems.find(item => item.__backendId === order.assignedPickerId && item.type === 'picker');
                if (picker) {
                    const updatedPicker = {
                        ...picker,
                        status: 'active',
                        totalPicks: (picker.totalPicks || 0) + 1,
                        todayPicks: (picker.todayPicks || 0) + 1,
                        lastActive: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    };
                    
                    if (window.dataSdk) {
                        await window.dataSdk.update(updatedPicker);
                    }
                }
                
                // Update pick order status
                const updatedOrder = {
                    ...order,
                    status: 'completed',
                    itemsPicked: order.totalItems,
                    completedAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };

                if (window.dataSdk) {
                    const result = await window.dataSdk.update(updatedOrder);
                    if (result.isOk) {
                        showToast(`Pick order "${order.orderNumber}" completed by ${order.pickerInitials}`, 'success');
                        updatePickingSection();
                    } else {
                        showToast('Failed to complete pick order: ' + result.error.message, 'error');
                    }
                }
            } catch (error) {
                console.error('Error completing pick order:', error);
                showToast('Error completing pick order', 'error');
            }
        }

        // Professional Picker Management Functions
        
        function managePickers() {
            updatePickersList();
            document.getElementById('manage-pickers-modal').classList.remove('hidden');
        }

        async function addPicker(event) {
            event.preventDefault();
            
            if (recordCount >= 999) {
                showToast('Maximum limit of 999 records reached. Please delete some items first.', 'error');
                return;
            }

            const button = document.getElementById('add-picker-btn');
            const originalText = button.innerHTML;
            button.innerHTML = '<div class="loading-spinner"></div><span class="ml-2">Adding...</span>';
            button.disabled = true;

            try {
                const formData = new FormData(event.target);
                
                // Validate required fields
                const firstName = formData.get('firstName');
                const lastName = formData.get('lastName');
                const employeeId = formData.get('employeeId');
                const initials = formData.get('initials').toUpperCase();
                const password = formData.get('password');
                const shift = formData.get('shift');
                
                if (!firstName || !lastName || !employeeId || !initials || !password || !shift) {
                    showToast('Please fill in all required fields', 'error');
                    return;
                }
                
                if (password.length < 4) {
                    showToast('Password must be at least 4 characters long', 'error');
                    return;
                }
                
                // Check if initials are already taken
                const existingPicker = allItems.find(item => 
                    (item.type === 'picker' || item.type === 'booker') && item.initials === initials
                );
                
                if (existingPicker) {
                    showToast(`Initials "${initials}" are already taken by ${existingPicker.firstName} ${existingPicker.lastName}`, 'error');
                    return;
                }
                
                // Check if employee ID is already taken
                const existingEmployee = allItems.find(item => 
                    (item.type === 'picker' || item.type === 'booker') && item.employeeId === employeeId
                );
                
                if (existingEmployee) {
                    showToast(`Employee ID "${employeeId}" is already registered`, 'error');
                    return;
                }
                
                // Get selected specializations and certifications
                const specializations = Array.from(document.querySelectorAll('#add-picker-form input[name="specializations"]:checked')).map(cb => cb.value);
                const certifications = Array.from(document.querySelectorAll('#add-picker-form input[name="certifications"]:checked')).map(cb => cb.value);
                
                const pickerData = {
                    type: 'picker',
                    id: generateId(),
                    firstName: firstName,
                    lastName: lastName,
                    employeeId: employeeId,
                    initials: initials,
                    password: password, // Store password for workspace access
                    badgeNumber: formData.get('badgeNumber') || '',
                    phoneNumber: formData.get('phoneNumber') || '',
                    email: formData.get('email') || '',
                    shift: shift,
                    zone: formData.get('zone') || 'ALL',
                    experience: formData.get('experience') || 'junior',
                    specializations: JSON.stringify(specializations),
                    certifications: JSON.stringify(certifications),
                    notes: formData.get('notes') || '',
                    status: 'active',
                    totalPicks: 0,
                    todayPicks: 0,
                    accuracy: 100,
                    avgPickTime: 0,
                    lastActive: new Date().toISOString(),
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };

                if (window.dataSdk) {
                    const result = await window.dataSdk.create(pickerData);
                    if (result.isOk) {
                        showToast(`Picker ${pickerData.firstName} ${pickerData.lastName} (${pickerData.initials}) added successfully`, 'success');
                        document.getElementById('add-picker-form').reset();
                        updatePickersList();
                        updatePickerFilters();
                    } else {
                        showToast('Failed to add picker: ' + result.error.message, 'error');
                    }
                } else {
                    showToast('Data storage not available', 'error');
                }
            } catch (error) {
                console.error('Error adding picker:', error);
                showToast('Error adding picker', 'error');
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }

        function updatePickersList() {
            const pickersList = document.getElementById('pickers-list');
            if (!pickersList) return;

            const pickers = allItems.filter(item => item.type === 'picker');
            
            if (pickers.length === 0) {
                pickersList.innerHTML = '<div class="text-gray-500 text-center py-8">No pickers registered</div>';
                return;
            }

            pickersList.innerHTML = '';
            pickers.forEach(picker => {
                const statusColor = picker.status === 'active' ? 'text-green-600' : 
                                  picker.status === 'busy' ? 'text-blue-600' : 'text-gray-600';
                const statusBg = picker.status === 'active' ? 'bg-green-50' : 
                               picker.status === 'busy' ? 'bg-blue-50' : 'bg-gray-50';
                
                const pickerElement = document.createElement('div');
                pickerElement.className = `p-4 ${statusBg} border border-gray-200 rounded-lg`;
                pickerElement.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <div class="flex items-center space-x-3 mb-2">
                                <div class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold">
                                    ${picker.initials}
                                </div>
                                <div>
                                    <div class="font-bold text-gray-900">${picker.firstName} ${picker.lastName}</div>
                                    <div class="text-sm text-gray-600">ID: ${picker.employeeId} | Zone: ${picker.zone}</div>
                                </div>
                            </div>
                            <div class="grid grid-cols-2 gap-4 text-sm">
                                <div>
                                    <span class="text-gray-600">Shift:</span> 
                                    <span class="font-medium capitalize">${picker.shift}</span>
                                </div>
                                <div>
                                    <span class="text-gray-600">Experience:</span> 
                                    <span class="font-medium capitalize">${picker.experience}</span>
                                </div>
                                <div>
                                    <span class="text-gray-600">Today's Picks:</span> 
                                    <span class="font-bold text-blue-600">${picker.todayPicks || 0}</span>
                                </div>
                                <div>
                                    <span class="text-gray-600">Accuracy:</span> 
                                    <span class="font-bold text-green-600">${picker.accuracy || 100}%</span>
                                </div>
                            </div>
                        </div>
                        <div class="flex flex-col items-end space-y-2">
                            <span class="status-badge ${statusColor} ${statusBg} capitalize">${picker.status}</span>
                            <div class="flex space-x-2">
                                <button onclick="togglePickerStatus('${picker.__backendId}')" class="text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200">
                                    ${picker.status === 'active' ? 'Set Busy' : 'Set Active'}
                                </button>
                                <button onclick="removePicker('${picker.__backendId}')" class="text-xs px-2 py-1 bg-red-100 text-red-700 rounded hover:bg-red-200">
                                    Remove
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                pickersList.appendChild(pickerElement);
            });
        }

        async function togglePickerStatus(pickerId) {
            const picker = allItems.find(item => item.__backendId === pickerId && item.type === 'picker');
            if (!picker) return;

            const newStatus = picker.status === 'active' ? 'busy' : 'active';
            
            const updatedPicker = {
                ...picker,
                status: newStatus,
                lastActive: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };

            try {
                if (window.dataSdk) {
                    const result = await window.dataSdk.update(updatedPicker);
                    if (result.isOk) {
                        showToast(`${picker.firstName} ${picker.lastName} status updated to ${newStatus}`, 'success');
                        updatePickersList();
                        updatePickingSection();
                    } else {
                        showToast('Failed to update picker status: ' + result.error.message, 'error');
                    }
                }
            } catch (error) {
                console.error('Error updating picker status:', error);
                showToast('Error updating picker status', 'error');
            }
        }

        async function removePicker(pickerId) {
            const picker = allItems.find(item => item.__backendId === pickerId && item.type === 'picker');
            if (!picker) return;

            const confirmed = await showConfirmation(`Remove picker ${picker.firstName} ${picker.lastName} (${picker.initials})?`);
            if (!confirmed) return;

            try {
                if (window.dataSdk) {
                    const result = await window.dataSdk.delete(picker);
                    if (result.isOk) {
                        showToast(`Picker ${picker.firstName} ${picker.lastName} removed successfully`, 'success');
                        updatePickersList();
                        updatePickerFilters();
                    } else {
                        showToast('Failed to remove picker: ' + result.error.message, 'error');
                    }
                }
            } catch (error) {
                console.error('Error removing picker:', error);
                showToast('Error removing picker', 'error');
            }
        }

        function updatePickerFilters() {
            const pickerFilter = document.getElementById('picker-filter');
            if (!pickerFilter) return;

            const pickers = allItems.filter(item => item.type === 'picker');
            
            pickerFilter.innerHTML = '<option value="">All Pickers</option>';
            pickers.forEach(picker => {
                const option = document.createElement('option');
                option.value = picker.__backendId;
                option.textContent = `${picker.initials} - ${picker.firstName} ${picker.lastName}`;
                pickerFilter.appendChild(option);
            });
        }

        function filterPickOrders() {
            const pickerFilter = document.getElementById('picker-filter').value;
            const priorityFilter = document.getElementById('priority-filter').value;
            
            updatePickingSection(pickerFilter, priorityFilter);
        }

        function selectAllItems() {
            const checkboxes = document.querySelectorAll('input[name="pickItems"]');
            const quantityInputs = document.querySelectorAll('input[name^="pickQty_"]');
            
            checkboxes.forEach((checkbox, index) => {
                checkbox.checked = true;
                const itemId = checkbox.value;
                const qtyInput = document.querySelector(`input[name="pickQty_${itemId}"]`);
                if (qtyInput && !qtyInput.value) {
                    qtyInput.value = Math.min(5, parseInt(qtyInput.max) || 1);
                }
            });
        }

        function clearAllItems() {
            const checkboxes = document.querySelectorAll('input[name="pickItems"]');
            const quantityInputs = document.querySelectorAll('input[name^="pickQty_"]');
            
            checkboxes.forEach(checkbox => checkbox.checked = false);
            quantityInputs.forEach(input => input.value = '');
        }

        // Professional Receiving Management Functions
        
        async function processReceiving(recordId) {
            const record = allItems.find(item => item.__backendId === recordId && item.type === 'receiving_record');
            if (!record) {
                showToast('Receiving record not found', 'error');
                return;
            }

            openProcessReceivingModal(record);
        }

        function openProcessReceivingModal(record) {
            const modal = document.createElement('div');
            modal.id = 'process-receiving-modal';
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content max-w-5xl">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-bold text-gray-900">Process Receiving - ${record.poNumber || record.referenceNumber}</h3>
                        <button onclick="closeModal('process-receiving-modal')" class="text-gray-400 hover:text-gray-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <div class="grid lg:grid-cols-2 gap-6 mb-6">
                        <div class="space-y-4">
                            <div>
                                <label class="text-sm font-medium text-gray-600">PO Number</label>
                                <div class="text-xl font-bold text-gray-900">${record.poNumber || record.referenceNumber}</div>
                            </div>
                            <div>
                                <label class="text-sm font-medium text-gray-600">Supplier</label>
                                <div class="text-lg font-medium text-gray-900">${record.supplier || 'Unknown Supplier'}</div>
                            </div>
                            <div>
                                <label class="text-sm font-medium text-gray-600">Expected Date</label>
                                <div class="text-lg font-medium text-gray-900">${record.expectedDate ? formatDate(record.expectedDate) : 'Not specified'}</div>
                            </div>
                        </div>
                        <div class="space-y-4">
                            <div>
                                <label class="text-sm font-medium text-gray-600">Status</label>
                                <div class="text-lg font-bold text-blue-600 capitalize">${record.status}</div>
                            </div>
                            <div>
                                <label class="text-sm font-medium text-gray-600">Expected Items</label>
                                <div class="text-lg font-medium text-gray-900">${record.itemCount || 0} types</div>
                            </div>
                            <div>
                                <label class="text-sm font-medium text-gray-600">Expected Quantity</label>
                                <div class="text-lg font-medium text-gray-900">${record.totalQuantity || 0} units</div>
                            </div>
                        </div>
                    </div>
                    
                    <form id="process-receiving-form" onsubmit="completeReceiving(event, '${record.__backendId}')">
                        <div class="mb-6">
                            <h4 class="text-lg font-bold text-gray-900 mb-3">Receiving Details</h4>
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Actual Received Date *</label>
                                    <input type="datetime-local" name="receivedDate" required class="wms-input w-full" value="${new Date().toISOString().slice(0, 16)}">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Received By *</label>
                                    <input type="text" name="receivedBy" required class="wms-input w-full" placeholder="Staff name or ID" value="${currentUser ? `${currentUser.firstName} ${currentUser.lastName}` : ''}">
                                </div>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Receiving Notes</label>
                                <textarea name="receivingNotes" rows="3" class="wms-input w-full" placeholder="Any notes about condition, discrepancies, or special handling"></textarea>
                            </div>
                        </div>
                        
                        <div class="mb-6">
                            <h4 class="text-lg font-bold text-gray-900 mb-3">Items to Receive</h4>
                            <div class="space-y-3 max-h-80 overflow-y-auto border border-gray-200 rounded-lg p-4">
                                ${generateReceivingItemsList(record)}
                            </div>
                        </div>
                        
                        <div class="flex justify-end space-x-4">
                            <button type="button" onclick="closeModal('process-receiving-modal')" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                                Cancel
                            </button>
                            <button type="submit" class="wms-button success" id="complete-receiving-btn">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                Complete Receiving
                            </button>
                        </div>
                    </form>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function generateReceivingItemsList(record) {
            // Get items that could be received based on existing inventory
            const availableItems = allItems.filter(item => item.type === 'inventory');
            
            if (availableItems.length === 0) {
                return '<div class="text-gray-500 text-center py-4">No inventory items available for receiving</div>';
            }
            
            return availableItems.map(item => `
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                    <div class="flex items-center space-x-3">
                        <input type="checkbox" name="receiveItems" value="${item.__backendId}" class="w-4 h-4 text-blue-600 rounded">
                        <div>
                            <div class="font-medium text-sm">${item.name}</div>
                            <div class="text-xs text-gray-500">SKU: ${item.sku} | Current: ${item.quantity || 0} ${item.unitType || 'units'}</div>
                            <div class="text-xs text-gray-600">Location: ${item.location || 'Unassigned'}</div>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <label class="text-xs text-gray-600">Qty Received:</label>
                        <input type="number" name="receiveQty_${item.__backendId}" min="0" 
                               class="w-20 px-2 py-1 text-xs border border-gray-300 rounded" placeholder="0">
                    </div>
                </div>
            `).join('');
        }

        async function completeReceiving(event, recordId) {
            event.preventDefault();
            
            const button = document.getElementById('complete-receiving-btn');
            const originalText = button.innerHTML;
            button.innerHTML = '<div class="loading-spinner"></div><span class="ml-2">Processing...</span>';
            button.disabled = true;

            try {
                const formData = new FormData(event.target);
                const receivedDate = formData.get('receivedDate');
                const receivedBy = formData.get('receivedBy');
                const receivingNotes = formData.get('receivingNotes') || '';
                const selectedItems = formData.getAll('receiveItems');
                
                if (selectedItems.length === 0) {
                    showToast('Please select at least one item to receive', 'warning');
                    return;
                }
                
                let totalItemsReceived = 0;
                let totalQuantityReceived = 0;
                const receivedItems = [];
                
                // Process each selected item
                for (const itemId of selectedItems) {
                    const quantity = parseInt(formData.get(`receiveQty_${itemId}`)) || 0;
                    if (quantity > 0) {
                        const item = allItems.find(i => i.__backendId === itemId && i.type === 'inventory');
                        if (item) {
                            // Update inventory quantity
                            const updatedItem = {
                                ...item,
                                quantity: (item.quantity || 0) + quantity,
                                available: (item.available || item.quantity || 0) + quantity,
                                lastMovement: receivedDate,
                                updatedAt: new Date().toISOString()
                            };
                            
                            if (window.dataSdk) {
                                await window.dataSdk.update(updatedItem);
                            }
                            
                            receivedItems.push({
                                itemId: itemId,
                                itemName: item.name,
                                sku: item.sku,
                                quantityReceived: quantity,
                                unitType: item.unitType || 'units'
                            });
                            
                            totalItemsReceived++;
                            totalQuantityReceived += quantity;
                        }
                    }
                }
                
                if (totalItemsReceived === 0) {
                    showToast('Please enter valid quantities for selected items', 'warning');
                    return;
                }
                
                // Update or create receiving record
                const record = allItems.find(item => item.__backendId === recordId && item.type === 'receiving_record');
                
                if (record) {
                    // Update existing record
                    const updatedRecord = {
                        ...record,
                        status: 'completed',
                        receivedDate: receivedDate,
                        receivedBy: receivedBy,
                        receivingNotes: receivingNotes,
                        actualItemCount: totalItemsReceived,
                        actualQuantity: totalQuantityReceived,
                        receivedItems: JSON.stringify(receivedItems),
                        completedAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    };
                    
                    if (window.dataSdk) {
                        const result = await window.dataSdk.update(updatedRecord);
                        if (result.isOk) {
                            showToast(`Receiving completed: ${totalItemsReceived} items, ${totalQuantityReceived} units received`, 'success');
                            closeModal('process-receiving-modal');
                            updateReceivingSection();
                        } else {
                            showToast('Failed to complete receiving: ' + result.error.message, 'error');
                        }
                    }
                } else {
                    showToast('Receiving record not found', 'error');
                }
                
            } catch (error) {
                console.error('Error completing receiving:', error);
                showToast('Error completing receiving', 'error');
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }

        function viewReceivingDetails(recordId) {
            const record = allItems.find(item => item.__backendId === recordId && item.type === 'receiving_record');
            if (!record) {
                showToast('Receiving record not found', 'error');
                return;
            }

            const receivedItems = record.receivedItems ? JSON.parse(record.receivedItems) : [];
            const isCompleted = record.status === 'completed';
            
            const modal = document.createElement('div');
            modal.id = 'receiving-details-modal';
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content max-w-4xl">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-bold text-gray-900">Receiving Details</h3>
                        <button onclick="closeModal('receiving-details-modal')" class="text-gray-400 hover:text-gray-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <div class="grid lg:grid-cols-2 gap-6 mb-6">
                        <div class="space-y-4">
                            <div>
                                <label class="text-sm font-medium text-gray-600">PO Number</label>
                                <div class="text-xl font-bold text-gray-900">${record.poNumber || record.referenceNumber}</div>
                            </div>
                            <div>
                                <label class="text-sm font-medium text-gray-600">Supplier</label>
                                <div class="text-lg font-medium text-gray-900">${record.supplier || 'Unknown Supplier'}</div>
                            </div>
                            <div>
                                <label class="text-sm font-medium text-gray-600">Status</label>
                                <div class="text-lg font-bold ${isCompleted ? 'text-green-600' : 'text-blue-600'} capitalize">${record.status}</div>
                            </div>
                        </div>
                        <div class="space-y-4">
                            <div>
                                <label class="text-sm font-medium text-gray-600">Expected Date</label>
                                <div class="text-lg font-medium text-gray-900">${record.expectedDate ? formatDate(record.expectedDate) : 'Not specified'}</div>
                            </div>
                            ${isCompleted ? `
                                <div>
                                    <label class="text-sm font-medium text-gray-600">Received Date</label>
                                    <div class="text-lg font-medium text-gray-900">${formatDate(record.receivedDate)}</div>
                                </div>
                                <div>
                                    <label class="text-sm font-medium text-gray-600">Received By</label>
                                    <div class="text-lg font-medium text-gray-900">${record.receivedBy || 'Unknown'}</div>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                    
                    <div class="grid lg:grid-cols-${isCompleted ? '4' : '2'} gap-4 mb-6">
                        <div class="text-center p-4 bg-blue-50 rounded-lg">
                            <div class="text-2xl font-bold text-blue-600">${record.itemCount || 0}</div>
                            <div class="text-sm text-blue-700">Expected Items</div>
                        </div>
                        <div class="text-center p-4 bg-green-50 rounded-lg">
                            <div class="text-2xl font-bold text-green-600">${record.totalQuantity || 0}</div>
                            <div class="text-sm text-green-700">Expected Quantity</div>
                        </div>
                        ${isCompleted ? `
                            <div class="text-center p-4 bg-purple-50 rounded-lg">
                                <div class="text-2xl font-bold text-purple-600">${record.actualItemCount || 0}</div>
                                <div class="text-sm text-purple-700">Actual Items</div>
                            </div>
                            <div class="text-center p-4 bg-amber-50 rounded-lg">
                                <div class="text-2xl font-bold text-amber-600">${record.actualQuantity || 0}</div>
                                <div class="text-sm text-amber-700">Actual Quantity</div>
                            </div>
                        ` : ''}
                    </div>
                    
                    ${record.notes ? `
                        <div class="mb-6 p-4 bg-gray-50 border border-gray-200 rounded-lg">
                            <h4 class="font-bold text-gray-900 mb-2">Original Notes</h4>
                            <p class="text-gray-800">${record.notes}</p>
                        </div>
                    ` : ''}
                    
                    ${record.receivingNotes ? `
                        <div class="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                            <h4 class="font-bold text-blue-900 mb-2">Receiving Notes</h4>
                            <p class="text-blue-800">${record.receivingNotes}</p>
                        </div>
                    ` : ''}
                    
                    ${isCompleted && receivedItems.length > 0 ? `
                        <div class="mb-6">
                            <h4 class="text-lg font-bold text-gray-900 mb-3">Items Received</h4>
                            <div class="space-y-3 max-h-80 overflow-y-auto">
                                ${receivedItems.map(item => `
                                    <div class="flex items-center justify-between p-4 bg-green-50 rounded-lg border-l-4 border-green-500">
                                        <div>
                                            <div class="font-medium text-green-900">${item.itemName}</div>
                                            <div class="text-sm text-green-700">SKU: ${item.sku}</div>
                                        </div>
                                        <div class="text-right">
                                            <div class="font-bold text-xl text-green-900">${item.quantityReceived}</div>
                                            <div class="text-sm text-green-700">${item.unitType}</div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}
                    
                    <div class="flex justify-end space-x-4">
                        <button onclick="closeModal('receiving-details-modal')" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                            Close
                        </button>
                        ${!isCompleted ? `
                            <button onclick="processReceiving('${record.__backendId}'); closeModal('receiving-details-modal')" class="wms-button success">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                Process Receiving
                            </button>
                        ` : ''}
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        async function createReceivingRecord() {
            if (recordCount >= 999) {
                showToast('Maximum limit of 999 records reached. Please delete some items first.', 'error');
                return;
            }

            const modal = document.createElement('div');
            modal.id = 'create-receiving-modal';
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content max-w-3xl">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-bold text-gray-900">Create Receiving Record</h3>
                        <button onclick="closeModal('create-receiving-modal')" class="text-gray-400 hover:text-gray-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <form id="create-receiving-form" onsubmit="submitReceivingRecord(event)">
                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">PO Number *</label>
                                <input type="text" name="poNumber" required class="wms-input w-full" placeholder="PO-${Date.now().toString().slice(-6)}" value="PO-${Date.now().toString().slice(-6)}">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Supplier *</label>
                                <input type="text" name="supplier" required class="wms-input w-full" placeholder="Supplier name">
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-3 gap-4 mb-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Expected Date</label>
                                <input type="date" name="expectedDate" class="wms-input w-full">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Expected Items</label>
                                <input type="number" name="itemCount" min="0" class="wms-input w-full" placeholder="Number of item types">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Expected Quantity</label>
                                <input type="number" name="totalQuantity" min="0" class="wms-input w-full" placeholder="Total units expected">
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Notes</label>
                            <textarea name="notes" rows="3" class="wms-input w-full" placeholder="Any special instructions or notes about this shipment"></textarea>
                        </div>
                        
                        <div class="flex justify-end space-x-4">
                            <button type="button" onclick="closeModal('create-receiving-modal')" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                                Cancel
                            </button>
                            <button type="submit" class="wms-button" id="create-receiving-btn">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                </svg>
                                Create Receiving Record
                            </button>
                        </div>
                    </form>
                </div>
            `;
            document.body.appendChild(modal);
        }

        async function submitReceivingRecord(event) {
            event.preventDefault();
            
            const button = document.getElementById('create-receiving-btn');
            const originalText = button.innerHTML;
            button.innerHTML = '<div class="loading-spinner"></div><span class="ml-2">Creating...</span>';
            button.disabled = true;

            try {
                const formData = new FormData(event.target);
                
                const receivingData = {
                    type: 'receiving_record',
                    id: generateId(),
                    poNumber: formData.get('poNumber'),
                    referenceNumber: formData.get('poNumber'), // Alias for compatibility
                    supplier: formData.get('supplier'),
                    expectedDate: formData.get('expectedDate') || null,
                    itemCount: parseInt(formData.get('itemCount')) || 0,
                    totalQuantity: parseInt(formData.get('totalQuantity')) || 0,
                    notes: formData.get('notes') || '',
                    status: 'pending',
                    createdBy: currentUser ? `${currentUser.firstName} ${currentUser.lastName}` : 'System',
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };

                if (window.dataSdk) {
                    const result = await window.dataSdk.create(receivingData);
                    if (result.isOk) {
                        showToast(`Receiving record "${receivingData.poNumber}" created successfully`, 'success');
                        closeModal('create-receiving-modal');
                        updateReceivingSection();
                    } else {
                        showToast('Failed to create receiving record: ' + result.error.message, 'error');
                    }
                } else {
                    showToast('Data storage not available', 'error');
                }
            } catch (error) {
                console.error('Error creating receiving record:', error);
                showToast('Error creating receiving record', 'error');
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }

        // Placeholder functions for other operations

        function createShipment() {
            showToast('New shipment created successfully', 'success');
            updateShippingSection();
        }

        function startCycleCount() {
            showToast('Cycle count initiated for Zone A', 'success');
            updateCycleCountSection();
        }

        function generateReport() {
            showToast('Generating comprehensive inventory report...', 'success');
        }

        function exportInventory() {
            showToast('Exporting inventory data to CSV...', 'success');
        }

        function optimizeLocations() {
            showToast('Analyzing warehouse layout for optimization...', 'success');
        }

        function generateInventoryReport() {
            showToast('Inventory report generation would be implemented here', 'warning');
        }

        function generateABCReport() {
            showToast('ABC analysis report would be implemented here', 'warning');
        }

        function generateVelocityReport() {
            showToast('Velocity analysis report would be implemented here', 'warning');
        }

        function generateValuationReport() {
            showToast('Inventory valuation report would be implemented here', 'warning');
        }

        function generateReceivingReport() {
            showToast('Receiving report would be implemented here', 'warning');
        }

        function generatePickingReport() {
            showToast('Picking report would be implemented here', 'warning');
        }

        function generateShippingReport() {
            showToast('Shipping report would be implemented here', 'warning');
        }

        function generateCycleCountReport() {
            showToast('Cycle count report would be implemented here', 'warning');
        }

        function generateKPIReport() {
            showToast('KPI dashboard would be implemented here', 'warning');
        }

        function generateAccuracyReport() {
            showToast('Accuracy report would be implemented here', 'warning');
        }

        function generateProductivityReport() {
            showToast('Productivity report would be implemented here', 'warning');
        }

        function generateCostReport() {
            showToast('Cost analysis would be implemented here', 'warning');
        }

        function scheduleReport() {
            showToast('Report scheduling would be implemented here', 'warning');
        }





        // Inventory Tab Management
        let currentInventoryTab = 'items';

        function showInventoryTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.inventory-tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // Show selected tab content
            const targetTab = document.getElementById(`inventory-${tabName}-tab`);
            if (targetTab) {
                targetTab.classList.remove('hidden');
            }
            
            // Update tab buttons
            document.querySelectorAll('.inventory-tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            const activeBtn = document.querySelector(`[data-tab="${tabName}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            currentInventoryTab = tabName;
            
            // Update content based on tab
            if (tabName === 'bookers') {
                updateBookersDisplay();
                updateBookerStats();
            } else if (tabName === 'items') {
                updateInventoryDisplay();
            }
        }

        // Professional Bookers Management Functions
        
        function openAddBookerModal() {
            document.getElementById('add-booker-modal').classList.remove('hidden');
        }

        async function addBooker(event) {
            event.preventDefault();
            
            if (recordCount >= 999) {
                showToast('Maximum limit of 999 records reached. Please delete some items first.', 'error');
                return;
            }

            const button = document.getElementById('add-booker-btn');
            const originalText = button.innerHTML;
            button.innerHTML = '<div class="loading-spinner"></div><span class="ml-2">Adding...</span>';
            button.disabled = true;

            try {
                const formData = new FormData(event.target);
                
                // Validate required fields
                const firstName = formData.get('firstName');
                const lastName = formData.get('lastName');
                const employeeId = formData.get('employeeId');
                const initials = formData.get('initials').toUpperCase();
                const password = formData.get('password');
                const shift = formData.get('shift');
                
                if (!firstName || !lastName || !employeeId || !initials || !password || !shift) {
                    showToast('Please fill in all required fields', 'error');
                    return;
                }
                
                if (password.length < 4) {
                    showToast('Password must be at least 4 characters long', 'error');
                    return;
                }
                
                // Check if initials are already taken
                const existingBooker = allItems.find(item => 
                    item.type === 'booker' && item.initials === initials
                );
                
                if (existingBooker) {
                    showToast(`Initials "${initials}" are already taken by ${existingBooker.firstName} ${existingBooker.lastName}`, 'error');
                    return;
                }
                
                // Check if employee ID is already taken
                const existingEmployee = allItems.find(item => 
                    item.type === 'booker' && item.employeeId === employeeId
                );
                
                if (existingEmployee) {
                    showToast(`Employee ID "${employeeId}" is already registered`, 'error');
                    return;
                }
                
                // Get selected specializations and certifications
                const specializations = Array.from(document.querySelectorAll('#add-booker-modal input[name="specializations"]:checked')).map(cb => cb.value);
                const certifications = Array.from(document.querySelectorAll('#add-booker-modal input[name="certifications"]:checked')).map(cb => cb.value);
                
                const bookerData = {
                    type: 'booker',
                    id: generateId(),
                    firstName: firstName,
                    lastName: lastName,
                    employeeId: employeeId,
                    initials: initials,
                    password: password, // Store password for workspace access
                    badgeNumber: formData.get('badgeNumber') || '',
                    phoneNumber: formData.get('phoneNumber') || '',
                    email: formData.get('email') || '',
                    shift: shift,
                    zone: formData.get('zone') || 'ALL',
                    experience: formData.get('experience') || 'junior',
                    specializations: JSON.stringify(specializations),
                    certifications: JSON.stringify(certifications),
                    notes: formData.get('notes') || '',
                    status: 'active',
                    totalBookings: 0,
                    todayBookings: 0,
                    accuracy: 100,
                    avgBookingTime: 0,
                    lastActive: new Date().toISOString(),
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };

                if (window.dataSdk) {
                    const result = await window.dataSdk.create(bookerData);
                    if (result.isOk) {
                        showToast(`Booker ${bookerData.firstName} ${bookerData.lastName} (${bookerData.initials}) added successfully`, 'success');
                        closeModal('add-booker-modal');
                        updateBookersDisplay();
                        updateBookerStats();
                    } else {
                        showToast('Failed to add booker: ' + result.error.message, 'error');
                    }
                } else {
                    showToast('Data storage not available', 'error');
                }
            } catch (error) {
                console.error('Error adding booker:', error);
                showToast('Error adding booker', 'error');
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }

        function updateBookersDisplay() {
            const tableBody = document.getElementById('bookers-table-body');
            if (!tableBody) return;

            const bookers = allItems.filter(item => item.type === 'booker');
            
            if (bookers.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="7" class="px-6 py-12 text-center text-gray-500">
                            <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                            </svg>
                            <p class="text-lg font-medium">No bookers found</p>
                            <p class="text-sm">Add your first booker to get started</p>
                        </td>
                    </tr>
                `;
                return;
            }

            tableBody.innerHTML = '';
            
            bookers.forEach(booker => {
                const statusColor = getBookerStatusColor(booker.status);
                const statusBg = getBookerStatusBg(booker.status);
                const specializations = JSON.parse(booker.specializations || '[]');
                const certifications = JSON.parse(booker.certifications || '[]');
                
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold">
                                ${booker.initials}
                            </div>
                            <div>
                                <div class="text-sm font-medium text-gray-900">${booker.firstName} ${booker.lastName}</div>
                                <div class="text-sm text-gray-500">ID: ${booker.employeeId}</div>
                                <div class="text-xs text-gray-400">${booker.badgeNumber ? `Badge: ${booker.badgeNumber}` : 'No badge'}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">${booker.phoneNumber || 'No phone'}</div>
                        <div class="text-sm text-gray-500">${booker.email || 'No email'}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900 capitalize">${booker.shift}</div>
                        <div class="text-sm text-gray-500">Zone: ${booker.zone}</div>
                        <div class="text-xs text-gray-400 capitalize">${booker.experience} level</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900">${booker.accuracy || 100}% Accuracy</div>
                        <div class="text-sm text-gray-500">Total: ${booker.totalBookings || 0} bookings</div>
                        <div class="text-xs text-gray-400">${specializations.length} specializations</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900">${booker.todayBookings || 0} bookings</div>
                        <div class="text-sm text-gray-500">Last: ${formatDate(booker.lastActive)}</div>
                        <div class="text-xs text-gray-400">${certifications.length} certifications</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="status-badge ${statusColor} ${statusBg} capitalize">${booker.status}</span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="viewBookerDetails('${booker.__backendId}')" class="text-indigo-600 hover:text-indigo-900 mr-3">View</button>
                        <button onclick="editBooker('${booker.__backendId}')" class="text-blue-600 hover:text-blue-900 mr-3">Edit</button>
                        <button onclick="removeBooker('${booker.__backendId}')" class="text-red-600 hover:text-red-900">Remove</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        function updateBookerStats() {
            const bookers = allItems.filter(item => item.type === 'booker');
            const totalBookers = bookers.length;
            const activeBookers = bookers.filter(b => b.status === 'active' || b.status === 'busy').length;
            const todayBookings = bookers.reduce((sum, b) => sum + (b.todayBookings || 0), 0);
            const avgRate = activeBookers > 0 ? Math.round(todayBookings / activeBookers) : 0;

            document.getElementById('total-bookers').textContent = totalBookers.toString();
            document.getElementById('active-bookers').textContent = activeBookers.toString();
            document.getElementById('bookings-today').textContent = todayBookings.toString();
            document.getElementById('avg-booking-rate').textContent = avgRate.toString();
        }

        function getBookerStatusColor(status) {
            const colors = {
                active: 'text-green-600',
                busy: 'text-blue-600',
                break: 'text-yellow-600',
                offline: 'text-gray-600'
            };
            return colors[status] || 'text-gray-600';
        }

        function getBookerStatusBg(status) {
            const backgrounds = {
                active: 'bg-green-50',
                busy: 'bg-blue-50',
                break: 'bg-yellow-50',
                offline: 'bg-gray-50'
            };
            return backgrounds[status] || 'bg-gray-50';
        }

        async function toggleBookerStatus(bookerId) {
            const booker = allItems.find(item => item.__backendId === bookerId && item.type === 'booker');
            if (!booker) return;

            const newStatus = booker.status === 'active' ? 'busy' : 'active';
            
            const updatedBooker = {
                ...booker,
                status: newStatus,
                lastActive: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };

            try {
                if (window.dataSdk) {
                    const result = await window.dataSdk.update(updatedBooker);
                    if (result.isOk) {
                        showToast(`${booker.firstName} ${booker.lastName} status updated to ${newStatus}`, 'success');
                        updateBookersDisplay();
                        updateBookerStats();
                    } else {
                        showToast('Failed to update booker status: ' + result.error.message, 'error');
                    }
                }
            } catch (error) {
                console.error('Error updating booker status:', error);
                showToast('Error updating booker status', 'error');
            }
        }

        async function removeBooker(bookerId) {
            const booker = allItems.find(item => item.__backendId === bookerId && item.type === 'booker');
            if (!booker) return;

            const confirmed = await showConfirmation(`Remove booker ${booker.firstName} ${booker.lastName} (${booker.initials})?`);
            if (!confirmed) return;

            try {
                if (window.dataSdk) {
                    const result = await window.dataSdk.delete(booker);
                    if (result.isOk) {
                        showToast(`Booker ${booker.firstName} ${booker.lastName} removed successfully`, 'success');
                        updateBookersDisplay();
                        updateBookerStats();
                    } else {
                        showToast('Failed to remove booker: ' + result.error.message, 'error');
                    }
                }
            } catch (error) {
                console.error('Error removing booker:', error);
                showToast('Error removing booker', 'error');
            }
        }

        function viewBookerDetails(bookerId) {
            const booker = allItems.find(item => item.__backendId === bookerId && item.type === 'booker');
            if (!booker) {
                showToast('Booker not found', 'error');
                return;
            }

            const specializations = JSON.parse(booker.specializations || '[]');
            const certifications = JSON.parse(booker.certifications || '[]');
            
            const modal = document.createElement('div');
            modal.id = 'booker-details-modal';
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content max-w-4xl">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-bold text-gray-900">Booker Details</h3>
                        <button onclick="closeModal('booker-details-modal')" class="text-gray-400 hover:text-gray-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <div class="grid lg:grid-cols-2 gap-6 mb-6">
                        <div class="space-y-4">
                            <div class="flex items-center space-x-4">
                                <div class="w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold text-xl">
                                    ${booker.initials}
                                </div>
                                <div>
                                    <div class="text-2xl font-bold text-gray-900">${booker.firstName} ${booker.lastName}</div>
                                    <div class="text-lg text-gray-600">Employee ID: ${booker.employeeId}</div>
                                    ${booker.badgeNumber ? `<div class="text-sm text-gray-500">Badge: ${booker.badgeNumber}</div>` : ''}
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="text-sm font-medium text-gray-600">Phone</label>
                                    <div class="text-lg font-medium text-gray-900">${booker.phoneNumber || 'Not provided'}</div>
                                </div>
                                <div>
                                    <label class="text-sm font-medium text-gray-600">Email</label>
                                    <div class="text-lg font-medium text-gray-900">${booker.email || 'Not provided'}</div>
                                </div>
                                <div>
                                    <label class="text-sm font-medium text-gray-600">Shift</label>
                                    <div class="text-lg font-medium text-gray-900 capitalize">${booker.shift}</div>
                                </div>
                                <div>
                                    <label class="text-sm font-medium text-gray-600">Zone</label>
                                    <div class="text-lg font-medium text-gray-900">${booker.zone}</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="text-sm font-medium text-gray-600">Status</label>
                                <div class="text-lg font-bold ${getBookerStatusColor(booker.status)} capitalize">${booker.status}</div>
                            </div>
                            <div>
                                <label class="text-sm font-medium text-gray-600">Experience Level</label>
                                <div class="text-lg font-medium text-gray-900 capitalize">${booker.experience}</div>
                            </div>
                            <div>
                                <label class="text-sm font-medium text-gray-600">Last Active</label>
                                <div class="text-lg font-medium text-gray-900">${formatDate(booker.lastActive)}</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid lg:grid-cols-4 gap-4 mb-6">
                        <div class="text-center p-4 bg-blue-50 rounded-lg">
                            <div class="text-2xl font-bold text-blue-600">${booker.totalBookings || 0}</div>
                            <div class="text-sm text-blue-700">Total Bookings</div>
                        </div>
                        <div class="text-center p-4 bg-green-50 rounded-lg">
                            <div class="text-2xl font-bold text-green-600">${booker.todayBookings || 0}</div>
                            <div class="text-sm text-green-700">Today's Bookings</div>
                        </div>
                        <div class="text-center p-4 bg-purple-50 rounded-lg">
                            <div class="text-2xl font-bold text-purple-600">${booker.accuracy || 100}%</div>
                            <div class="text-sm text-purple-700">Accuracy Rate</div>
                        </div>
                        <div class="text-center p-4 bg-amber-50 rounded-lg">
                            <div class="text-2xl font-bold text-amber-600">${booker.avgBookingTime || 0}</div>
                            <div class="text-sm text-amber-700">Avg Time (min)</div>
                        </div>
                    </div>
                    
                    <div class="grid lg:grid-cols-2 gap-6 mb-6">
                        <div>
                            <h4 class="text-lg font-bold text-gray-900 mb-3">Specializations</h4>
                            ${specializations.length > 0 ? `
                                <div class="space-y-2">
                                    ${specializations.map(spec => `
                                        <div class="flex items-center space-x-2">
                                            <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                                            <span class="text-sm capitalize">${spec.replace('_', ' ')}</span>
                                        </div>
                                    `).join('')}
                                </div>
                            ` : '<div class="text-gray-500">No specializations listed</div>'}
                        </div>
                        
                        <div>
                            <h4 class="text-lg font-bold text-gray-900 mb-3">Equipment Certifications</h4>
                            ${certifications.length > 0 ? `
                                <div class="space-y-2">
                                    ${certifications.map(cert => `
                                        <div class="flex items-center space-x-2">
                                            <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                                            <span class="text-sm capitalize">${cert.replace('_', ' ')}</span>
                                        </div>
                                    `).join('')}
                                </div>
                            ` : '<div class="text-gray-500">No certifications listed</div>'}
                        </div>
                    </div>
                    
                    ${booker.notes ? `
                        <div class="mb-6 p-4 bg-gray-50 border border-gray-200 rounded-lg">
                            <h4 class="font-bold text-gray-900 mb-2">Notes</h4>
                            <p class="text-gray-800">${booker.notes}</p>
                        </div>
                    ` : ''}
                    
                    <div class="flex justify-end space-x-4">
                        <button onclick="closeModal('booker-details-modal')" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">
                            Close
                        </button>
                        <button onclick="toggleBookerStatus('${booker.__backendId}'); closeModal('booker-details-modal')" class="wms-button">
                            ${booker.status === 'active' ? 'Set Busy' : 'Set Active'}
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function filterBookers() {
            const searchTerm = document.getElementById('search-bookers').value.toLowerCase();
            const statusFilter = document.getElementById('filter-booker-status').value;
            const shiftFilter = document.getElementById('filter-booker-shift').value;

            const bookers = allItems.filter(item => item.type === 'booker');
            const filteredBookers = bookers.filter(booker => {
                const matchesSearch = !searchTerm || 
                    (booker.firstName && booker.firstName.toLowerCase().includes(searchTerm)) ||
                    (booker.lastName && booker.lastName.toLowerCase().includes(searchTerm)) ||
                    (booker.employeeId && booker.employeeId.toLowerCase().includes(searchTerm)) ||
                    (booker.initials && booker.initials.toLowerCase().includes(searchTerm));
                
                const matchesStatus = !statusFilter || booker.status === statusFilter;
                const matchesShift = !shiftFilter || booker.shift === shiftFilter;

                return matchesSearch && matchesStatus && matchesShift;
            });

            // Update display with filtered bookers
            const originalItems = allItems;
            allItems = allItems.filter(item => item.type !== 'booker').concat(filteredBookers);
            updateBookersDisplay();
            allItems = originalItems;
        }

        function clearBookerFilters() {
            document.getElementById('search-bookers').value = '';
            document.getElementById('filter-booker-status').value = '';
            document.getElementById('filter-booker-shift').value = '';
            updateBookersDisplay();
        }

        // Edit Booker Functions
        function editBooker(bookerId) {
            const booker = allItems.find(item => item.__backendId === bookerId && item.type === 'booker');
            if (!booker) {
                showToast('Booker not found', 'error');
                return;
            }

            // Populate the edit form with current booker data
            document.getElementById('edit-booker-id').value = booker.__backendId;
            document.getElementById('edit-firstName').value = booker.firstName || '';
            document.getElementById('edit-lastName').value = booker.lastName || '';
            document.getElementById('edit-employeeId').value = booker.employeeId || '';
            document.getElementById('edit-initials').value = booker.initials || '';
            document.getElementById('edit-password').value = ''; // Always empty for security
            document.getElementById('edit-badgeNumber').value = booker.badgeNumber || '';
            document.getElementById('edit-phoneNumber').value = booker.phoneNumber || '';
            document.getElementById('edit-email').value = booker.email || '';
            document.getElementById('edit-shift').value = booker.shift || '';
            document.getElementById('edit-zone').value = booker.zone || 'ALL';
            document.getElementById('edit-experience').value = booker.experience || 'junior';
            document.getElementById('edit-status').value = booker.status || 'active';
            document.getElementById('edit-notes').value = booker.notes || '';

            // Set specializations checkboxes
            const specializations = JSON.parse(booker.specializations || '[]');
            document.querySelectorAll('#edit-specializations input[type="checkbox"]').forEach(checkbox => {
                checkbox.checked = specializations.includes(checkbox.value);
            });

            // Set certifications checkboxes
            const certifications = JSON.parse(booker.certifications || '[]');
            document.querySelectorAll('#edit-certifications input[type="checkbox"]').forEach(checkbox => {
                checkbox.checked = certifications.includes(checkbox.value);
            });

            // Show the edit modal
            document.getElementById('edit-booker-modal').classList.remove('hidden');
        }

        async function updateBooker(event) {
            event.preventDefault();

            const button = document.getElementById('edit-booker-btn');
            const originalText = button.innerHTML;
            button.innerHTML = '<div class="loading-spinner"></div><span class="ml-2">Updating...</span>';
            button.disabled = true;

            try {
                const formData = new FormData(event.target);
                const bookerId = formData.get('bookerId');
                
                const booker = allItems.find(item => item.__backendId === bookerId && item.type === 'booker');
                if (!booker) {
                    showToast('Booker not found', 'error');
                    return;
                }

                // Check if initials are already taken by another booker
                const initials = formData.get('initials').toUpperCase();
                const existingBooker = allItems.find(item => 
                    item.type === 'booker' && 
                    item.initials === initials && 
                    item.__backendId !== bookerId
                );
                
                if (existingBooker) {
                    showToast(`Initials "${initials}" are already taken by ${existingBooker.firstName} ${existingBooker.lastName}`, 'error');
                    return;
                }
                
                // Check if employee ID is already taken by another booker
                const employeeId = formData.get('employeeId');
                const existingEmployee = allItems.find(item => 
                    item.type === 'booker' && 
                    item.employeeId === employeeId && 
                    item.__backendId !== bookerId
                );
                
                if (existingEmployee) {
                    showToast(`Employee ID "${employeeId}" is already registered to another booker`, 'error');
                    return;
                }
                
                // Get selected specializations and certifications
                const specializations = Array.from(document.querySelectorAll('#edit-specializations input[name="specializations"]:checked')).map(cb => cb.value);
                const certifications = Array.from(document.querySelectorAll('#edit-certifications input[name="certifications"]:checked')).map(cb => cb.value);
                
                // Prepare updated booker data
                const updatedBookerData = {
                    ...booker,
                    firstName: formData.get('firstName'),
                    lastName: formData.get('lastName'),
                    employeeId: employeeId,
                    initials: initials,
                    badgeNumber: formData.get('badgeNumber') || '',
                    phoneNumber: formData.get('phoneNumber') || '',
                    email: formData.get('email') || '',
                    shift: formData.get('shift'),
                    zone: formData.get('zone') || 'ALL',
                    experience: formData.get('experience') || 'junior',
                    status: formData.get('status') || 'active',
                    specializations: JSON.stringify(specializations),
                    certifications: JSON.stringify(certifications),
                    notes: formData.get('notes') || '',
                    updatedAt: new Date().toISOString()
                };

                // Update password only if provided
                const newPassword = formData.get('password');
                if (newPassword && newPassword.trim() !== '') {
                    if (newPassword.length < 4) {
                        showToast('Password must be at least 4 characters long', 'error');
                        return;
                    }
                    updatedBookerData.password = newPassword;
                }

                if (window.dataSdk) {
                    const result = await window.dataSdk.update(updatedBookerData);
                    if (result.isOk) {
                        // Update current user if editing the logged-in booker
                        if (currentUser && currentUser.__backendId === bookerId) {
                            currentUser = updatedBookerData;
                            updateUIForRole(); // Refresh UI with updated info
                        }
                        
                        showToast(`Booker ${updatedBookerData.firstName} ${updatedBookerData.lastName} updated successfully`, 'success');
                        closeModal('edit-booker-modal');
                        updateBookersDisplay();
                        updateBookerStats();
                    } else {
                        showToast('Failed to update booker: ' + result.error.message, 'error');
                    }
                } else {
                    showToast('Data storage not available', 'error');
                }
            } catch (error) {
                console.error('Error updating booker:', error);
                showToast('Error updating booker', 'error');
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }



        // Workspace Tabs
        let currentWorkspaceTab = 'inventory';

        function showWorkspaceTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.workspace-tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // Show selected tab content
            const targetTab = document.getElementById(`workspace-${tabName}-tab`);
            if (targetTab) {
                targetTab.classList.remove('hidden');
            }
            
            // Update tab buttons
            document.querySelectorAll('.workspace-tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            const activeBtn = document.querySelector(`.workspace-tab-btn[data-tab="${tabName}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            currentWorkspaceTab = tabName;
            
            // Generate auto SKU when switching to inventory tab
            if (tabName === 'inventory') {
                generateBookerAutoSKU();
            }
        }

        // Change password function for bookers
        async function changeMyPassword(event) {
            event.preventDefault();
            
            if (!currentUser) {
                showToast('User session expired. Please log in again.', 'error');
                return;
            }

            const button = document.getElementById('change-password-btn');
            const originalText = button.innerHTML;
            button.innerHTML = '<div class="loading-spinner"></div><span class="ml-2">Updating...</span>';
            button.disabled = true;

            try {
                const formData = new FormData(event.target);
                const currentPassword = formData.get('currentPassword');
                const newPassword = formData.get('newPassword');
                const confirmPassword = formData.get('confirmPassword');
                
                // Validate current password
                if (currentUser.password !== currentPassword) {
                    showToast('Current password is incorrect', 'error');
                    return;
                }
                
                // Validate new password
                if (newPassword.length < 4) {
                    showToast('New password must be at least 4 characters long', 'error');
                    return;
                }
                
                // Validate password confirmation
                if (newPassword !== confirmPassword) {
                    showToast('New passwords do not match', 'error');
                    return;
                }
                
                // Update booker's password
                const updatedBooker = {
                    ...currentUser,
                    password: newPassword,
                    lastActive: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };

                if (window.dataSdk) {
                    const result = await window.dataSdk.update(updatedBooker);
                    if (result.isOk) {
                        currentUser = updatedBooker;
                        showToast('Password updated successfully', 'success');
                        document.getElementById('change-password-form').reset();
                    } else {
                        showToast('Failed to update password: ' + result.error.message, 'error');
                    }
                } else {
                    showToast('Data storage not available', 'error');
                }
            } catch (error) {
                console.error('Error updating password:', error);
                showToast('Error updating password', 'error');
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }

        // Picker Workspace Functions
        
        async function toggleMyPickerStatus() {
            if (!currentUser) return;
            
            const newStatus = currentUser.status === 'active' ? 'busy' : 'active';
            
            const updatedPicker = {
                ...currentUser,
                status: newStatus,
                lastActive: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };

            try {
                if (window.dataSdk) {
                    const result = await window.dataSdk.update(updatedPicker);
                    if (result.isOk) {
                        currentUser = updatedPicker;
                        updatePickerWorkspace();
                        updateUIForRole();
                        showToast(`Status updated to ${newStatus}`, 'success');
                    } else {
                        showToast('Failed to update status: ' + result.error.message, 'error');
                    }
                }
            } catch (error) {
                console.error('Error updating status:', error);
                showToast('Error updating status', 'error');
            }
        }

        function updatePickerWorkspace() {
            if (!currentUser) return;
            
            // Update welcome message and stats
            document.getElementById('picker-welcome').textContent = `Welcome back, ${currentUser.firstName} ${currentUser.lastName}!`;
            document.getElementById('picker-current-status').textContent = currentUser.status.charAt(0).toUpperCase() + currentUser.status.slice(1);
            document.getElementById('picker-current-status').className = `font-bold text-lg ${getBookerStatusColor(currentUser.status)}`;
            
            const statusBtn = document.getElementById('picker-status-toggle-btn');
            statusBtn.textContent = currentUser.status === 'active' ? 'Set Busy' : 'Set Active';
            
            // Update stats
            document.getElementById('my-total-picks').textContent = (currentUser.totalPicks || 0).toString();
            document.getElementById('my-today-picks').textContent = (currentUser.todayPicks || 0).toString();
            document.getElementById('my-pick-accuracy').textContent = `${currentUser.accuracy || 100}%`;
            document.getElementById('my-picker-zone').textContent = currentUser.zone || 'ALL';
            
            // Update assigned pick orders
            updateMyPickOrders();
            updateMyPickerZoneStatus();
            updateMyPickerPerformance();
            updateMyPickerRecentActivity();
        }

        function updateMyPickOrders() {
            const container = document.getElementById('my-pick-orders');
            if (!container || !currentUser) return;
            
            // Filter pick orders assigned to this picker
            const myOrders = allItems.filter(item => 
                item.type === 'pick_order' && 
                item.assignedPickerId === currentUser.__backendId &&
                (item.status === 'assigned' || item.status === 'in_progress')
            );
            
            if (myOrders.length === 0) {
                container.innerHTML = '<div class="text-gray-500 text-center py-8">No pick orders assigned</div>';
                return;
            }
            
            container.innerHTML = '';
            myOrders.forEach(order => {
                const items = JSON.parse(order.items || '[]');
                const priorityColor = getPriorityColor(order.priority);
                const dueDate = order.dueDate ? new Date(order.dueDate) : null;
                const isOverdue = dueDate && dueDate < new Date();
                
                const orderElement = document.createElement('div');
                orderElement.className = `p-4 bg-white border-l-4 ${getPriorityClass(order.priority)} rounded-lg shadow-sm`;
                orderElement.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <div class="font-bold text-gray-900">${order.orderNumber}</div>
                            <div class="text-sm text-gray-600">${order.customer || 'No customer specified'}</div>
                            <div class="text-sm ${priorityColor} font-bold uppercase">${order.priority} Priority</div>
                        </div>
                        <div class="text-right">
                            <div class="text-sm font-bold text-gray-900">${items.length} types</div>
                            <div class="text-xs text-gray-500">${order.totalItems} units</div>
                        </div>
                    </div>
                    ${dueDate ? `
                        <div class="text-xs ${isOverdue ? 'text-red-600 font-bold' : 'text-gray-600'} mb-2">
                            Due: ${dueDate.toLocaleString()} ${isOverdue ? '(OVERDUE)' : ''}
                        </div>
                    ` : ''}
                    ${order.instructions ? `
                        <div class="text-xs text-blue-700 bg-blue-50 p-2 rounded mb-3">
                            <strong>Instructions:</strong> ${order.instructions}
                        </div>
                    ` : ''}
                    <div class="flex space-x-2">
                        ${order.status === 'assigned' ? `
                            <button onclick="startMyPickOrder('${order.__backendId}')" class="wms-button success text-xs px-3 py-1">
                                Start Picking
                            </button>
                        ` : ''}
                        ${order.status === 'in_progress' ? `
                            <button onclick="completeMyPickOrder('${order.__backendId}')" class="wms-button warning text-xs px-3 py-1">
                                Complete Order
                            </button>
                        ` : ''}
                        <button onclick="viewMyPickOrderDetails('${order.__backendId}')" class="wms-button text-xs px-3 py-1">
                            View Details
                        </button>
                    </div>
                `;
                container.appendChild(orderElement);
            });
        }

        function updateMyPickerZoneStatus() {
            const container = document.getElementById('my-picker-zone-status');
            if (!container || !currentUser) return;
            
            // Get zone ranges
            const zoneRanges = {
                'A': [1, 10],
                'B': [11, 20],
                'C': [21, 30],
                'D': [31, 40],
                'E': [41, 50],
                'ALL': [1, 50]
            };
            
            const range = zoneRanges[currentUser.zone] || [1, 50];
            const aisles = [];
            
            for (let aisle = range[0]; aisle <= range[1]; aisle++) {
                const aisleNum = aisle.toString().padStart(3, '0');
                const itemsInAisle = allItems.filter(item => 
                    item.type === 'inventory' && item.location && item.location.startsWith(aisleNum)
                ).length;
                
                aisles.push({
                    number: aisleNum,
                    itemCount: itemsInAisle,
                    utilization: Math.min(100, Math.round((itemsInAisle / 1500) * 100))
                });
            }
            
            container.innerHTML = '';
            aisles.slice(0, 8).forEach(aisle => {
                const statusColor = aisle.utilization > 80 ? 'text-red-600' : 
                                  aisle.utilization > 50 ? 'text-amber-600' : 'text-green-600';
                const statusBg = aisle.utilization > 80 ? 'bg-red-50' : 
                               aisle.utilization > 50 ? 'bg-amber-50' : 'bg-green-50';
                
                const aisleElement = document.createElement('div');
                aisleElement.className = `p-3 ${statusBg} border border-gray-200 rounded-lg`;
                aisleElement.innerHTML = `
                    <div class="flex justify-between items-center">
                        <div>
                            <div class="font-bold text-gray-900">Aisle ${aisle.number}</div>
                            <div class="text-sm text-gray-600">${aisle.itemCount} items</div>
                        </div>
                        <div class="text-right">
                            <div class="font-bold ${statusColor}">${aisle.utilization}%</div>
                            <div class="text-xs text-gray-500">Full</div>
                        </div>
                    </div>
                `;
                container.appendChild(aisleElement);
            });
        }

        function updateMyPickerPerformance() {
            const container = document.getElementById('my-picker-performance');
            if (!container || !currentUser) return;
            
            // Calculate performance metrics
            const totalPicks = currentUser.totalPicks || 0;
            const todayPicks = currentUser.todayPicks || 0;
            const accuracy = currentUser.accuracy || 100;
            const avgTime = currentUser.avgPickTime || 0;
            
            container.innerHTML = `
                <div class="space-y-4">
                    <div class="flex justify-between items-center p-3 bg-blue-50 rounded-lg">
                        <div>
                            <div class="font-medium text-blue-900">Total Career Picks</div>
                            <div class="text-sm text-blue-700">All-time performance</div>
                        </div>
                        <div class="text-2xl font-bold text-blue-600">${totalPicks}</div>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-green-50 rounded-lg">
                        <div>
                            <div class="font-medium text-green-900">Today's Performance</div>
                            <div class="text-sm text-green-700">Orders completed today</div>
                        </div>
                        <div class="text-2xl font-bold text-green-600">${todayPicks}</div>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-purple-50 rounded-lg">
                        <div>
                            <div class="font-medium text-purple-900">Accuracy Rate</div>
                            <div class="text-sm text-purple-700">Pick accuracy</div>
                        </div>
                        <div class="text-2xl font-bold text-purple-600">${accuracy}%</div>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-amber-50 rounded-lg">
                        <div>
                            <div class="font-medium text-amber-900">Avg Pick Time</div>
                            <div class="text-sm text-amber-700">Minutes per order</div>
                        </div>
                        <div class="text-2xl font-bold text-amber-600">${avgTime}</div>
                    </div>
                </div>
            `;
        }

        function updateMyPickerRecentActivity() {
            const container = document.getElementById('my-picker-recent-activity');
            if (!container || !currentUser) return;
            
            // Get recent pick orders completed by this picker
            const myRecentOrders = allItems.filter(item => 
                item.type === 'pick_order' && 
                item.assignedPickerId === currentUser.__backendId &&
                item.status === 'completed' &&
                item.completedAt
            ).sort((a, b) => new Date(b.completedAt) - new Date(a.completedAt)).slice(0, 5);
            
            if (myRecentOrders.length === 0) {
                container.innerHTML = '<div class="text-gray-500 text-center py-8">No recent activity</div>';
                return;
            }
            
            container.innerHTML = '';
            myRecentOrders.forEach(order => {
                const activityElement = document.createElement('div');
                activityElement.className = 'flex justify-between items-center p-3 bg-green-50 rounded-lg';
                activityElement.innerHTML = `
                    <div>
                        <div class="font-medium text-sm text-green-800">Completed: ${order.orderNumber}</div>
                        <div class="text-xs text-green-600">${order.customer || 'No customer'}  ${formatDate(order.completedAt)}</div>
                    </div>
                    <div class="text-right">
                        <div class="font-bold text-sm text-green-800">${order.totalItems}</div>
                        <div class="text-xs text-green-600">items</div>
                    </div>
                `;
                container.appendChild(activityElement);
            });
        }

        async function startMyPickOrder(orderId) {
            const order = allItems.find(item => item.__backendId === orderId && item.type === 'pick_order');
            if (!order || !currentUser) return;

            const updatedOrder = {
                ...order,
                status: 'in_progress',
                startedAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };

            try {
                if (window.dataSdk) {
                    const result = await window.dataSdk.update(updatedOrder);
                    if (result.isOk) {
                        showToast(`Started picking order ${order.orderNumber}`, 'success');
                        updatePickerWorkspace();
                    } else {
                        showToast('Failed to start pick order: ' + result.error.message, 'error');
                    }
                }
            } catch (error) {
                console.error('Error starting pick order:', error);
                showToast('Error starting pick order', 'error');
            }
        }

        async function completeMyPickOrder(orderId) {
            const order = allItems.find(item => item.__backendId === orderId && item.type === 'pick_order');
            if (!order || !currentUser) return;

            const confirmed = await showConfirmation(`Complete pick order "${order.orderNumber}"? This will update inventory levels.`);
            if (!confirmed) return;

            try {
                const pickItems = JSON.parse(order.items || '[]');
                
                // Update inventory for each picked item
                for (const pickItem of pickItems) {
                    const inventoryItem = allItems.find(item => 
                        item.__backendId === pickItem.itemId && item.type === 'inventory'
                    );
                    
                    if (inventoryItem) {
                        const newQuantity = Math.max(0, (inventoryItem.quantity || 0) - pickItem.quantityToPick);
                        const newAvailable = Math.max(0, (inventoryItem.available || inventoryItem.quantity || 0) - pickItem.quantityToPick);
                        
                        const updatedItem = {
                            ...inventoryItem,
                            quantity: newQuantity,
                            available: newAvailable,
                            lastMovement: new Date().toISOString(),
                            updatedAt: new Date().toISOString()
                        };

                        if (window.dataSdk) {
                            await window.dataSdk.update(updatedItem);
                        }
                    }
                }
                
                // Update picker statistics
                const updatedPicker = {
                    ...currentUser,
                    status: 'active',
                    totalPicks: (currentUser.totalPicks || 0) + 1,
                    todayPicks: (currentUser.todayPicks || 0) + 1,
                    lastActive: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };
                
                if (window.dataSdk) {
                    await window.dataSdk.update(updatedPicker);
                    currentUser = updatedPicker;
                }
                
                // Update pick order status
                const updatedOrder = {
                    ...order,
                    status: 'completed',
                    itemsPicked: order.totalItems,
                    completedAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };

                if (window.dataSdk) {
                    const result = await window.dataSdk.update(updatedOrder);
                    if (result.isOk) {
                        showToast(`Pick order "${order.orderNumber}" completed successfully!`, 'success');
                        updatePickerWorkspace();
                    } else {
                        showToast('Failed to complete pick order: ' + result.error.message, 'error');
                    }
                }
            } catch (error) {
                console.error('Error completing pick order:', error);
                showToast('Error completing pick order', 'error');
            }
        }

        function viewMyPickOrderDetails(orderId) {
            // Reuse the existing viewPickOrderDetails function
            viewPickOrderDetails(orderId);
        }

        // Picker Workspace Tabs
        let currentPickerWorkspaceTab = 'orders';

        function showPickerWorkspaceTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.picker-workspace-tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // Show selected tab content
            const targetTab = document.getElementById(`picker-workspace-${tabName}-tab`);
            if (targetTab) {
                targetTab.classList.remove('hidden');
            }
            
            // Update tab buttons
            document.querySelectorAll('.picker-workspace-tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            const activeBtn = document.querySelector(`.picker-workspace-tab-btn[data-tab="${tabName}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            currentPickerWorkspaceTab = tabName;
        }

        // Change password function for pickers
        async function changeMyPickerPassword(event) {
            event.preventDefault();
            
            if (!currentUser) {
                showToast('User session expired. Please log in again.', 'error');
                return;
            }

            const button = document.getElementById('picker-change-password-btn');
            const originalText = button.innerHTML;
            button.innerHTML = '<div class="loading-spinner"></div><span class="ml-2">Updating...</span>';
            button.disabled = true;

            try {
                const formData = new FormData(event.target);
                const currentPassword = formData.get('currentPassword');
                const newPassword = formData.get('newPassword');
                const confirmPassword = formData.get('confirmPassword');
                
                // Validate current password
                if (currentUser.password !== currentPassword) {
                    showToast('Current password is incorrect', 'error');
                    return;
                }
                
                // Validate new password
                if (newPassword.length < 4) {
                    showToast('New password must be at least 4 characters long', 'error');
                    return;
                }
                
                // Validate password confirmation
                if (newPassword !== confirmPassword) {
                    showToast('New passwords do not match', 'error');
                    return;
                }
                
                // Update picker's password
                const updatedPicker = {
                    ...currentUser,
                    password: newPassword,
                    lastActive: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };

                if (window.dataSdk) {
                    const result = await window.dataSdk.update(updatedPicker);
                    if (result.isOk) {
                        currentUser = updatedPicker;
                        showToast('Password updated successfully', 'success');
                        document.getElementById('picker-change-password-form').reset();
                    } else {
                        showToast('Failed to update password: ' + result.error.message, 'error');
                    }
                } else {
                    showToast('Data storage not available', 'error');
                }
            } catch (error) {
                console.error('Error updating password:', error);
                showToast('Error updating password', 'error');
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }

        // Initialize the system when the page loads
        document.addEventListener('DOMContentLoaded', initializeSystem);
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a496aad544c5cbd',t:'MTc2NDE2MDQzMi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>